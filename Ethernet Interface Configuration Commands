Ethernet Interface Configuration Commands

    Command Support
    am isolate
    assign port-type 100ge
    assign port-type xge
    assign port-type 25ge
    assign group-speed
    auto duplex
    auto speed
    cable-snr-test
    carrier
    clear configuration port-isolate
    combo-port
    display counters protocol
    display card port-config-mode configuration
    display device group-speed configuration
    display device port-config-mode status
    display device port-type configuration
    display error-down recovery
    display error-statistics trigger speed-down-grade oui
    display interface ethernet brief
    display port-group
    display port-group member-configuration
    display port-isolate group
    display port link-flap auto-detect recovery
    display port protect-group
    display portsplit
    display virtual-cable-test
    device transceiver 1000BASE-X
    duplex
    error-down auto-recovery
    error-down-threshold error-percentage
    error-down-threshold error-statistics
    error-statistics threshold-event trigger error-down
    error-statistics trigger speed-down-grade
    fast-link-down disable
    fec mode base-r
    fec mode rs
    flow-control (interface view)
    flow-control negotiation
    flow-control negotiation receive
    flow-control receive
    group-member
    interface (Ethernet interface)
    interface range
    jumboframe enable (interface view)
    jumboframe enable (system View)
    log-threshold input-rate output-rate
    log-threshold input-discard output-discard (interface view)
    log-threshold
    loopback
    loopbacktest
    mdi
    negotiation auto
    negotiation priority
    port clock-mode slave
    port link-flap auto-detect protection disable
    port link-flap auto-detect interval
    port link-flap auto-detect threshold
    port link-flap auto-detect recovery interval
    port link-flap interval
    port link-flap protection enable
    port link-flap threshold
    port-group
    port-group group-member
    port-isolate enable
    port-isolate exclude vlan
    protect-group member
    port mode 2.5ge
    port mode ge (25GE interface)
    port-isolate mode
    port media type (GE interface view)
    port media type (XGE interface view)
    port media type (25GE interface view)
    port protect-group
    port work-mode
    port split
    port serdes-mode
    portswitch
    portswitch batch
    preamble compatible-mode enable
    reset statistics-peak
    reset statistics-peak interface
    reset virtual-cable-test
    set card port-config-mode 25g-port enable
    set device port-config-mode enable
    set ethernet speed down-grade
    set error-statistics trigger speed-down-grade
    set flow-statistics include-interframe
    set flow-change-ratio
    set flow-change-ratio input-broadcast-detect disable
    set flow-change-ratio start-check
    set if-mib sample-interval
    set log updown disable
    set port-enable delay
    single-fiber enable
    speed
    speed auto-negotiation
    statistic enable (interface view)
    traffic-pppoe
    training (40GE interface view)
    training (100GE interface view)
    transceiver power low trigger error-down
    trap-threshold
    trap-threshold enable
    trap-threshold error-percentage
    trap-threshold error-statistics
    trap-threshold interval
    trap-threshold threshold
    virtual-cable-test

Command Support

Commands provided in this section and all the parameters in the commands are supported by all switch models (except the S5751-L, S5731-L, and S5731S-L), unless otherwise specified. For details, see specific commands.
am isolate
Function

The am isolate command isolates the current interface from a specified interface unidirectionally.

The undo am isolate command cancels unidirectional isolation between the current interface and a specified interface. If no interface is specified, unidirectional isolation between the current interface and all the other interfaces is canceled.

By default, no unidirectional isolation is configured between the current interface and a specified interface.
Format

am isolate { interface-type interface-number }&<1-8>

undo am isolate [ interface-type interface-number ]&<1-8>

am isolate interface-type interface-number1 [ to interface-number2 ]

undo am isolate [ interface-type interface-number1 [ to interface-number2 ] ]
Parameters

Parameter
	

Description
	

Value

interface-type interface-number
	

Specifies the type and number of the interface from which the current interface is isolated unidirectionally.

    interface-type specifies the type of the interface.
    interface-number specifies the number of the interface.

	

-

interface-type interface-number1 [ to interface-number2 ]
	

Specifies the type and number of the interface from which the current interface is isolated unidirectionally.

to specifies an interface range, indicating all the interfaces numbered between interface-number1 and interface-number2.
	

interface-number2 must be greater than interface-number1.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, Eth-Trunk interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

The am isolate command isolates interfaces unidirectionally. For example, if interface A is isolated from interface B unidirectionally, packets sent from interface A cannot reach interface B, but packets sent from interface B can reach interface A. Unidirectional isolation needs to be configured in the following scenarios:

    When multiple hosts connect to different interfaces of a device and a host sends many broadcast packets to the other hosts, isolate the interface connected to the host from other interfaces unidirectionally. Then the other hosts do not receive packets from the host.
    Interfaces in a port isolation group are isolated from each other, but interfaces in different port isolation groups can communicate. To isolate interfaces in different port isolation groups, configure unidirectional isolation between these interfaces.

By default, only Layer 2 packets of the current interface are isolated from a specified interface, but Layer 3 packets are not isolated. To isolate both Layer 2 and Layer 3 packets on interfaces unidirectionally, run the port-isolate mode all command.

Precautions

An interface can be unidirectionally isolated from another type of interface. However, an interface cannot be unidirectionally isolated from itself or from the management interface. In addition, an Eth-Trunk cannot be unidirectionally isolated from its member interfaces.

An interface can be isolated from a maximum of 128 interfaces unidirectionally.
Example
# Isolate GE0/0/1 from GE0/0/2 unidirectionally.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] am isolate gigabitethernet 0/0/2

assign port-type 100ge
Function

The assign port-type 100ge command sets the maximum rate of QSFP28 interfaces to 100 Gbit/s.

The undo assign port-type 100ge command restores the maximum rate of QSFP28 interfaces to 40 Gbit/s.

For the S6730-H24X6C (part number: 02352FSG) and S6730-H48X6C (part number: 02352FSF) with the factory version V200R013C02, the default rate of QSFP28 interfaces is 100 Gbit/s. After a version upgrade from V200R013C02 to V200R019C00 or later, the default rate of QSFP28 interfaces is still 100 Gbit/s.

For the S5732-H24S6Q, S5732-H48S6Q, S6730-H24X6C (part number: 02352FSG) and S6730-H48X6C (part number: 02352FSF) with the factory version V200R019C00 or later, the default rate of QSFP28 interfaces is 40 Gbit/s.

The S6730-H24X6C (part number: 02353GFC), S6730S-H24X6C-A, S6730-H48X6C (part number: 02353FWL) and with the factory version V200R013C02 or later, the license has been loaded by default, and the default rate of QSFP28 interfaces is 100 Gbit/s.

For the S6730-S24X6Q and S6730-S48X6Q, the default rate of QSFP28 interfaces is 40 Gbit/s.

This command is supported only on the following switch models:

S5732-H24S6Q, S5732-H48S6Q, S6730-S24X6Q, S6730-S48X6Q, S6730S-H24X6C-A, S6730-H24X6C, S6730-H48X6C
Format

assign port-type 100ge [ slot slot-id | all ]

undo assign port-type 100ge [ slot slot-id | all ]
Parameters
Parameter 	Description 	Value

slot slot-id
	

Specifies a slot ID.
	

The value must be set according to the device configuration.

all
	

Indicates all slots.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

For the S5732-H24S6Q, S5732-H48S6Q, S6730-S24X6Q, S6730-S48X6Q, S6730-H24X6C (part number: 02352FSG), S6730-H48X6C (part number: 02352FSF), to change the rate of QSFP28 interfaces, apply for and purchase a license from the equipment supplier, activate the license, and then run the assign port-type 100ge command. The corresponding license does not need to be activated before the undo assign port-type 100ge command is run.

For the S6730-H24X6C (part number: 02353GFC), S6730S-H, S6730-H48X6C (part number: 02353FWL), the license has been loaded by default. To change the rate of QSFP28 interfaces, run the assign port-type 100ge command. The corresponding license does not need to be activated before the undo assign port-type 100ge command is run.

Precautions

    The corresponding license is required before the assign port-type 100ge command is run, whereas no license is required before the undo assign port-type 100ge command is run.
    To check the current rate of an interface and the rate that takes effect after a device restart, run the display device port-type configuration command.
    After the command is executed, restart the device immediately for the configuration to take effect.
    After the device restarts, the original interface configuration may be lost. Therefore, back up the configuration before the restart. After the restart, check the configuration and modify it if necessary.
    After this command is executed, the maximum rate of QSFP28 interfaces is the configured rate if you restore the factory settings with one click or downgrade the software version.
    After the license expires, the maximum rate of QSFP28 interfaces is the default rate if you restart the device and then restore the factory settings with one click.

Example

# Set the maximum rate of QSFP28 interfaces to 100 Gbit/s.

<HUAWEI> system-view
[HUAWEI] assign port-type 100ge all  
Warning: The configuration of 40G interfaces may be lost after the device restart. Therefore, back up their configuration before the
 restart, and check the configuration after the restart is complete. Continue? [Y/N]:y
Info: The current configuration has been modified and takes effect after the device is restarted.

assign port-type xge
Function

The assign port-type xge command sets the maximum rate of 1000BASE-X interfaces to 10 Gbit/s.

The undo assign port-type xge command restores the maximum rate of 1000BASE-X interfaces to 1 Gbit/s.

By default, no license is loaded to a device, and 1000BASE-X interfaces support the maximum rate of 1 Gbit/s.

This command is supported only on the following switch models:

S5736-S48S4X-A, S5736-S48S4X-D
Format

assign port-type xge [ slot slot-id | all ]

undo assign port-type xge [ slot slot-id | all ]
Parameters
Parameter 	Description 	Value

slot slot-id
	

Specifies a slot ID.
	

The value must be the ID of an existing slot on the device.

all
	

Indicates all slots.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

By default, 1000BASE-X interfaces on a switch work at a maximum rate of 1 Gbit/s. To enable these interfaces to work at a maximum rate of 10 Gbit/s, apply for and purchase a license from the equipment supplier, activate the license, and then run the assign port-type xge command to set the maximum rate of 1000BASE-X interfaces to 10 Gbit/s. To restore the maximum rate of 1000BASE-X interfaces to 1 Gbit/s, run the undo assign port-type xge command. This command configuration takes effect only after the device is restarted.

Precautions

    A license is required for running the assign port-type xge command, whereas no license is required for running the undo assign port-type xge command.
    To check the current rate of an interface and the rate that takes effect after a device restart, run the display device port-type configuration command.
    After the command is executed, restart the device immediately for the configuration to take effect.
    After the device restarts, the original interface configuration may be lost. Therefore, back up the configuration before the restart. After the restart, check the configuration and modify it if necessary.
    After this command is executed, the maximum rate of SFP interfaces is the configured rate if you restore the factory settings with one click or downgrade the software version.
    After the license expires, the maximum rate of SFP interfaces is the default rate if you restore the factory settings with one click after a device restart.

Example

# Set the maximum rate of 1000BASE-X interfaces to 10 Gbit/s.

<HUAWEI> system-view
[HUAWEI] assign port-type xge all  
Warning: The configuration of GE interfaces may be lost after the device restart. Therefore, back up their configuration before the 
restart, and check the configuration after the restart is complete. Continue? [Y/N]:y                                               
Warning: Running this command will change ports' capability of supporting dedicated stack cables. Continue? [Y/N]:y                 
Info: The current configuration has been modified and takes effect after the device is restarted. 

assign port-type 25ge
Function

The assign port-type 25ge command sets the maximum rate of 10GE SFP+ Ethernet optical ports to 25 Gbit/s.

The undo assign port-type 25ge command restores the maximum rate of 10GE SFP+ Ethernet optical ports to 10 Gbit/s.

By default, no license is loaded to a device, and 10GE SFP+ Ethernet optical ports work at a maximum rate of 10 Gbit/s.

This command is supported only on the S6730-H24X4Y4C.
Format

assign port-type 25ge [ slot slot-id | all ]

undo assign port-type 25ge [ slot slot-id | all ]
Parameters
Parameter 	Description 	Value

slot slot-id
	

Specifies a slot ID.
	

The value must be set according to the device configuration.

all
	

Indicates all slots.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

By default, 10GE SFP+ Ethernet optical ports on a device work at a maximum rate of 10 Gbit/s. To enable these ports to work at a maximum rate of 25 Gbit/s, apply for and purchase a license from the equipment supplier, activate the license, and then run the assign port-type 25ge command to set the maximum rate of the ports to 25 Gbit/s. To restore the maximum rate of the ports to 10 Gbit/s, run the undo assign port-type 25ge command. This command configuration takes effect only after the device is restarted.

Precautions

    A license is required for running the assign port-type 25ge command, whereas no license is required for running the undo assign port-type 25ge command.
    To check the current rate of an interface and the rate that takes effect after a device restart, run the display device port-type configuration command.
    After the command is executed, restart the device immediately for the configuration to take effect.
    After the device restarts, the original interface configuration may be lost. Therefore, back up the configuration before the restart. After the restart, check the configuration and modify it if necessary.
    After this command is executed, the maximum rate of 10GE interfaces is the configured rate if you restore the factory settings with one click or downgrade the software version.
    After the license expires, the maximum rate of 10GE interfaces is the default rate if you restore the factory settings with one click after a device restart.

Example

# Increase the maximum rate of all 10GE SFP+ Ethernet optical ports to 25 Gbit/s.

<HUAWEI> system-view
[HUAWEI] assign port-type 25ge all  
Warning: The configuration of XGE interfaces may be lost after the device restart. Therefore, back up their configuration before the 
restart, and check the configuration after the restart is complete. Continue? [Y/N]:y
Info: The current configuration has been modified and takes effect after the device is restarted. 

assign group-speed
Function

The assign group-speed command sets the maximum rate of interfaces in a MultiGE interface group.

The undo assign group-speed command restores the default maximum rate of interfaces in a MultiGE interface group.

By default, you can run the display device group-speed configuration command to check the maximum rate of a MultiGE interface based on the BaseSpeed field in the command output.

This command is supported only on the following switch models:

S5732-H24UM2CC, S5732-H48UM2CC, S5736-S24UM4XC
Format

assign group-speed [ slot slot-id ] group group-number speed

undo assign group-speed [ slot slot-id ] group group-number
Parameters
Parameter 	Description 	Value

slot slot-id
	

Specifies a slot ID.

In a stack, if no slot ID is specified, the maximum rate of interfaces in the MultiGE interface group on the master switch is configured.
	

The value must be set according to the device configuration.

group group-number
	

Specifies the number of a MultiGE interface group.
	

The value is an integer and must be set according to the device configuration.

Every 12 MultiGE interfaces form a MultiGE interface group. The number of MultiGE interface groups determines the value range. For example, if a device has 24 MultiGE interfaces, the value is 0 or 1.

speed
	

Specifies the maximum rate of a MultiGE interface.
	

The value is of the enumerated type:

    1000
    2500
    5000
    10000

The unit is Mbit/s.
NOTE:

    The value range of this parameter depends on the loaded license control item.
    The specified MultiGE interface rate cannot be lower than the default MultiGE interface rate.

Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

On the S5732-H24UM2CC, S5732-H48UM2CC, S5736-S24UM4XC, every 12 MultiGE interfaces form a MultiGE interface group. To set the maximum rate of interfaces in a specified MultiGE interface group, run the assign group-speed command. The maximum rates of interfaces in the same MultiGE interface group are the same, and the maximum rates of interfaces in different MultiGE interface groups can be different.

Precautions

    This command takes effect only on the device to which license control items are loaded. For details about how to use license control items, see Other: How Can I Increase the Rate of Ports Through the RTU License? in the S1720, S5700, and S6700 Series Switches License Usage Guide.
    After you run the assign group-speed command to set the maximum rate of interfaces in a MultiGE interface group, restart the switch to make the configuration take effect. If you have run the assign group-speed command multiple times to set the maximum rate of interfaces in multiple MultiGE interface groups, restart the switch to make these configurations take effect simultaneously.
    After the assign group-speed command is run, the maximum rate of interfaces in a MultiGE interface group is restored to the default value if factory settings are restored with one click.
    After the license for a MultiGE interface group expires, if the device is restarted or factory settings are restored with one click, the maximum rate of interfaces in the MultiGE interface group is restored to the default value.

Example

# Set the maximum rate of interfaces in MultiGE interface group 0 to 10000 Mbit/s.

<HUAWEI> system-view
[HUAWEI] assign group-speed group 0 10000

auto duplex
Function

The auto duplex command configures the duplex mode on an Ethernet electrical interface in auto-negotiation mode.

The undo auto duplex command restores the default duplex mode on an Ethernet electrical interface in auto-negotiation mode.

By default, the duplex mode on an Ethernet electrical interface is negotiated with the peer interface.

Physical interfaces of the S5732-H24S6Q, S5732-H48S6Q, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S, and MultiGE interface of the S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC do not support the half duplex mode and this command is not supported.
Format

auto duplex { half | full }*

undo auto duplex
Parameters

Parameter
	

Description
	

Value

half
	

Sets the duplex mode on an Ethernet electrical interface in auto-negotiation mode to half-duplex.
	

-

full
	

Sets the duplex mode on an Ethernet electrical interface in auto-negotiation mode to full-duplex.
	

-
Views

Ethernet interface view, MultiGE interface view, GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

In auto-negotiation mode, interfaces on both ends of a link negotiate their duplex mode. If the negotiated duplex mode is not the required one, you can run the auto duplex command to set the required duplex mode in auto-negotiation mode.

    If service traffic volume of enterprise users is high, interfaces at both ends of a link must work in full-duplex mode. Otherwise, packet loss occurs. You can run the auto duplex full command to set the duplex mode to full-duplex. After the auto-negotiation succeeds, the interfaces work in full-duplex mode.
    If service traffic volume of enterprise users is low, interfaces at both ends of a link can meet data transmission requirements when they work in half-duplex mode. You can run the auto duplex half command to set the duplex mode to half-duplex. After the auto-negotiation succeeds, the interfaces work in half-duplex mode.

Prerequisites

Run the negotiation auto command to configure Ethernet interface to work in auto-negotiation mode.

Precautions

    In auto-negotiation mode, an FE electrical interface negotiates the duplex mode with the peer device on the link.

    In auto-negotiation mode, a GE electrical interface that works at a rate of 1000 Mbit/s only supports the full-duplex mode. If the duplex mode is changed to half-duplex, the GE electrical interface works at a maximum rate of 100 Mbit/s.

    The GE optical interfaces support the duplex mode configuration when they are equipped with GE copper modules.

    The interfaces on both ends of a link must have the same duplex mode.

Example
# Configure Ethernet electrical interface GE0/0/1 in auto-negotiation mode to work in half-duplex mode.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] negotiation auto
[HUAWEI-GigabitEthernet0/0/1] auto duplex half

auto speed
Function

The auto speed command configures the auto-negotiation rate of an Ethernet electrical interface.

The undo auto speed command restores the default auto-negotiation rate of an Ethernet electrical interface.

By default, Ethernet electrical interfaces on both ends can negotiate to any rate they support.
Format

auto speed { 10 | 100 | 1000 | 2500 | 5000 | 10000 } *

undo auto speed
Parameters

Parameter
	

Description
	

Value

10
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 10 Mbit/s.
	

-

100
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 100 Mbit/s.
	

-

1000
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 1000 Mbit/s.
NOTE:

FE electrical interfaces do not support this parameter.
	

-

2500
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 2500 Mbit/s.
NOTE:

Only MultiGE interfaces support this parameter.
	

-

5000
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 5000 Mbit/s.
NOTE:

Only MultiGE interfaces support this parameter.
	

-

10000
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 10000 Mbit/s.
NOTE:

Only MultiGE interfaces support this parameter.
	

-
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, MultiGE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

In auto-negotiation mode, interfaces on both ends of a link negotiate their rate. If the negotiated rate is not the required one, run the auto speed command to set the auto-negotiation rate range to limit the negotiated rate.

For example, the network adapter speeds on Server1, Server2, and Server3 that form a server cluster are all 1000 Mbit/s, and the speed of the outbound interface GE0/0/4 connecting the device to external networks is also 1000 Mbit/s. The servers connect to GE0/0/1, GE0/0/2, and GE0/0/3 respectively. If the auto-negotiation speed is not specified on the device, the speeds negotiated by GE0/0/1, GE0/0/2, and GE0/0/3 with their connected servers are all 1000 Mbit/s. When the servers send data at the speed of 1000 Mbit/s concurrently, the outbound interface GE0/0/4 will be blocked. In this case, you can run the auto speed 100 command to configure the auto-negotiation speed to 100 Mbit/s for GE0/0/1, GE0/0/2, and GE0/0/3, preventing the outbound interface from being blocked.

Prerequisites

Run the negotiation auto command to configure the Ethernet interface to work in auto-negotiation mode.

Precautions

    The rate of MultiGE interfaces on the S5732-H24UM2CC, S5732-H48UM2CC, and S5736-S24UM4XC can be increased using the RTU license. After the license is activated, you can run the assign group-speed command and restart the device to make the configured maximum rate supported by the interfaces in the MultiGE interface group take effect.
    To check the default rate of MultiGE interfaces, run the display device group-speed configuration command. The BaseSpeed field indicates the default rate.
    After an XGE optical interface has a GE copper module installed, the interface does not support the auto speed command.
    After a 25GE optical interface has a GE copper module installed and is configured to work at the rate of 1 Gbit/s using the port mode ge command, the interface does not support the auto speed command.

Example
# Configure Ethernet electrical interface GE0/0/1 to work at a rate of 100 Mbit/s in auto-negotiation mode.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] negotiation auto
[HUAWEI-GigabitEthernet0/0/1] auto speed 100

cable-snr-test
Function

The cable-snr-test command checks the network cable quality and displays the check result.

This command is supported only on the XGE electrical interfaces on the ES5D21X08T00 card of the S5731-H, and S5731S-H, GE electrical interfaces on the S5731-H, S2730S-S, S5735-L-I, S5735-L1, S300, S5735-L, S5735S-L1, S5735-S (except the S5735-S48S4X), S500, S5735-S-I, and S5720I-SI, and MultiGE electrical interfaces on the S5731-S24N4X2Q-A, S5731-S24UN4X2Q, S5731-S8UM16UN2Q, S5731S-S24N4X2Q-A1, S5731S-S24UN4X2Q-A, S5731S-S8UM16UN2Q-A, S5720-28X-PWH-LI-AC, S5720-28X-PWH-LI-ACF, S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC, S5736-S24UM4XC.
Format

cable-snr-test
Parameters

None
Views

MultiGE interface view, XGE interface view, GE interface view
Default Level

3: Management level
Usage Guidelines

Usage Scenario

You can check the quality of the network cable on an electrical interface to determine whether the network cable quality meets communication requirements.

Precautions

    This command checks real-time quality of the network cable on an interface, and the network cable quality changes with the external environment.
    A MultiGE electrical interface supports accurate network cable quality check only when it works at the rate of 2.5 Gbit/s or higher.
    An XGE electrical interface supports accurate network cable quality check only when it works at the rate of 10 Gbit/s.
    A GE electrical interface supports accurate network cable quality check only when it works at the rate of 1 Gbit/s.
    An interface does not support the network cable quality check when it is Down or in loopback detection mode.
    After the interface goes Up, wait for several minutes before running this command. Otherwise, the command fails to be delivered.

Example
# Check the network cable quality on GigabitEthernet0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] cable-snr-test
Info: The current network cable is of good quality.

carrier
Function

The carrier command configures the delay in reporting an interface status change event.

The undo carrier command restores the default delay in reporting an interface status change event.

By default, the delay in reporting an interface Up event is 2000 milliseconds, and the delay in reporting an interface Down event is 0 milliseconds.
Format

carrier { up-hold-time | down-hold-time } interval

undo carrier { up-hold-time | down-hold-time }
Parameters

Parameter
	

Description
	

Value

up-hold-time interval
	

Specifies the delay in reporting an interface Up event.
	

The value is 0 or an integer that ranges from 50 to 120000, in milliseconds.

down-hold-time interval
	

Specifies the delay in reporting an interface Down event.
	

The value is 0 or an integer that ranges from 1000 to 120000, in milliseconds.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

The physical status of an Ethernet interface can be Up or Down. When the physical status changes, the system notifies upper-layer protocol modules (such as the routing and forwarding modules) of the change to direct packet receiving and forwarding. The system also automatically generates traps and logs to remind users to perform corresponding operations on physical links. For example, when the physical status of the active interface in an interface protection group changes from Up to Down, the system immediately instructs the upper-layer service forwarding protocol to send service packets from the standby interface.

If frequent physical status changes are reported to the system, extra system costs are generated. You can configure the delay in reporting physical status changes to solve the problem. The system is unaware of the physical status changes on interfaces within the configured delay. If the interface physical status is not recovered after the delay expires, the physical status changes are reported to the system.
You can configure the delay in reporting physical status changes based on the network connection status.

    Setting a long delay

    For example, an interface frequently alternates between Up and Down states at an interval shorter than the IP route convergence time. In this case, the upper-layer protocol does not need to sense the physical status changes. You can set a long delay in reporting physical status changes to avoid unnecessary routing entry refreshing caused by frequent physical status changes.

    Setting a short delay

    For example, when the physical status of the active interface in an interface protection group changes from Up to Down, the system needs to immediately instruct the upper-layer service forwarding protocol to send service packets from the standby interface. In this case, you can set a short delay in reporting physical status changes to ensure real-time service switchover.

Precautions

If you run the carrier command multiple times in the same interface view, only the latest configuration takes effect.
Example

# Set the delay in reporting an interface Up event to 1000 milliseconds on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] carrier up-hold-time 1000

clear configuration port-isolate
Function

The clear configuration port-isolate command clears all the interface isolation configurations on the device.

By default, interface isolation configurations on the device are not cleared.
Format

clear configuration port-isolate
Parameters

None
Views

System view
Default Level

2: Configuration level
Usage Guidelines

To clear all the interface isolation configurations on the device, you need to delete the configurations one by one. If a large number of configurations exist on the device, deleting the configurations takes much time and increases the maintenance workload. To reduce the maintenance workload and operation complexity, run the clear configuration port-isolate command in the system view to clear all the interface isolation configurations on the device. The configurations involve the port isolation group, unidirectional port isolation, and isolation mode.
Example

# Clear all the interface isolation configurations on the device.

<HUAWEI> system-view
[HUAWEI] clear configuration port-isolate
Warning: The port isolate will be cancelled. Continue?[Y/N]:y                   
Info: This operation may take a few seconds. Please wait for a moment...done.  

combo-port
Function

The combo-port command configures the working mode of a combo interface.

The undo combo-port command restores the default setting.

By default, a combo interface works in auto mode. That is, the combo interface automatically switches between the electrical mode and optical mode.

Only combo interfaces support this command. For details about the combo interface supported by the switch, see the Hardware Description or click Info-Finder.
Format

combo-port { auto | copper | fiber }

undo combo-port
Parameters

Parameter
	

Description
	

Value

auto
	
Allows a combo interface to automatically select the working mode. The combo interface checks whether an optical module has been installed:

    When a cable is not connected and an optical module is installed, the combo interface works in optical mode.
    When a cable is connected, the interface is in Up state, and an optical module is installed, the combo interface works in electrical mode. After the device restarts, the combo interface works in optical mode.
    When a cable is connected, the interface is in Down state, and an optical module is installed, the combo interface works in optical mode.

In summary, when an optical module is installed on the combo optical interface, the combo interface works in optical mode after the device restarts.
	

-

copper
	

Configures a combo interface to work in electrical mode so that data is transmitted through network cables.
	

-

fiber
	

Configures a combo interface to work in optical mode so that data is transmitted through optical fibers.
	

-
Views

GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

A combo interface consists of a GE electrical interface and a GE optical interface on the panel. The multiplexed electrical and optical interfaces share one internal forwarding interface and cannot work at the same time. When one interface works, the other interface is disabled. You can use the electrical or optical interface based on the remote interface type. The electrical and optical interfaces share one interface view. When you enable the electrical or optical interface, configure the interface attributes (such as the rate and duplex mode) in the same interface view.

Precautions

This command takes effect only on combo interfaces.

If a combo interface is configured to work in a different mode from the remote interface, the two interfaces cannot communicate.

The electrical interface is used with the optical interface as a combo interface. Combo optical interface does not support GE copper module.
Example
# Configure GE0/0/1 to work in electrical mode.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] combo-port copper

display counters protocol
Function

The display counters protocol command displays IPv4 and IPv6 packet statistics on an interface.

Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support this command.
Format

display counters [ interface interface-type interface-number ] protocol [ rate ]
Parameters

Parameter
	

Description
	

Value

interface interface-type interface-number
	

Specifies the interface type and number.
	

-

protocol
	

Displays IPv4 and IPv6 packet statistics.
	

-

rate
	

Displays packet rate information.
	

-
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

After enabling IPv4 or IPv6 packet statistics collection on an interface, you can run this command to view packet statistics, facilitating fault location and troubleshooting.
Example

# Display IPv4 and IPv6 packet statistics on interfaces.

<HUAWEI> display counters protocol
-: Statistic not enable                                                         
Inbound                                                                         
Interface        IPv4(bytes)     IPv4(pkts)     IPv6(bytes)     IPv6(pkts)      
GE0/0/20                   0              0               0              0      
GE0/0/21                   -              -               0              0      
Outbound                                                                        
Interface        IPv4(bytes)     IPv4(pkts)     IPv6(bytes)     IPv6(pkts)      
GE0/0/20                   0              0               0              0      
GE0/0/21                   -              -               0              0 

# Display IPv4 and IPv6 packet rate information on interfaces.

<HUAWEI> display counters protocol rate
-: Statistic not enable                                                         
Inbound                                                                         
Interface      IPv4(bytes/s)   IPv4(pkts/s)   IPv6(bytes/s)   IPv6(pkts/s)      
GE0/0/20                   0              0               0              0      
GE0/0/21                   -              -               0              0      
Outbound                                                                        
Interface      IPv4(bytes/s)   IPv4(pkts/s)   IPv6(bytes/s)   IPv6(pkts/s)      
GE0/0/20                   0              0               0              0      
GE0/0/21                   -              -               0              0

Table 4-16 Description of the display counters protocol command output

Item
	

Description

-: Statistic not enable
	

If a field of an interface displays -, traffic statistics collection about the corresponding type of packets is disabled.

Inbound
	

Packet statistics in the inbound direction of an interface.

Outbound
	

Packet statistics in the outbound direction of an interface.

Interface
	

Interface name.

IPv4(bytes)
	

Number of bytes in IPv4 packets.

IPv4(pkts)
	

Number of IPv4 packets.

IPv6(bytes)
	

Number of bytes in IPv6 packets.

IPv6(pkts)
	

Number of IPv6 packets.

IPv4(bytes/s)
	

Rate of bytes in IPv4 packets.

IPv4(pkts/s)
	

Rate of IPv4 packets.

IPv6(bytes/s)
	

Rate of bytes in IPv6 packets.

IPv6(pkts/s)
	

Rate of IPv6 packets.
display card port-config-mode configuration
Function

The display card port-config-mode configuration command displays information about the card interface working mode.

The following switch models support this command when equipped with an S7X08000 card:

    S5731-H24T4XC, S5731-H24P4XC, S5731-H48T4XC, S5731-H48P4XC, S5731-H24HB4XZ, S5731-H48HB4XZ
    S5731S-H24T4XC-A, S5731S-H48T4XC-A, S5731S-H24HB4XZ-A, S5731S-H48HB4XZ-A
    S5736-S
    S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC

Format

display card port-config-mode configuration
Parameters

None
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

To check the card interface working mode or check whether the card interface working mode configured using the set card port-config-mode 25g-port enable command takes effect, run the display card port-config-mode configuration command.
Example

# Display information about the card interface working mode.

<HUAWEI> display card port-config-mode configuration    
-----------------------------------                                                                                                 
 SlotId       Current       Next                                                                                                    
-----------------------------------                                                                                                 
 1            8*10G         8*10G                                                                                                   
-----------------------------------

Table 4-17 Description of the display card port-config-mode configuration command output

Item
	

Description

SlotId
	

Slot ID.

Current
	

Current interface working mode.
NOTE:

(*) indicates that the S7X08000 card is not properly installed or does not support the change of the port working mode.

Next
	

Interface working mode used at the next startup.
NOTE:

(*) indicates that the S7X08000 card is not properly installed or does not support the change of the port working mode.
display device group-speed configuration
Function

The display device group-speed configuration command displays information about the rate of interfaces in MultiGE interface groups.

This command is supported only on the following switch models:

S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC, S5736-S24UM4XC
Format

display device group-speed configuration
Parameters

None
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

You can run this command to check the following information:

    Default maximum rates of interfaces in MultiGE interface groups
    Maximum rates of interfaces in MultiGE interface groups, which are configured using the assign group-speed command
    Maximum rates of interfaces in MultiGE interface groups during the current device startup
    Maximum rates of interfaces in MultiGE interface groups for the next device startup

Example

# Display the rates of interfaces in MultiGE interface groups.

<HUAWEI> display device group-speed configuration                               

-------------------------------------------------------------------------------                                                     
Slot Group  Interfaces            BaseSpeed ConfigSpeed CurrentSpeed NextSpeed                                                      
-------------------------------------------------------------------------------                                                     
 0    0    MultiGE2/0/1  ~ 2/0/12   1G        10G         10G          10G                                                          
      1    MultiGE2/0/13 ~ 2/0/24   1G        -           1G           1G                                                           

Table 4-18 Description of the display device group-speed configuration command output

Item
	

Description

Slot
	

Slot ID.

Group
	

Number of a MultiGE interface group.

Interfaces
	

Interface number.

BaseSpeed
	

Default maximum rates of interfaces in MultiGE interface groups The unit is bit/s.

ConfigSpeed
	

Maximum rates of interfaces in MultiGE interface groups, which are configured using the assign group-speed command The unit is bit/s.
NOTE:

If this field displays -, ConfigSpeed is the same as BaseSpeed.

CurrentSpeed
	

Maximum rates of interfaces in MultiGE interface groups during the current device startup The unit is bit/s.

NextSpeed
	

Maximum rates of interfaces in MultiGE interface groups for the next device startup The unit is bit/s.
display device port-config-mode status
Function

The display device port-config-mode status command displays information about the card interface working mode.
Format

display device port-config-mode status [ slot slot-id ]
Parameters

Parameter
	

Description
	

Value

slot slot-id
	

Specifies the slot ID.
	

The value depends on the device configuration.
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

For the S5731-S8UM16UN2Q, S5731S-S8UM16UN2Q-A, S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002) and S5732-H48XUM2CC, you can run the display device port-config-mode status command to check the interface working mode and interface split information.
Example

# Display the interface working mode and interface split information on the S5732-H24UM2CC.

<HUAWEI&gt; display device port-config-mode status 
Slot ID        Port-config-mode        Split-port              Status                                                               
----------------------------------------------------------------------                                                              
0              4*25GE+4*10GE+40GE      XGigabitEthernet0/0/1   enable                                                               
                                       XGigabitEthernet0/0/2                                                                        
                                       XGigabitEthernet0/0/3                                                                        
                                       XGigabitEthernet0/0/4                                                                        
----------------------------------------------------------------------

Table 4-19 Description of the display device port-config-mode status command output

Item
	

Description

Slot ID
	

Slot ID.

Port-config-mode
	

The interface working mode is 4x25GE+4x10GE+40GE mode.

Split-port
	

If an interface is not split, this field displays -. If an interface is split, this field displays the converted interfaces.

Status
	

Current status of interface split:

    enable: Interface split is enabled.
    disable: Interface split is disabled.

display device port-type configuration
Function

The display device port-type configuration command displays the maximum rate of interfaces on the device.

This command is supported only on the following switch models:

S5732-H24S6Q, S5732-H48S6Q, S6730-S24X6Q, S6730-S48X6Q, S6730S-H24X6C-A, S6730-H24X6C, S6730-H48X6C, S6730-H24X4Y4C, S5736-S48S4X-A, and S5736-S48S4X-D
Format

display device port-type configuration
Parameters

None
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

Usage Scenario

On the S5732-H24S6Q, S5732-H48S6Q, S6730-S24X6Q, S6730-S48X6Q, S6730S-H24X6C-A, S6730-H24X6C, S6730-H48X6C, after the maximum rate of QSFP28 interfaces is changed using the assign port-type 100GE command, you can run the display device port-type configuration command to check the supported maximum rate configuration.

On the S6730-H24X4Y4C, after the maximum rate of a 10GE SFP+ Ethernet optical interface is set to 25 Gbit/s using the assign port-type 25GE command, you can run the display device port-type configuration command to check the maximum rate configuration.

On the S5736-S48S4X-A, S5736-S48S4X-D, after the maximum rate of 1000BASE-X interfaces is set to 10 Gbit/s using the assign port-type XGE command, you can run the display device port-type configuration command to check the supported maximum rate configuration.

Precautions

The corresponding license does not need to be activated before this command is run.
Example

# Display the maximum rate of 40GE interfaces on a switch.

<HUAWEI> display device port-type configuration                                                                                
-----------------------------------                                                                                                 
 SlotId       Current       Next                                                                                                    
-----------------------------------                                                                                                 
 0            40GE          100GE                                                                                                   
 1            40GE          100GE                                                                                                   
-----------------------------------  

Table 4-20 Description of the display device port-type configuration command output

Item
	

Description

Slot
	

Slot ID.

Current
	

Current maximum rate of 40GE interfaces.

Next
	

Configured maximum rate supported by the device.
NOTE:

If a switch does not restart after the maximum rate of 40GE interfaces is changed, the Next field value will be inconsistent with the Current field value.
display error-down recovery
Function

The display error-down recovery command displays information about the port in Error-Down state, including the interface name, cause of the Error-Down event, delay for the interface to change from Down to Up, and remaining time for the Up event.

An interface enters the error-down state after being shut down due to an error. Currently, errors include the auto-defend protection, threshold crossing event, remote failure event, MAC address flapping, link flapping, low optical power, error packets exceeding the alarm threshold, and BPDU protection.
Format

display error-down recovery [ interface interface-type interface-number ]
Parameters

Parameter
	

Description
	

Value

interface-type interface-number
	

Displays the specified port in Error-Down state.

    interface-type specifies the interface type.

    interface-number specifies the interface number.

	

-
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

Usage Scenario

The auto recovery function is configured and the delay for an interface to change from Down to Up is set using the error-down auto-recovery command. If the interface is in the Error-Down state, you can run the display error-down recovery command to view the remaining time for the Up event.

Prerequisites

The auto recovery function has been configured on an interface using the error-down auto-recovery command.

Precautions

If interface is not specified in this command, the system displays information about all interfaces in error-down state.
Example

# Display the delay for the interface to change from Down to Up and the remaining time for the Up event.

<HUAWEI> display error-down recovery

interface                    error-down cause           recovery   remainder
                                                        time(sec)  time(sec)
----------------------------------------------------------------------------
GigabitEthernet0/0/1         bpdu-protection            30         10

Table 4-21 Description of the display error-down recovery command output

Item
	

Description

interface
	

Interface name.

error-down cause
	
Cause of the Error-Down event, including:

    as-not-ready: An AS is not in service.
    auto-defend
    efm-threshold-event
    efm-remote-failure
    bpdu-protection
    data-integrity-error
    error-statistics
    storm-control
    port-security
    mac-address-flapping
    transceiver-power-low
    link-flap

recovery time(sec)
	

Delay for the interface to change from Down to Up, in seconds. If no automatic recovery time is configured, you need to run the shutdown and undo shutdown commands in the interface view. Alternatively, run the restart command in the interface view to make the interface go Up and the recovery time is displayed as --.

remainder time(sec)
	

Remaining time for the Up event, in seconds. If no automatic recovery time is configured, you need to run the shutdown and undo shutdown commands in the interface view. Alternatively, run the restart command in the interface view to make the interface go Up and the remaining time is displayed as --.
display error-statistics trigger speed-down-grade oui
Function

The display error-statistics trigger speed-down-grade oui command displays the terminal MAC addresses that can be identified in automatic rate reduction on interfaces.

This command is supported only on the following switch models: S5731-S, S5731S-S, S5731-H, S5731S-H.
Format

display error-statistics trigger speed-down-grade oui
Parameters

None
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

When a GE electrical interface on a device is connected to a specific printer and the interface rate is higher than 10 Mbit/s, the interface can go Up, but the printer cannot work properly. Alignment error packets will be detected on the interface. In this case, you can run the set error-statistics trigger speed-down-grade command to enable the device to automatically reduce the interface rate when the number of error packets on the interface reaches the threshold. The device then automatically sets the interface rate to 10 Mbit/s, reports an alarm (hwPortErrPktSpeedDownGrade), and records a log (IFPDT/1/ERRPKT_SPEEDDOWN) when the following conditions are met:

    The interface receives three alignment error packets within 60 seconds.
    The interface is in the auto-negotiation state and works at the rate of 100 Mbit/s.
    Only one MAC address is learned on the interface, and the MAC address starts with 001B-82 or is in the MAC address blacklist configured using this command.

You can run this command to view the terminal MAC addresses that can be identified by the device in addition to the default MAC address.
Example

# Display the terminal MAC addresses that can be identified in automatic rate reduction on interfaces.

<HUAWEI> display error-statistics trigger speed-down-grade oui
---------------------------------------------------   
OuiAddress       Mask             Description         
---------------------------------------------------   
0001-0000-0000   ffff-0000-0000   printer   

Table 4-22 Description of the display error-statistics trigger speed-down-grade oui command output

Item
	

Description

OuiAddress
	

MAC OUI. To set this parameter, run the error-statistics trigger speed-down-grade command.

Mask
	

Mask of the MAC address.

Description
	

Description of the MAC address.
display interface ethernet brief
Function

The display interface ethernet brief command displays brief information about Ethernet interfaces.
Format

display interface ethernet brief [ main ]
Parameters

Parameter
	

Description
	

Value

main
	

Displays brief information about Ethernet main interfaces.
	

-
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

Usage Scenario

You can use the display interface ethernet brief command to view brief information about Ethernet interfaces, including the physical status, auto-negotiation mode, duplex mode, rate, and average inbound and outbound bandwidth usages within the last period of time. This information helps you locate and rectify faults.

Precautions

To clear statistics on an interface, run the reset counters interface command.
Example

# Display brief information about Ethernet interfaces.

<HUAWEI> display interface ethernet brief
PHY: Physical                                                                   
*down: administratively down                                                    
#down: LBDT down                                               
(l): loopback                                                                   
(b): BFD down                                                                   
InUti/OutUti: input utility/output utility                                      
Interface                   PHY   Auto-Neg Duplex Bandwidth  InUti OutUti Trunk 
GigabitEthernet0/0/1        up    enable   half        100M  0.06%   100%    -- 
GigabitEthernet0/0/2        up    enable   full       1000M   100%   100%    -- 
GigabitEthernet0/0/3        up    enable   full       1000M     0%   100%    -- 
GigabitEthernet0/0/4        up    enable   full       1000M   100%   100%     1 
GigabitEthernet0/0/5        up    enable   full       1000M    99%   100%    -- 
GigabitEthernet0/0/6        down  enable   half       1000M     0%     0%    -- 
GigabitEthernet0/0/7        down  enable   half       1000M     0%     0%    -- 
GigabitEthernet0/0/8        down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/9        down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/10       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/11       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/12       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/13       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/14       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/15       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/16       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/17       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/18       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/19       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/20       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/21       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/22       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/23       down  enable   full       1000M     0%     0%    -- 
GigabitEthernet0/0/24       down  enable   full       1000M     0%     0%    -- 
MEth0/0/1                   down  enable   half        100M     0%     0%    -- 

Table 4-23 Description of the display interface ethernet brief command output

Item
	

Description

Interface
	
Type and number of an interface. All interfaces are displayed in alphabetical order. Information about the following interfaces can be displayed:

    MEth0/0/1 interface

    FE interface

    GE interface

    XGE interface
    25GE interface

    MultiGE interface

    40GE interface

    100GE interface

PHY
	
Physical status of an interface:

    up: indicates that the interface works properly.

    down: indicates that the physical layer of the interface fails.

    *down: refers to administratively down, indicating that the administrator has run the shutdown (interface view) command on the interface.
    #down: LBDT down, indicating that loop detection is enabled on the interface. The interface is shut down when the device detects a loop on the downstream network or between interfaces.

    (l): refers to loopback, indicating that the loopback function is enabled on the interface.

    (b): indicates that the physical layer of the interface is in BFD down state.

Auto-Neg
	
Whether auto-negotiation is enabled on an interface:

    enable: indicates that auto-negotiation is enabled on the interface.

    disable: indicates that auto-negotiation is disabled on the interface.

To configure the auto-negotiation mode for an interface, run the negotiation auto command.

Duplex
	
Duplex mode of an interface:

    full: indicates the full-duplex mode.

    half: indicates the half-duplex mode.

    In auto-negotiation mode, use the auto duplex command to configure the duplex mode of an interface.
    In non-auto negotiation mode, use the duplex command to configure the duplex mode of an interface.

Bandwidth
	

Bandwidth on the interface.

InUti
	

Average inbound bandwidth usage within the last 5 minutes.

Average inbound bandwidth usage = Average inbound rate within the last 5 minutes/Interface bandwidth

When the average bandwidth usage is smaller than 0.01% and greater than 0.005%, the value 0.01% is displayed. When the average bandwidth usage is smaller than 0.005% and greater than 0, the value 0 is displayed. When the interface bandwidth becomes smaller, for example, the bandwidth is changed using the speed command, or when an Eth-Trunk member interface becomes Down or is removed from the Eth-Trunk, the bandwidth usage be displayed as 100% because the communication traffic is not adjusted in time.

OutUti
	

Average outbound bandwidth usage within the last 5 minutes.

Average outbound bandwidth usage = Average outbound rate within the last 5 minutes/Interface bandwidth

When the average bandwidth usage is smaller than 0.01% and greater than 0.005%, the value 0.01% is displayed. When the average bandwidth usage is smaller than 0.005% and greater than 0, the value 0 is displayed. When the interface bandwidth becomes smaller, for example, the bandwidth is changed using the speed command, or when an Eth-Trunk member interface becomes Down or is removed from the Eth-Trunk, the bandwidth usage be displayed as 100% because the communication traffic is not adjusted in time.

Trunk
	

Number of the Eth-Trunk to which an interface is added.
display port-group
Function

The display port-group command displays information about permanent port groups and interfaces in these groups.
Format

display port-group [ all | port-group-name ]
Parameters

Parameter
	

Description
	

Value

all
	

Displays information about all permanent port groups and interfaces in these groups.
	

-

port-group-name
	

Displays information about a specified permanent port group and interfaces in the group.
	The value is the name of an existing port group.
Views

All views
Default Level

1: Monitoring level
Usage Guidelines
When using the display port-group command, note that:

    If no parameter is configured, names of all permanent port groups are displayed.
    If all is configured, information about all permanent port groups and interfaces in these groups is displayed.
    If port-group-name is configured, information about a specified permanent port group and interfaces in the group is displayed.

Example

# Display information about all port groups and interfaces in these groups.

<HUAWEI> display port-group all
Portgroup: 1
GigabitEthernet0/0/1
GigabitEthernet0/0/2
GigabitEthernet0/0/3

Table 4-24 Description of the display port-group command output

Item
	

Description

Portgroup
	

Name of a permanent port group.
display port-group member-configuration
Function

The display port-group member-configuration command displays the configuration of each member interface in a specified interface group.
Format

display port-group port-group-name member-configuration
Parameters

Parameter
	

Description
	

Value

port-group-name
	

Specifies the name of an interface group to be queried.
	

The value is the name of an existing port group.
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

To view the configuration of each member interface in a specified interface group, run the display port-group member-configuration command.
Example

# Display the configuration of each member interface in an interface group named group1.

<HUAWEI> display port-group group1 member-configuration
Portgroup: group1 
# 
interface GigabitEthernet0/0/1 
 description group1 
 shutdown 
 stp disable 
# 
interface GigabitEthernet0/0/2 
 description group1 
 shutdown 
 stp disable 
# 

Table 4-25 Description of the display port-group member-configuration command output

Item
	

Description

Portgroup
	

Name of a permanent port group.
display port-isolate group
Function

The display port-isolate group command displays the configuration of a port isolation group.
Format

display port-isolate group { group-id | all }
Parameters

Parameter
	

Description
	

Value

group-id
	

Displays the configuration of a specified port isolation group.
	

The value is an integer that ranges from 1 to 64.

all
	

Displays the configurations of all port isolation groups.
	

-
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

The port isolation feature isolates interfaces in a VLAN. Run port-isolate enable [ group group-id ] command to add interfaces to a port isolation group, you can implement Layer 2 isolation between these interfaces. To view the configuration of the port isolation group, run the display port-isolate group command.
Example

# Display the configurations of all port isolation groups.

<HUAWEI> display port-isolate group all
  The ports in isolate group 3:
GigabitEthernet0/0/1 
GigabitEthernet0/0/2
  The ports in isolate group 4:
GigabitEthernet0/0/3 
GigabitEthernet0/0/4

display port link-flap auto-detect recovery
Function

The display port link-flap auto-detect recovery command displays information about interfaces that go Down due to link flapping.
Format

display port link-flap auto-detect recovery
Parameters

None
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

If the physical status of an interface is LINK-FLAP DOWN in the display interface command output, you can run the display port link-flap auto-detect recovery command to view the automatic recovery period of the interface.
Example

# Display information about interfaces that go Down due to link flapping.

<HUAWEI> display port link-flap auto-detect recovery
---------------------------------------------------------------------------                                                         
Interface                RecoveryTime(sec)        RemainTime(sec)                                                                   
---------------------------------------------------------------------------                                                         
XGigabitEthernet0/0/1    60                       40   

Table 4-26 Description of the display port link-flap auto-detect recovery command output

Item
	

Description

Interface
	

Interface name.

RecoveryTime(sec)
	

Automatic recovery period after an interface goes Down due to link flapping. To set the automatic recovery period, run the port link-flap auto-detect recovery interval command.

RemainTime(sec)
	

Remaining automatic recovery period after an interface goes Down due to link flapping.
display port protect-group
Function

The display port protect-group command displays information about member interfaces in an interface protection group.
Format

display port protect-group { all | protect-group-index }
Parameters

Parameter
	

Description
	

Value

all
	

Displays information about all interface protection groups and their member interfaces.
	

-

protect-group-index
	

Displays information about member interfaces in the specified interface protection group.
	

The value is an integer that ranges from 0 to 63.
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

Hosts are usually connected to an external network through a default gateway. If the outbound interface of the default gateway fails, the hosts cannot communicate with the external network, interrupting normal service transmission and degrading device reliability. The port protection function solves this problem. Without changing the networking, you can add two interfaces on the device to a port protection group to implement interface backup in active/standby mode. When the active interface fails, services are immediately switched to the standby interface, ensuring non-stop service transmission.

The display port protect-group command displays information about member interfaces in an interface protection group.
Example

# Display information about interface protection group 1 and its member interfaces.

<HUAWEI> display port protect-group 1
  Group ID : 1    
-----------------------------------------------    
  Protect-group member        Role      State   
-----------------------------------------------      
  GigabitEthernet0/0/1        Master    Work    
  GigabitEthernet0/0/2        Standby   Protect  

Table 4-27 Description of the display port protect-group command output

Item
	

Description

Group ID
	

ID of the interface protection group.

Protect-group member
	

Member name of the interface protection group.

Role
	

Interface role:

    Master: working interface
    Standby: protected interface

State
	

Interface status:

    Work: working state
    Protect: protection state
    Down: the interface is physically down

display port split
Function

The display port split command displays the current status of a split or merged interface.

Only interfaces on the panel of the S5731-S24N4X2Q-A, S5731-S24UN4X2Q, S5731-S8UM16UN2Q, S5731S-S24N4X2Q-A1, S5731S-S24UN4X2Q-A, S5731S-S8UM16UN2Q-A support interface split and merge.

For the devices that have the ES5D21Q02Q00, ES5D21Q04Q01, S7C02000, or S7Q02001 card installed, interfaces on the card support interface split and merge.
Format

display port split [ slot slot-id ]
Parameters

Parameter
	

Description
	

Value

slot slot-id
	

Specifies the slot ID.
	

The value is an integer and must be set according to the device configuration.
Views

User view, system view
Default Level

1: Monitoring level
Usage Guidelines

After interfaces are split, you can run this command to view the current status of the split and merged interface.
Example

# Display the current status of a split or merged interface.

<HUAWEI> display port split
*enable  : Will be enabled after board reset
*disable : Will be disabled after board reset

 Port           Status     Split Port
----------------------------------------------------
 40GE0/0/1      enable     XGigabitEthernet0/0/49
                           XGigabitEthernet0/0/50
                           XGigabitEthernet0/0/51
                           XGigabitEthernet0/0/52
 40GE0/0/2      enable     XGigabitEthernet0/0/53
                           XGigabitEthernet0/0/54
                           XGigabitEthernet0/0/55
                           XGigabitEthernet0/0/56
 40GE0/1/1      disable    -
 40GE0/1/2      enable     XGigabitEthernet0/1/5
                           XGigabitEthernet0/1/6
                           XGigabitEthernet0/1/7
                           XGigabitEthernet0/1/8
 40GE0/1/3      disable    -
 40GE0/1/4      disable    -

Table 4-28 Description of the display port split command output

Item
	

Description

Port
	

Port that can be split or merged.

Status
	

Current status of a split or merged interface:

    enable: Interface split is enabled.
    disable: Interface split is disabled.
    *enable: Interface split is enabled after the device is reset.
    *disable: Interface merge is enabled after the device is reset.

Split Port
	

Interfaces that have been split. If an interface is not split, this field displays as -. If an interface is split, converted interfaces are displayed.
display virtual-cable-test
Function

The display virtual-cable-test command displays the last cable test result on an Ethernet electrical interface.
The service interfaces on the following devices do not support this command:

    MultiGE interfaces on the S5720-28X-PWH-LI-AC and S5736-S24UM4XC
    XGE electrical interfaces on the ES5D21X08T00 card

Format

display virtual-cable-test interface-type interface-number
Parameters

Parameter
	

Description
	

Value

interface-type interface-number
	

Displays cable test results on a specified interface.

This parameter can be configured after a GE optical interface has a GE copper module installed.

This parameter can be configured after an XGE optical interface has a GE copper module installed.

After a 25GE optical interface is configured to work at the rate of 1 Gbit/s using the port mode ge command and has a GE copper module installed, the virtual-cable-test command can be configured on the interface.
	

-
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

A cable test detects faults on the cable connected to an interface. If the cable is working properly, the test result displays the total length of the cable. If the cable cannot work properly, the test result displays the distance between the interface and the failure point.

The test result is only for reference and may be inaccurate for cables of some vendors.
Example

# Display the cable test result on Ethernet electrical interface GE0/0/1.

<HUAWEI> display virtual-cable-test gigabitethernet 0/0/1
VCT test last ran on: 2013-7-12 21:25:13     
Pair A length: 189meter(s)
Pair B length: 189meter(s)
Pair C length: 189meter(s)
Pair D length: 189meter(s)
Pair A state: Ok
Pair B state: Ok
Pair C state: Ok
Pair D state: Ok  
Info: The test result is only for reference.

Table 4-29 Description of the display virtual-cable-test command output

Item
	

Description

VCT test last ran on
	

Time when the last VCT test was performed on an interface.
NOTE:

    When the daylight saving time (DST) is not used, the system displays the following information: VCT test last ran on: 2013-7-12 21:25:13.
    When the DST is used, the system displays the following information: VCT test last ran on: 2013-7-12 21:25:13 DST.

Pair A length
	
Length of a network cable. The command output is for reference only. You are advised to use a network cable analyzer to perform a test.

    The length is the distance between the interface and the faulty point if a fault occurs.
    The length is the actual length of the cable when the cable works properly.
    The length is the default length 0 m if the interface is not connected to any cable. The test result of different chips may vary.

NOTE:

If the cable length is displayed as Unknown, the cable status is OK, but the cable length test result cannot be used.

Pair A state
	
Network cable status. The command output is for reference only. You are advised to use a network cable analyzer to perform a test.

    Ok: indicates that the circuit pair is terminated normally.
    Open: indicates that the circuit pair is not terminated.
    Short: indicates that the circuit pair is short-circuited.
    Crosstalk: indicates that the circuit pairs interfere with each other.
    Unknown: Other unknown fault causes are detected or the detection result is inaccurate.

Pairs A, B, C, and D are the four pairs in a cable.
device transceiver 1000BASE-X
Function

The device transceiver 1000BASE-X command pre-configures the module to be installed as a GE optical module.

The undo device transceiver 1000BASE-X command cancels the pre-configuration.

By default, modules to be installed are not pre-configured as GE optical modules.

Only XGE interfaces support this command.
Format

device transceiver 1000BASE-X

undo device transceiver 1000BASE-X
Parameters

None
Views

XGE interface
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When a large number of switches need to be deployed on the live network, a tool is used to deliver unified configurations in a batch, including the undo negotiation auto command configuration on interfaces. Currently, XGE interfaces on Huawei switches do not support the undo negotiation auto command when no optical module is installed. As a result, the deployment workload increases.

When no optical module is installed into an XGE interface, you can run the device transceiver 1000BASE-X and undo negotiation auto commands in sequence on the XGE interface, and then install a GE optical module into the XGE interface. Then the non-auto-negotiation configuration takes effect.

Prerequisites

This command can be delivered when no optical module is installed into the XGE interface or a GE optical module is installed into the XGE interface.

Follow-up Procedure

After this command is delivered, the undo negotiation auto command configuration can be delivered when no GE optical module is installed into the XGE interface.

Precautions

None
Example

<HUAWEI> system-view
[HUAWEI] interface XGigabitEthernet0/0/1
[HUAWEI-XGigabitEthernet0/0/1] device transceiver 1000base-x 
[HUAWEI-XGigabitEthernet0/0/1] undo negotiation auto

duplex
Function

The duplex command sets the duplex mode for an Ethernet electrical interface in non-auto-negotiation mode.

The undo duplex command restores the default duplex mode for an Ethernet electrical interface in non-auto-negotiation mode.

By default, the duplex mode of an Ethernet electrical interface is full duplex when the interface works in non-auto-negotiation mode.

Physical interfaces of the S5732-H24S6Q, S5732-H48S6Q, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S, and MultiGE interface of the S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC do not support the half duplex mode and this command is not supported.
Format

duplex { full | half }

undo duplex
Parameters

Parameter
	

Description
	

Value

full
	

Sets the duplex mode to full duplex for an Ethernet electrical interface in non-auto-negotiation mode.
	

-

half
	

Sets the duplex mode to half duplex for an Ethernet electrical interface in non-auto-negotiation mode.
	

-
Views

Ethernet interface view, MultiGE interface view, GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario
Interfaces can work in the following two duplex modes:

    Half-duplex mode: An interface in this mode only receives or sends data at a time within a specified transmission distance.
    Full-duplex mode: An interface in this mode receives and sends data at the same time. The maximum throughput in full-duplex mode is double that in half-duplex mode, and the transmission distance is not limited.

If the peer device does not support auto-negotiation, you can run this command to manually set the duplex mode for the local interface in non-auto-negotiation mode to ensure that the interface works in the same duplex mode as the peer interface.

Prerequisites

The Ethernet interface has been set to work in non-auto-negotiation mode by running the undo negotiation auto command.
Precautions

    When the working rate of a GE electrical interface is 1000 Mbit/s, the interface supports only the full duplex mode and does not need to negotiate the duplex mode with the peer interface.

    When an interface works in half-duplex mode, flow control does not take effect on the interface.

    Interfaces on both ends of a link must have the same duplex mode.

Example
# Set the duplex mode to half duplex for Ethernet electrical interface GE0/0/1 in non-auto-negotiation mode.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] undo negotiation auto
[HUAWEI-GigabitEthernet0/0/1] speed 100
[HUAWEI-GigabitEthernet0/0/1] duplex half

error-down auto-recovery

Function

The error-down auto-recovery command enables an interface in Error-Down state to go Up and sets the auto recovery delay.

The undo error-down auto-recovery command disables an interface in Error-Down state from going Up automatically.

By default, an interface in Error-Down state is not enabled to go Up.

An interface enters the Error-Down state after being shut down due to an error. Currently, errors include the auto-defend protection, threshold crossing event, remote failure event, MAC address flapping, link flapping, low optical power, error packets exceeding the alarm threshold, and BPDU protection.
Format

error-down auto-recovery cause { as-not-ready | auto-defend | bpdu-protection | efm-remote-failure | efm-threshold-event | error-statistics | link-flap | mac-address-flapping | remote-unit-link | remote-unit-misconfig | port-security | transceiver-power-low | storm-control | data-integrity-error } interval interval-value

undo error-down auto-recovery cause { auto-defend | bpdu-protection | efm-remote-failure | efm-threshold-event | error-statistics | link-flap | mac-address-flapping | remote-unit-link | remote-unit-misconfig | port-security | transceiver-power-low | storm-control | data-integrity-error }
Parameters

Parameter
	

Description
	

Value

cause
	

Indicates the cause for an interface in Error-Down state.
	

-

as-not-ready
	

Indicates that the AS where the interface resides is not in service.
	

-

auto-defend
	

Indicates that the auto-defend function is enabled.
	

-

bpdu-protection
	

Indicates that STP BPDU protection is enabled.
	

-

efm-remote-failure
	

Indicates that an EFM remote failure event occurs.
	

-

efm-threshold-event
	

Indicates that a threshold crossing event occurs.
	

-

error-statistics
	

Indicates that the number of error packets exceeds the alarm threshold.
	

-

link-flap
	

Indicates that link flapping occurs.
	

-

storm-control
	

Indicates that storm control is enabled.
	

-

port-security
	

Indicates that the number of learned secure MAC addresses exceeds the upper limit or static MAC address flapping is detected.
	

-

remote-unit-link
	

Indicates that the link between the RU and central switch is not operational.
	

-

remote-unit-misconfig
	

Indicates that the configurations of the RU and central switch are incorrect.
	

-

mac-address-flapping
	

Indicates that MAC address flapping occurs.
	

-

transceiver-power-low
	

Indicates that the optical power is too low.
	

-

data-integrity-error
	

Indicates that the chip memory identifier has a data integrity error.
NOTE:

Only the S5732-H, S6730-H, S6730S-H, S6730-S, and S6730S-S support this parameter.
	

-

interval interval-value
	

Specifies the auto recovery delay.
	
The value is an integer that ranges from 30 to 86400, in seconds.

    A smaller value indicates a higher frequency at which an interface alternates between Up and Down states.
    A larger value indicates longer traffic interruption.

Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

By default, an interface can only be resumed by a network administrator after being shut down. To configure the interface to restore to the Up state automatically, run the error-down auto-recovery command to set an auto recovery delay. After the delay, the interface goes Up automatically. Alternatively, you can run the shutdown and undo shutdown commands on the interface in the Error-Down state to restore it to the Up state.

The restored interface is shut down again if the interface receives BPDUs again or the link is considered unavailable in a specified time.

An interface enters the Error-Down state in the following scenarios.

Cause for an Interface in Error-Down State
	

Scenario
	

Remarks

as-not-ready
	

When the device negotiates to the AS mode, its port status becomes Down and then becomes Up after services in the service profiles have been delivered.
	

-

auto-defend
	

After the auto-defend action command is used to configure actions against attack sources, the interface that receives attack packets is shut down to prevent the device from attacks.
	

-

bpdu-protection
	

On an STP-enabled network where BPDU protection is configured on an edge port, if malicious attackers send bogus BPDUs to attack the switching device, the switching device sets the edge port to Down immediately after the edge port receives BPDUs. As a result, all services on the edge port are interrupted.
	

For details, see stp bpdu-protection.

efm-remote-failure
	

The efm trigger error-down command associates an error event with an interface. When EFM detects critical-event, dying-gasp, link-fault, or timeout faults, the protocol status of the interface becomes Down and all services on the interface are interrupted.
	

-

efm-threshold-event
	

When link monitoring is configured for an interface on a link, the link is considered unavailable, if the number of errored frames, errored codes, or errored frame seconds detected by the interface reaches or exceeds the threshold within a period. You can associate an EFM crossing event with an interface. Then the system sets the administrative status of the interface to Down. In this manner, all services on the interface are interrupted.
	

-

error-statistics
	

When an Ethernet interface configured with a backup link receives error packets, faults such as packet loss occur. To ensure nonstop service transmission, when the number of received error packets reaches the alarm threshold, the interface is shut down and services are switched to the backup link.
	

For details, see trap-threshold error-statistics and error-statistics threshold-event trigger error-down.

link-flap
	

Network cable faults or active/standby switchovers may cause an interface to alternate between Up and Down. You can configure link flapping protection. When the device receives an interface Up/Down message, it checks the interface flapping count and link flapping detection interval. If the interface flapping count reaches the limit within the specified period, the device shuts down interface.
	

For details, see port link-flap protection enable.

storm-control
	

After the storm control action is configured as error-down on an interface, the interface is shut down when the average rate of receiving broadcast, multicast, and unknown unicast packets is larger than the specified limit within the interval for detecting storms.
	

For details, see storm-control action.

port-security
	

After port security is enabled on an interface, MAC addresses learned by the interface change to secure dynamic MAC addresses. If the port-security protect-action command sets the security protection action to shutdown, the interface is shut down when the number of learned MAC addresses on the interface exceeds the upper limit or static MAC address flapping is detected.
	

For details, see port-security protect-action and port-security enable.

remote-unit-link
	

The following link faults may occur when an RU is connected to the central switch:

    A unidirectional fault occurs on the link connecting the central switch to the RU. In this case, the interface on the central switch goes Error-Down. This fault occurs if one of the following conditions is met:
        The central switch does not receive heartbeat packets from the RU for three consecutive periods (30s in total).
        The heartbeat packets sent by the RU do not carry central switch information in three consecutive periods (30s in total).

    When the central switch is connected to the RU through two links and the interface of one link goes Error-Down due to a unidirectional link fault, the interface of the other link does not enter the Error-Down state even if this link fails.

	

-

remote-unit-misconfig
	

An interface connecting the central switch to an RU goes Error-Down if one of the following configuration errors occurs:

    The two downlink interfaces on the central switch connected to the same RU are not added to an Eth-Trunk. In this case, the interface connected later goes Error-Down.
    The two downlink interfaces on the central switch connected to the same RU are added to two Eth-Trunks respectively. In this case, the interface connected later goes Error-Down.
    Two central switches are connected to the same RU, and the two central switches do not set up a stack. In this case, the interface with a larger system MAC address on the central switches goes Error-Down.

	

If member interfaces of an Eth-Trunk on a central switch connect to two or more RUs, the interfaces will not enter the Error-Down state if configurations are incorrect and the alarm hwRuMngPortRuFull is generated.

mac-address-flapping
	

If the user network where the device is deployed does not support loop prevention protocols, configure a loop prevention action for the device to perform when the device detects MAC address flapping. The device shuts down an interface when detecting MAC address flapping on the interface.
	

For details, see mac-address flapping detection and mac-address flapping action.

transceiver-power-low
	

When the optical power of an Ethernet optical interface configured with a backup link is reduced, faults such as packet loss occur. When the optical power is lower than the lower alarm threshold, the interface is triggered to be in Error-Down state and services are switched immediately.
	

For details, see transceiver power low trigger error-down.

data-integrity-error
	

After the switch runs for a long time, the chip memory identifier has a data integrity error.
	

-

Precautions

    The error-down auto-recovery command is invalid for the interface that has been in Error-Down state. It takes effect for only the interface that enters the Error-Down state after the error-down auto-recovery command is executed.
    BPDU protection has been enabled using the stp bpdu-protection command in the system view.
    A threshold crossing event has been associated with an interface using the efm threshold-event trigger error-down command in the interface view.
    An error event has been associated with an interface using the efm trigger error-down command in the interface view.

Example

# Set the delay for an interface changes from Down to Up to 50s after the edge port is enabled with BPDU protection on an STP-enabled network.

<HUAWEI> system-view
[HUAWEI] error-down auto-recovery cause bpdu-protection interval 50

# Set the auto recovery delay to 50s after an EFM threshold crossing event is associated with an interface.

<HUAWEI> system-view
[HUAWEI] error-down auto-recovery cause efm-threshold-event interval 50

# Set the auto recovery delay to 50s after an EFM remote failure event is associated with an interface.

<HUAWEI> system-view
[HUAWEI] error-down auto-recovery cause efm-remote-failure interval 50

error-down-threshold error-percentage
Function

The error-down-threshold error-percentage command configures the alarm threshold for received CRC packets causing an interface status to change to Error-Down against all the received packets on the interface and alarm interval.

The undo error-down-threshold error-percentage command deletes the configured alarm threshold and interval.

By default, the alarm threshold and interval are not configured.
Format

error-down-threshold error-percentage threshold-value interval interval-value

undo error-down-threshold error-percentage [ threshold-value interval interval-value ]
Parameters
Parameter 	Description 	Value

threshold-value
	

Specifies the alarm threshold for the percentage of received CRC packets causing an interface status change to Error-Down against all the received packets on the interface.
	

The value is an integer that ranges from 1 to 50.
NOTE:

You are advised to set the threshold to be greater than or equal to the alarm threshold configured in the trap-threshold error-percentage command.

interval interval-value
	

Specifies the interval for calculating the percentage of received CRC packets causing an interface status to change to Error-Down against all the received packets on the interface.
	

The value is an integer that ranges from 10 to 65535, in seconds.
Views

Ethernet interface view, GE interface view, XGE interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When the error-statistics threshold-event trigger error-down command is run and the number of error packets that the interface receives within a specified period exceeds the threshold, the interface status is triggered to change to Error-Down. By default, if an interface receives three CRC packets within 10 seconds, the interface status is triggered to change to Error-Down. When you want to use the percentage of received CRC packets against all the received packets as the threshold for triggering an interface status to change to Error-Down, run the error-down-threshold error-percentage command.

Precautions

    This command is mutually exclusive to the error-down-threshold error-statistics command. After this command is configured, the error-down-threshold error-statistics command configuration does not take effect.
    This command cannot be configured on stack interfaces.

Example

# Set the alarm threshold for the percentage of received CRC packets causing the interface status to change to Error-Down against all the received packets to 10% and the interval for calculating the percentage of received CRC packets against all the received packets to 30 seconds on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface GigabitEthernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] error-down-threshold error-percentage 10 interval 30

error-down-threshold error-statistics
Function

The error-down-threshold error-statistics command configures the alarm threshold for CRC error packets causing an interface status to change to Error-Down and interval for receiving CRC error packets.

The undo error-down-threshold error-statistics command restores the default value of the alarm threshold and the alarm interval for CRC error packets that cause the interface status to change to Error-Down.

By default, the alarm threshold for CRC error packets is 3 and the alarm interval is 10 seconds.
Format

error-down-threshold error-statistics threshold-value interval interval-value

undo error-down-threshold error-statistics
Parameters

Parameter
	

Description
	

Value

threshold-value
	

Specifies the alarm threshold for error packets that cause the interface status to change to Error-Down.
	

The value is an integer that ranges from 1 to 65535.
NOTE:

The threshold is greater than or equal to the alarm threshold for error packets configured by the trap-threshold error-statistics command.

interval interval-value
	

Specifies the alarm interval for error packets that cause the interface status to change to Error-Down.
	

The value is an integer that ranges from 10 to 65535, in seconds.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

After an interface is configured to transit to the Error-Down state when the number of received CRC error packets exceeds the threshold using the error-statistics threshold-event trigger error-down command, the interface transits to the Error-Down state when the number of received error packets exceeds the threshold within the specified interval. By default, an interface transits to the Error-Down state when the number of received error packets exceeds 3 within 10 seconds. Run the error-down-threshold error-statistics command to configure the interval and the threshold for received error packets.

Precautions

This command is not supported on the stack interface.

On a switch running a version earlier than V200R009C00, if the alarm threshold has been set to n and alarm interval to m seconds using the trap-threshold error-statistics threshold-value interval interval-value command, the error-down-threshold error-statistics n interval m configuration is automatically generated after the system software version is upgraded to V200R009C00 or a later version.

On a switch running a version earlier than V200R009C00, if the error-down-threshold error-statistics configuration exists on the switch, the configuration remains unchanged after the system software version is upgraded to V200R009C00 or a later version.
Example

By default, the alarm threshold of CRC error packets that cause the interface status to change to Error-Down is 10 and the alarm interval is 30 seconds.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] error-down-threshold error-statistics 10 interval 30

error-statistics threshold-event trigger error-down
Function

The error-statistics threshold-event trigger error-down command configures an interface to transit to the error-down state when the number of error packets received on the interface reaches the threshold.

The undo error-statistics threshold-event trigger error-down command restores the default setting.

By default, an interface does not transit to the error-down state when the number of error packets received on the interface reaches the threshold.
Format

error-statistics threshold-event trigger error-down

undo error-statistics threshold-event trigger error-down
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, MultiGE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When an Ethernet interface receives excessive error packets, faults such as packet loss will occur. Because the interface is still in Up state, traffic is still transmitted on the interface even if a backup link is configured. To avoid impact on services, you can configure the interface to change to the Error-down state when it receives excessive error packets. When the number of received error packets on the interface exceeds the threshold, the system disables the interface and records the interface status as ERROR DOWN(error-statistics) state (indicating that the interface is Down because of excessive error packets). Services are then switched to the backup link immediately.

Follow-up Procedure
An interface in Error-down state can be recovered using either of the following methods:

    Manual recovery: If a few interfaces need to be recovered forcibly, run the shutdown and undo shutdown commands in the interface view. Alternatively, run the restart command in the interface view to restart the interfaces.
    Automatic recovery: If a large number of interfaces need to be recovered, manual recovery is time consuming and some interfaces may be omitted. You can run the error-down auto-recovery cause error-statistics interval interval-value command in the system view to enable automatic interface recovery and set the recovery delay time. An interface in Error-down state automatically recovers when the specified delay time expires.

Example

# Configure GE0/0/1 to transit to the error-down state when the number of error packets received on the interface reaches the threshold.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] error-statistics threshold-event trigger error-down

error-statistics trigger speed-down-grade
Function

The error-statistics trigger speed-down-grade command configures the blacklist of terminal MAC addresses that can be identified in automatic rate reduction on interfaces.

The undo error-statistics trigger speed-down-grade command deletes the blacklist of terminal MAC addresses that can be identified in automatic rate reduction on interfaces.

By default, the device can identify only MAC addresses starting with 001B-82.

This command is supported only on the following switch models: S5731-S, S5731S-S, S5731-H, S5731S-H.
Format

error-statistics trigger speed-down-grade mac-address mac-address mask mask [ description description ]

undo error-statistics trigger speed-down-grade mac-address { mac-address | all }
Parameters
Parameter 	Description 	Value

mac-address mac-address
	

Specifies the terminal MAC address that can be identified.
	

The value is in the format of H-H-H, in which H is a hexadecimal number of 1 to 4 digits. The value cannot be FFFF-FFFF-FFFF, 0000-0000-0000, or a multicast MAC address.

mask mask
	

Specifies the mask of a terminal MAC address.
	

The value is in the format of H-H-H, in which H is a hexadecimal number of 1 to 4 digits.

description description
	

Specifies the description of a terminal MAC address.
	

The value is a string of 1 to 80 characters. The character string is case sensitive and can contain blanks.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When a GE electrical interface on a device is connected to a specific printer and the interface rate is higher than 10 Mbit/s, the interface can go Up, but the printer cannot work properly. Alignment error packets will be detected on the interface. In this case, you can run the set error-statistics trigger speed-down-grade command to enable the device to automatically reduce the interface rate when the number of error packets on the interface reaches the threshold. The device then automatically sets the interface rate to 10 Mbit/s, reports an alarm (hwPortErrPktSpeedDownGrade), and records a log (IFPDT/1/ERRPKT_SPEEDDOWN) when the following conditions are met:

    The interface receives three alignment error packets within 60 seconds.
    The interface is in the auto-negotiation state and works at the rate of 100 Mbit/s.
    Only one MAC address is learned on the interface, and the MAC address starts with 001B-82 or is in the MAC address blacklist configured using this command.

Precautions

This command supports a maximum of 32 terminal MAC address blacklists, excluding the default MAC address blacklist in which MAC addresses start with 001B-82.
Example

# Configure the MAC address 1-1-1 in the blacklist of the terminal MAC address that can be identified in automatic rate reduction on interfaces.

<HUAWEI> system-view
[HUAWEI] error-statistics trigger speed-down-grade mac-address 1-1-1 mask ffff-0-0 description printer

fast-link-down disable
Function

The fast-link-down disable command enables an interface to go Down after a delay.

The undo fast-link-down disable command disables an interface from going Down after a delay.

By default, an interface is disabled from going Down after a delay.

Only the GE electrical interfaces of the following models support this command:

S1720GW-E, S1720GWR-E, S5720-LI, S5720S-LI, S5720I-SI, S5735S-H, S5736-S, S2730S-S, S5735-L-I, S5735-L1, S300, S5735-L, S5735S-L1, S500, S6720S-S, S5735-S, S5735-S-I
Format

fast-link-down disable

undo fast-link-down disable
Parameters

None
Views

GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

After an interface is enabled to go Down after a delay, the device detects the interface Down event after a delay of hundreds of milliseconds. When the interface alternates between Up and Down states, the interface does not go Down immediately, enhancing the anti-interference capability of the device.
Precautions

    If the energy-efficient-ethernet enable command has been executed to enable the EEE function on an electrical interface, the interface cannot be enabled to go Down after a delay. If the fast-link-down disable command has been executed to enable the interface to go Down after a delay, you can still run the energy-efficient-ethernet enable command to enable the EEE function on the interface.
    If the loopback detection mode has been configured on an interface using the loopback command, the interface cannot be enabled to go Down after a delay. If the fast-link-down disable command has been executed to enable the interface to go Down after a delay, you can still run the loopback command to configure the loopback detection mode for the interface.

Example

# Enable an interface to go Down after a delay.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] fast-link-down disable

fec mode base-r
Function

The fec mode base-r command enables the Base-R FEC function on an interface.

The fec mode none command disables the Base-R FEC function on an interface.

The undo fec mode command restores the default Base-R FEC configuration on an interface.

By default, the medium on a 25GE interface determines whether the Base-R FEC function is enabled on the interface. For details, see Table 4-30.

This command is supported on the following: S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC, S6730-H28Y4C, S6730-H24X4Y4C and S7Y08000 cards.

This command is supported when the interface working mode on the S7X08000 or S7X0800K0 card is set to 25GE using the set card port-config-mode 25g-port enable command.
Format

fec mode { base-r | none }

undo fec mode [ base-r | none ]
Parameters
Parameter 	Description 	Value

base-r
	

Enables the Base-R FEC function.
	

-

none
	

Disables the Base-R FEC function.
	

-
Views

25GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Base-R FEC is a bit error correction technology that adds correction information to data packets at the transmit end, and corrects bit errors generated during data packet transmission at the receive end based on the correction information. You can enable the Base-R FEC function to improve the signal quality.

You can run the display interface command in any view or run the display this interface command in the interface view to check whether the FEC function is enabled on an interface based on the Fec field in the command output.

Prerequisites

You can run this command on an interface only when the following conditions are met:

    Auto-negotiation is disabled on the interface.
    The interface is not a stack member interface.

Precautions

    For the device running a version earlier than V200R019C10, the Base-R FEC function is enabled by default on interfaces and cannot be disabled. If you need to disable the function, upgrade the device to V200R019C10 or a later version.
    In V200R019C10 and later versions: Ensure that the FEC status on both ends of a link is the same. If the Base-R FEC function is enabled on one end, this function also needs to be enabled on the other end to ensure that the Base-R FEC status on both ends of the link is the same.
    The FEC function is mutually exclusive with auto-negotiation and the port mode ge command. If FEC has been configured, the FEC configuration will be automatically deleted when auto-negotiation is enabled or the port mode ge command is run.
    When an XGE optical module or XGE high-speed cable is installed on a 25GE interface, the interface does not support the Base-R FEC function.
    When a 40GE optical module or 40GE high-speed cable is installed on a 100GE interface, the interface does not support the Base-R FEC function.
    When 25GE interfaces are interconnected, you are advised to enable FEC on both ends of the link to reduce the transmission bit error rate of the physical link. Otherwise, error packets may be generated.

Example

# Enable the Base-R FEC function on an interface.

<HUAWEI> system-view
[HUAWEI] interface 25ge 0/0/1
[HUAWEI-25GE0/0/1] fec mode base-r

fec mode rs
Function

The fec mode rs command enables the Reed-Solomon Forward Error Correction (RS-FEC) function on an interface.

The fec mode none command disables the RS-FEC function on an interface.

The undo fec mode command restores the default RS-FEC configuration on an interface.

By default, the medium on an optical interface determines whether the RS-FEC function is enabled on the interface. For details, see Table 4-30 and Table 4-31.
Table 4-30 FEC function of 25GE interfaces

Interface Type
	

FEC Requirement
	

Default Setting

SFP-25G-AOC (5e-5)
	

RS-FEC
	

Enabled

SFP-25G-SR
	

RS-FEC
	

Enabled

SFP-25G-ACC (5e-5)
	

RS-FEC
	

Enabled

25G BASE-CR CA-L
	

RS-FEC
	

Auto-negotiation is enabled:

    Whether to enable FEC through negotiation
    Whether to enable RS-FEC or Base-R FEC through negotiation

25G BASE-CR CA-S
	

Base-R FEC

25G BASE-CR CA-N
	

None

SFP-25G-AOC (10e-12)
	

RS-FEC/Base-R FEC/None
	

Enabled

SFP-25G-ACC (10e-12)
	

RS-FEC/Base-R FEC/None
	

Enabled

10G/25G_BR_SFP28
	

RS-FEC
	

Enabled (cannot be modified)

25GBASE_ER_SFP28
	

RS-FEC
	

Enabled (cannot be modified)
Table 4-31 FEC function of 100GE interfaces

Interface Type
	

FEC Requirement
	

Default Setting

QSFP-100G-AOC (5e-5)
	

RS-FEC
	

RS-FEC

QSFP-100G-SR4
	

RS-FEC
	

RS-FEC

QSFP-100G-LR4
	

None
	

None

100GBASE_LR1_QSFP28
	

None
	

None

100G Base-ER4
	

None
	

None

100G Base-SR10
	

None
	

None

QSFP-100G-CWDM4 with FEC
	

RS-FEC
	

RS-FEC

QSFP-100G-CWDM4-Lite
	

RS-FEC
	

RS-FEC

QSFP-100G-PSM4
	

RS-FEC
	

RS-FEC

QSFP-100G-ACC (5e-5)
	

RS-FEC
	

RS-FEC

100G Base-CR4
	

RS-FEC
	

RS-FEC

QSFP-100G-CLR4
	

RS-FEC/None
	

RS-FEC

QSFP-100G-AOC (10e-12)
	

RS-FEC/None
	

RS-FEC

QSFP-100G-ACC (10e-12)
	

RS-FEC/None
	

RS-FEC

100GBASE_SDLC_QSFP28
	

None
	

None
Format

fec mode { rs | none }

undo fec mode [ rs | none ]
Parameters
Parameter 	Description 	Value

rs
	

Enables the RS-FEC function.
	

-

none
	

Disables the RS-FEC function.
	

-
Views

25GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

RS-FEC is a bit error correction technology that adds correction information to data packets at the transmit end, and corrects bit errors generated during data packet transmission at the receive end based on the correction information. RS-FEC improves the signal quality, but increases the signal transmission delay. You can disable this function based on requirements to reduce the signal transmission delay.

You can run the display interface command in any view or run the display this interface command in the interface view to check whether the FEC function is enabled on an interface based on the FEC field in the command output.

Precautions

    For the device running a version earlier than V200R019C00, the RS-FEC function is enabled by default on interfaces and cannot be disabled. If you need to disable the function, upgrade the device to V200R019C00 or a later version.
    In V200R019C00 and later versions, if the RS-FEC function is enabled on one end, this function also needs to be enabled on the other end to ensure that the RS-FEC status on both ends of the link is the same.
    When an XGE optical module or XGE high-speed cable is installed on a 25GE interface, the interface does not support the RS-FEC function.
    When a 40GE optical module or 40GE high-speed cable is installed on a 100GE interface, the interface does not support the RS-FEC function.
    The FEC function is mutually exclusive with auto-negotiation and the port mode ge command. If FEC has been configured, the FEC configuration will be automatically deleted when auto-negotiation is enabled or the port mode ge command is run.
    When 25GE interfaces are interconnected, you are advised to enable FEC on both ends of the link to reduce the transmission bit error rate of the physical link. Otherwise, error packets may be generated.

Example

# Disable the FEC function on 100GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface 100ge 0/0/1
[HUAWEI-100GE0/0/1] fec mode none

flow-control (interface view)
Function

The flow-control command enables flow control on an Ethernet interface.

The undo flow-control command disables flow control on an Ethernet interface.

By default, flow control is disabled on an Ethernet interface.

The following interfaces do not support this command:

    S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002), and S5732-H48XUM2CC
        25G, 40G, and 100G interfaces of the device.
        Four SFP28 Ethernet optical interfaces (25GE by default) and two QSFP28 Ethernet optical interfaces (40GE by default) have been configured using the set device port-config-mode enable command.
        8*10GE ports and 2*25GE ports when the S7X08000 card is installed.
        8*25GE ports when the S7Y08000 card is installed.
    GE interfaces of the S5735S-H24S4XC-A
    GE interfaces of the S5736-S24S4XC and S5736-S48S4XC
    When the RTU license is not loaded on the S6730-H24X4Y4C, the first eight XGE interfaces numbered 0/0/1 to 0/0/8 do not support flow control. In V200R021C00 and later versions, the RTU license can be loaded. After the license is loaded, the interface rate is increased from 10 Gbit/s to 25 Gbit/s, and the first eight 25GE interfaces numbered 0/1/1 to 0/1/8 do not support flow control.
    First eight 25GE interfaces of the S6730-H28Y4C
    XGE interfaces that have copper modules installed on the S6735-S

Format

flow-control

undo flow-control
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Flow control prevents packet loss caused by network congestion. If network congestion occurs on the local device after flow control is configured, the local device sends a message to the remote device, requesting the remote device to temporarily stop sending packets. After receiving the message, the remote device temporarily stops sending packets to the local device regardless of the interface working rate. In this case, the device can receive and send pause frames.

Precautions

    If flow control is enabled on an interface, it must also be enabled on the peer interface.

    Flow control and flow control auto-negotiation can be configured on Ethernet interfaces, but they cannot be configured concurrently.

    When an interface works in half-duplex mode, flow control does not take effect on the interface.

    In a scenario where Layer 3 services are deployed, enabling flow control may affect the IP traffic forwarding on the interface. As a result, the interface becomes unavailable. You can run the undo flow-control command in the interface view to disable flow control to recover the interface.
    If the flow control configuration is implemented on the S5735S-H and S5736-S using the flow-control command, the rate limit for outbound traffic of the GE electrical interface is 200 Mbit/s, and a congestion occurs, the inbound traffic rate cannot be reduced to be the same as the outbound traffic rate on the GE electrical interface. (The inbound traffic rate is about 200 Mbit/s.)
    For the S2730S-S, S5735-L1, S5735-L-I, S300, S5735-L, S5735S-L1, S5735-S, S500, S5735-S-I, , the multicast functions (both Layer 2 and Layer 3 multicast functions) conflict with the flow control function.

Example
# Enable flow control on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] flow-control

flow-control negotiation
Function

The flow-control negotiation command enables flow control auto-negotiation on an Ethernet interface.

The undo flow-control negotiation command disables flow control auto-negotiation on an Ethernet interface.

By default, flow control auto-negotiation is disabled on an Ethernet interface.

The following interfaces do not support this command:

    S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002), and S5732-H48XUM2CC
        25G, 40G, and 100G interfaces of the device.
        Four SFP28 Ethernet optical interfaces (25GE by default) and two QSFP28 Ethernet optical interfaces (40GE by default) have been configured using the set device port-config-mode enable command.
        8*10GE ports and 2*25GE ports when the S7X08000 card is installed.
        8*25GE ports when the S7Y08000 card is installed.
    GE interfaces of the S5735S-H24S4XC-A
    GE interfaces of the S5736-S24S4XC and S5736-S48S4XC
    When the RTU license is not loaded on the S6730-H24X4Y4C, the first eight XGE interfaces numbered 0/0/1 to 0/0/8 do not support flow control. In V200R021C00 and later versions, the RTU license can be loaded. After the license is loaded, the interface rate is increased from 10 Gbit/s to 25 Gbit/s, and the first eight 25GE interfaces numbered 0/1/1 to 0/1/8 do not support flow control.
    First eight 25GE interfaces of the S6730-H28Y4C
    XGE interfaces that have copper modules installed on the S6735-S

Format

flow-control negotiation

undo flow-control negotiation
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Network congestion causes packet loss. Flow control can prevent packet loss. If congestion occurs on a device, the device sends a message to request the peer device to stop sending packets, which prevents packet loss. Flow control auto-negotiation enables a device to determine whether to enable flow control by negotiating with the peer device.

Prerequisites

Run the negotiation auto command to configure the Ethernet interface to work in auto negotiation mode.

Precautions

    Electrical interfaces support flow control auto-negotiation.

    If flow control auto-negotiation is enabled on an interface, it must also be enabled on the peer interface.
    If flow control has been enabled on an Ethernet interface using the flow-control command, run the undo flow-control command to disable flow control before running the flow-control negotiation command. Otherwise, the flow-control negotiation command fails to be executed.

    This command can be used on an XGE optical interface that has a GE copper module installed.
    This command can be used on a GE optical interface that has a GE optical module or GE copper module installed.
    This command can be used on an 25GE optical interface that has a GE copper module installed. Before installing a GE copper module on a 25GE optical interface, you need to run the port mode ge command to configure the interface to work at the rate of 1 Gbit/s.

Multicast functions (Layer 2 and Layer 3 multicast) and the flow control function (configured using the flow-control command) are mutually exclusive on the following models: S2730S-S, S5735-L-I, S5735-L1, S300, S5735-L, S5735S-L1, S500, S5735-S, S5735-S-I
Example
# Enable flow control auto-negotiation on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] negotiation auto
[HUAWEI-GigabitEthernet0/0/1] flow-control negotiation

flow-control negotiation receive
Function

The flow-control negotiation receive command enables received flow control auto-negotiation on an Ethernet interface.

The undo flow-control negotiation receive command disables received flow control auto-negotiation on an Ethernet interface.

By default, received flow control auto-negotiation is disabled on an Ethernet interface.

The following interfaces do not support this command:

    S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002), and S5732-H48XUM2CC
        25G, 40G, and 100G interfaces of the device.
        Four SFP28 Ethernet optical interfaces (25GE by default) and two QSFP28 Ethernet optical interfaces (40GE by default) have been configured using the set device port-config-mode enable command.
        8*10GE ports and 2*25GE ports when the S7X08000 card is installed.
        8*25GE ports when the S7Y08000 card is installed.
    GE interfaces of the S5735S-H24S4XC-A
    GE interfaces of the S5736-S24S4XC and S5736-S48S4XC
    When the RTU license is not loaded on the S6730-H24X4Y4C, the first eight XGE interfaces numbered 0/0/1 to 0/0/8 do not support flow control. In V200R021C00 and later versions, the RTU license can be loaded. After the license is loaded, the interface rate is increased from 10 Gbit/s to 25 Gbit/s, and the first eight 25GE interfaces numbered 0/1/1 to 0/1/8 do not support flow control.
    First eight 25GE interfaces of the S6730-H28Y4C
    XGE interfaces that have copper modules installed on the S6735-S
    Ethernet optical interfaces on the S5720I-SI, S5720-LI (last four optical interfaces on the S5720-52X-LI-48S-AC), and S5720S-LI

Format

flow-control negotiation receive

undo flow-control negotiation receive
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Flow control prevents packet loss caused by network congestion. Received flow control auto-negotiation enables a device to determine whether to enable received flow control by negotiating with the peer device. On a unidirectional communication network, you can run the flow-control negotiation receive command on the Ethernet interface functioning as the outbound interface at the transmit side to enable received flow control auto-negotiation, and run the flow-control negotiation command on the inbound interface at the receive side to enable flow control auto-negotiation. After received flow control auto-negotiation is enabled on the Ethernet interface, if congestion occurs on a device, the device sends a message to request the peer device to stop sending packets, which prevents packet loss.

Prerequisites

The Ethernet interface has been configured to work in auto-negotiation mode using the negotiation auto command.

Precautions

    Electrical interfaces support this configuration.

    Received flow control auto-negotiation can be implemented only if flow control auto-negotiation is enabled on the interface of the peer device.
    Flow control, received flow control, flow control auto-negotiation, and received flow control auto-negotiation can be configured on Ethernet interfaces, but cannot be configured together. For example, if received flow control auto-negotiation has been enabled on an Ethernet interface using the flow-control receive command, you need to run the undo flow-control receive command to disable received flow control and then run the flow-control negotiation receive command. Otherwise, the flow-control negotiation receive command fails to be executed.

    XGE optical interfaces support this command after GE copper modules are installed on them.
    GE optical interfaces support this command after GE optical or GE copper modules are installed on them.
    This command can be used on an 25GE optical interface that has a GE copper module installed. Before installing a GE copper module on a 25GE optical interface, you need to run the port mode ge command to configure the interface to work at the rate of 1 Gbit/s.

Multicast functions (Layer 2 and Layer 3 multicast) and the flow control function (configured using the flow-control command) are mutually exclusive on the following models: S2730S-S, S5735-L-I, S5735-L1, S300, S5735-L, S5735S-L1, S500, S5735-S, S5735-S-I
Example
# Enable received flow control auto-negotiation on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] negotiation auto
[HUAWEI-GigabitEthernet0/0/1] flow-control negotiation receive

flow-control receive
Function

The flow-control receive command enables received flow control on an Ethernet interface.

The undo flow-control receive command disables received flow control on an Ethernet interface.

By default, received flow control is disabled on an Ethernet interface.

The following interfaces do not support this command:

    S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002), and S5732-H48XUM2CC
        25G, 40G, and 100G interfaces of the device.
        Four SFP28 Ethernet optical interfaces (25GE by default) and two QSFP28 Ethernet optical interfaces (40GE by default) have been configured using the set device port-config-mode enable command.
        8*10GE ports and 2*25GE ports when the S7X08000 card is installed.
        8*25GE ports when the S7Y08000 card is installed.
    GE interfaces of the S5735S-H24S4XC-A
    GE interfaces of the S5736-S24S4XC and S5736-S48S4XC
    When the RTU license is not loaded on the S6730-H24X4Y4C, the first eight XGE interfaces numbered 0/0/1 to 0/0/8 do not support flow control. In V200R021C00 and later versions, the RTU license can be loaded. After the license is loaded, the interface rate is increased from 10 Gbit/s to 25 Gbit/s, and the first eight 25GE interfaces numbered 0/1/1 to 0/1/8 do not support flow control.
    First eight 25GE interfaces of the S6730-H28Y4C
    XGE interfaces that have copper modules installed on the S6735-S

Format

flow-control receive

undo flow-control receive
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Flow control prevents packet loss caused by network congestion. On a unidirectional communication network, after received flow control is enabled on the Ethernet interface at the transmit side using the flow-control receive command and flow control is enabled on the Ethernet interface at the receive side using the flow-control command, if congestion occurs on the device at the receive side, the device sends a message to the device at the transmit side to notify it to stop sending packets. After receiving the message, the device at the transmit side temporarily stops sending packets to the device at the receive side regardless of the interface working rate, preventing congestion. In this case, the device at the transmit side can receive pause frames, but cannot send pause frames; the device at the receive side can receive and send pause frames.
Precautions

    Flow control can be implemented only after flow control is enabled on the peer device.

    Flow control, received flow control, flow control auto-negotiation, and received flow control auto-negotiation can be configured on Ethernet interfaces, but cannot be configured together.

    When an interface works in half-duplex mode, received flow control does not take effect.

    In a scenario where Layer 3 services are deployed, enabling received flow control may affect the IP traffic forwarding on the interface. As a result, the interface becomes unavailable. You can run the undo flow-control receive command in the interface view to disable received flow control to recover the interface.
    For the S2730S-S, S5735-L1, S5735-L-I, S300, S5735-L, S5735S-L1, S5735-S, S500, S5735-S-I, , the multicast functions (both Layer 2 and Layer 3 multicast functions) conflict with the flow control function.

Example

# Enable received flow control on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] flow-control receive

group-member
Function

The group-member command adds specified Ethernet interfaces to a permanent port group.

The undo group-member command deletes specified Ethernet interfaces from a permanent port group.

By default, no Ethernet interface is added to a permanent port group.
Format

group-member { interface-type interface-number1 [ to interface-type interface-number2 ] } &<1-10>

undo group-member { interface-type interface-number1 [ to interface-type interface-number2 ] } &<1-10>

undo group-member all-unavailable-interface
Parameters
Parameter 	Description 	Value

interface-type interface-number1 to interface-type interface-number2
	

Adds an Ethernet interface to a permanent port group.

to indicates an interface range. All interfaces numbered between interface-number1 and interface-number2 are added to the temporary port group.
	

interface-number2 must be greater than interface-number1.

all-unavailable-interface
	

Delete all unavailable interfaces from this port-group.
	

-
Views

Permanent port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If you need to perform the same operations on multiple Ethernet interfaces, configuring each interface one by one easily causes incorrect configurations and is labor-intensive.

The port group function easily solves the problem. You can add all the Ethernet interfaces to the same port group. After you run a configuration command once in the port group view, the configuration takes effect on all the Ethernet interfaces in the port group, reducing the configuration workload.

Prerequisite

Prior to running this command, run the port-group command in the system view to create a permanent interface group.

Configuration Impact

If the group-member command is run more than once, all configurations take effect.

Precautions

    Both physical and logical interfaces can be added to a permanent port group.

    This command has the same function as the port-group group-member command that is used in the system view. You can also run the port-group group-member command to add interfaces to a temporary port group to configure the interfaces in batches.

    When you specify the keyword to in the group-member command:
        The interfaces specified before and after the keyword to must have the same attribute. For example, both of them are main interfaces or sub-interfaces. If they are sub-interfaces, they must belong to the same main interface.
        If to is not used, these limitations do not apply.

        Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support sub-interfaces.

Example
# Add GE0/0/1 and GE0/0/2 to port group portgroup1.

<HUAWEI> system-view
[HUAWEI] port-group portgroup1
[HUAWEI-port-group-portgroup1] group-member gigabitethernet 0/0/1 to gigabitethernet 0/0/2

interface (Ethernet interface)
Function

The interface command displays the specified interface view or sub-interface view.

The undo interface command deletes a sub-interface.
Format

interface { ethernet | gigabitethernet | multige | xgigabitethernet | 25ge | 40ge | 100ge } interface-number[.subinterface-number ] [ mode l2 ]

undo interface { ethernet | gigabitethernet | multige | xgigabitethernet | 25ge | 40ge | 100ge } interface-number[.subinterface-number ]
Parameters

Parameter
	

Description
	

Value

ethernet
	

Displays the view of an FE interface.
	

-

gigabitethernet
	

Displays the view of a GE interface.
	

-

multige
	

Displays the view of a MultiGE interface.
NOTE:

Only the S5720-28X-PWH-LI-AC, S5720-28X-PWH-LI-ACF, S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC, S5731-S24N4X2Q-A, S5731-S24UN4X2Q, S5731-S8UM16UN2Q, S5731S-S24N4X2Q-A1, S5731S-S24UN4X2Q-A, S5731S-S8UM16UN2Q-A, and S5736-S24UM4XC support MultiGE interfaces.
	

-

xgigabitethernet
	

Displays the view of an XGE interface.
	

-

25ge
	

Displays the view of a 25GE interface.
	

-

40ge
	

Displays the view of a 40GE interface.
	

-

100ge
	

Displays the view of a 100GE interface.
	

-

interface-number
	

Specifies the number of an interface.
	

The value depends on the interface type and slot ID.

subinterface-number
	

Specifies the number of a sub-interface.
	

The value is an integer that ranges from 1 to 4096.

mode l2
	

Configures a sub-interface to work in Layer 2 mode for the VXLAN service.
NOTE:

Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support this parameter.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

After entering the specified Ethernet interface view, you can set attributes for the Ethernet interface.

A main interface cannot be configured with both a Layer 2 VXLAN sub-interface and a common Layer 3 sub-interface. That is, for a main interface, it is not allowed to specify the mode l2 parameter for one sub-interface while the other sub-interface does not support this parameter.

    Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support Ethernet sub-interfaces.
    Only hybrid and trunk interfaces on the preceding switches support Layer 2 Ethernet sub-interface configuration.

    After you run the undo portswitch command to switch Layer 2 interfaces on the preceding series of switches into Layer 3 interfaces, you can configure Layer 3 Ethernet sub-interfaces on the interfaces.

    After an interface is added to an Eth-Trunk, sub-interfaces cannot be configured on the interface.
    VLAN termination sub-interfaces cannot be created on a VCMP client.

Example

# Enter the view of GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1]

interface range
Function

The interface range command creates a temporary interface group and adds specified interfaces to this temporary interface group. Commands configured for a temporary interface group then automatically run on all member interfaces.

By default, no temporary interface group is created.
Format

interface range { interface-type interface-number1 [ to interface-type interface-number2 ] } &<1-10>
Parameters
Parameter 	Description 	Value
interface-type interface-number1 [ to interface-type interface-number2 ] 	Specifies Ethernet interfaces to be added to a temporary port group.

to indicates an interface range. All interfaces numbered between interface-number1 and interface-number2 are added to the temporary port group.
	The value of interface-number2 must be larger than the value of interface-number1.

A maximum of 48 temporary port groups can be created on a device.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If you need to perform the same operations on multiple Ethernet interfaces, configuring each interface one by one easily causes incorrect configurations and is labor-intensive.

The port group function easily solves the problem. You can add all the Ethernet interfaces to the same port group. After you run a configuration command once in the port group view, the configuration takes effect on all the Ethernet interfaces in the port group, reducing the configuration workload.

Configuration Impact

If the interface range command is run more than once, all configurations take effect.

Precautions

    The interface range and port-group group-member commands have the same functions. Therefore, use either of the commands for configuration. After exiting from the temporary port group view, the system deletes the temporary port group.

    The interface range command is equivalent to the group-member command executed in the permanent port group view. Multiple interfaces can be added to a permanent port group in batches using the group-member command.

    When you specify the keyword to in the interface range command:
        The interfaces specified by interface-number1 and interface-number2 must reside on the same member switch. To add contiguous interfaces on different member switches to the same port group, run this command several times or use the keyword to several times.
        The interfaces specified by interface-number1 and interface-number2 must be of the same type, for example, both of the interfaces are GE interfaces.
        The interfaces specified before and after the keyword to must have the same attribute. For example, both of them are main interfaces or sub-interfaces. If they are sub-interfaces, they must belong to the same main interface.
        If to is not specified, the preceding limitations do not apply.

        Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support sub-interfaces.

Example
# Add GE0/0/1, 0/0/2, and 0/0/3 to a temporary port group.

<HUAWEI> system-view
[HUAWEI] interface range gigabitethernet 0/0/1 to gigabitethernet 0/0/3
[HUAWEI-port-group]

jumboframe enable (interface view)
Function

The jumboframe enable command sets the maximum frame length allowed by an interface.

The undo jumboframe enable command restores the default maximum frame length allowed by an interface.

By default, the maximum frame length allowed by other switches is 9216 bytes.

    S200, S1730S-S1, S500, S5735-S, S5735-S-I, S2730S-S, S5735-L1, S5735-L-I, S300, S5735-L, S5735S-L1: You can configure the maximum frame length in the system view. For details, see jumboframe enable (system View).
    Other models: You can run this command in the interface view to configure the maximum frame length allowed by interfaces.

Format

jumboframe enable [ value ]

undo jumboframe enable
Parameters

Parameter
	

Description
	

Value

value
	

Specifies the maximum frame length allowed by an Ethernet interface.
	

The value is an integer, in bytes.

    On the SS1720GW-E, S1720GWR-E, S5720I-SI, S5720-LI, S5720S-LI, S5735S-H, S5736-S, S6720S-S the value is an integer that ranges from 1536 to 10240, in bytes.
    On the S5732-H24S6Q, S5732-H48S6Q, S6730-H, S6730S-H, S6730-S, and S6730S-S, the value is an integer that ranges from 1536 to 12288, in bytes.
    On the S5731-S24N4X2Q-A, S5731-S24UN4X2Q, S5731-S8UM16UN2Q, S5731S-S24N4X2Q-A1, S5731S-S24UN4X2Q-A, S5731S-S8UM16UN2Q-A, S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC, S5731-H, S5731S-H, S5731-S, and S5731S-S, the value is an integer that ranges from 1536 to 9600, in bytes.
    On the S6735-S, the value is an integer that ranges from 1536 to 9216, in bytes.

NOTE:

On the SS1720GW-E, S1720GWR-E, S5720I-SI, S5720-LI, S5720S-LI, S5735S-H, S5736-S, S6720S-S, value cannot be set to an odd number.

For GE electrical interfaces on the S5735S-H and S5736-S, value can only be set to 10232.

If value is set to an odd number in a version earlier than V200R008, the value of value increases by one automatically after the system software is upgraded to V200R008 or later versions. For example, value is set to 8879 in V200R007. After the system software is upgraded to V200R008, the value of value is 8880.
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view, Eth-Trunk interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When transmitting a large amount of data (such as files and videos), an Ethernet interface may receive jumbo frames. If the jumbo frame length exceeds the default data frame length that can be processed, the device directly discards the jumbo frames. You can set the jumbo frame length allowed on an interface.

After you configure the device to allow jumbo frames, packet forwarding becomes more flexible. If multiple common Ethernet frames are used to transmit a data packet, many redundant contents such as interframe gaps (IFGs) and preambles are also transmitted. If jumbo frames are used to transmit the data packet, fewer frames, as well as fewer IFGs and preambles, are transmitted, improving bandwidth efficiency.

Precautions

If you run the jumboframe enable command multiple times in the same interface view to set the maximum frame length allowed by the interface, only the latest configuration takes effect.

If you run the jumboframe enable command on an interface without specifying the value parameter, the interface allows the default jumbo frame length. By default, the jumbo frame length allowed by Ethernet interfaces of other models is 9216 bytes.

If the length of an outgoing packet exceeds the maximum frame length allowed on an interface, the interface can directly forward the packet.

If the maximum frame length allowed by interfaces is configured in batches through the port group function, the maximum frame length range displayed when the jumboframe enable ? command is executed in the port group view is 1536-12288. The actual maximum frame length allowed by the interfaces is defined in Parameters. Configure the maximum frame length as required.
Example

# Set the maximum frame length allowed by GE0/0/1 to 5000 bytes.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] jumboframe enable 5000

jumboframe enable (system View)
Function

The jumboframe enable command configures the maximum frame length allowed by interfaces.

The undo jumboframe enable command restores the default maximum frame length allowed by interfaces.

By default, the maximum frame length allowed by interfaces on a switch is 10240 bytes.

    S200, S1730S-S1, S500, S5735-S, S5735-S-I, S2730S-S, S5735-L1, S5735-L-I, S300, S5735-L, S5735S-L1: You can run this command in the system view to configure the maximum frame length allowed by interfaces.
    Other models: You can configure the maximum frame length in the interface view. For details, see jumboframe enable (interface view).

Format

jumboframe enable [ value ]

undo jumboframe enable
Parameters

Parameter
	

Description
	

Value

value
	

Specifies the maximum frame length allowed by Ethernet interfaces.
	

The value is an integer that ranges from 1536 to 10240, in bytes.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When transmitting a large amount of data (such as files and videos), an Ethernet interface may receive jumbo frames. If the jumbo frame length exceeds the default data frame length that can be processed, the device directly discards the jumbo frames. You can set the jumbo frame length allowed on an interface.

After you configure the device to allow jumbo frames, packet forwarding becomes more flexible. If multiple common Ethernet frames are used to transmit a data packet, many redundant contents such as interframe gaps (IFGs) and preambles are also transmitted. If jumbo frames are used to transmit the data packet, fewer frames, as well as fewer IFGs and preambles, are transmitted, improving bandwidth efficiency.

Precautions

    After you run this command in the system view to configure the maximum frame length allowed by interfaces, the configuration takes effect on all interfaces of the switch.
    If you run the jumboframe enable command in the system view without specifying the value parameter, the interface allows frames of the maximum length of 10240 bytes.
    If the length of an outgoing packet exceeds the maximum frame length allowed on an interface, the interface can directly forward the packet.

Example

# Set the maximum frame length allowed by interfaces to 10000 bytes.

<HUAWEI> system-view
[HUAWEI] jumboframe enable 10000

log-threshold input-rate output-rate
Function

The log-threshold input-rate output-rate command sets the inbound and outbound bandwidth usage thresholds for generating a log.

The undo log-threshold input-rate output-rate command restores the default inbound and outbound bandwidth usage thresholds for generating a log.

The default inbound and outbound bandwidth usage thresholds for generating a log is 80.
Format

log-threshold { input-rate | output-rate } bandwidth-in-use [ resume-rate resume-threshold ]

undo log-threshold { input-rate | output-rate }
Parameters
Parameter 	Description 	Value

input-rate
	

Specifies the inbound bandwidth.
	

-

output-rate
	

Specifies the outbound bandwidth.
	

-

bandwidth-in-use
	

Specifies the bandwidth usage threshold for generating a log.
	

The value is an integer that ranges from 1 to 100.

resume-rate resume-threshold
	

Specifies the bandwidth usage threshold for clearing a log.
	

The value is an integer that ranges from 1 to the value of bandwidth-in-use. The default value is the value of bandwidth-in-use.
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view
Default Level

2: Configuration level
Usage Guidelines

Monitoring bandwidth usage helps you know current load on a device. If the bandwidth usage exceeds a threshold, bandwidth resources are insufficient and the device capacity needs to be expanded. For example, if the bandwidth usage exceeds 95%, an alarm is generated, indicating that bandwidth resources are almost exhausted. As a result, some services may be interrupted before device capacity expansion.

You can configure two thresholds: low threshold (log threshold) and high threshold (alarm threshold). The system generates a log when the bandwidth usage exceeds the low threshold and generates an alarm when the bandwidth usage exceeds the high threshold. This configuration ensures that you can expand the device capacity in advance to avoid service interruptions caused by bandwidth exhaustion.

Outbound bandwidth usage threshold = (Outbound interface rate/Outbound physical interface bandwidth) x 100

Inbound bandwidth usage threshold = (Inbound interface rate/Inbound physical interface bandwidth) x 100

The trap-threshold command is used to set the bandwidth usage threshold for generating a trap.
The log-threshold input-rate output-rate command with the following parameters provides various functions:

    log-threshold input-rate bandwidth-in-use resume-rate resume-threshold: sets the inbound bandwidth usage threshold for generating a log to provide the following functions:
        If inbound bandwidth usage value exceeds the value of bandwidth-in-use, an IFNET_BWRATE_IN_RISING log is generated, indicating that inbound bandwidth usage exceeds the configured threshold.
        If inbound bandwidth usage value is lower than the value of resume-threshold, an IFNET_BWRATE_IN_RESUME log is generated, indicating that inbound bandwidth usage is lower than the configured threshold.
    log-threshold output-rate bandwidth-in-use resume-rate resume-threshold: sets the outbound bandwidth usage threshold for generating a log to provide the following functions:
        If outbound bandwidth usage value exceeds the value of bandwidth-in-use, an IFNET_BWRATE_OUT_RISING log is generated, prompting for a bandwidth increase request.
        If outbound bandwidth usage falls below the threshold specified by resume-threshold, an IFNET_BWRATE_OUT_RESUME log is generated, indicating that bandwidth usage has been restored.

If the offset between the value of bandwidth-in-use and the value of resume-threshold is too small, log information may be frequently displayed.

The log threshold must be lower than the trap threshold, providing efficient protection for services. For example, when the inbound bandwidth usage reaches 80%, a log is generated. If the inbound bandwidth usage continues to increase and reaches 95%, a trap is generated. This ensures that a log is generated for inbound bandwidth usage of 80%, and a trap is generated for inbound bandwidth usage of 95%. Either the log or the trap prompts for a bandwidth increase, preventing service interruption.
Example

# Configure GE0/0/1 to generate a log when the outbound interface rate exceeds 80% of the bandwidth.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] log-threshold output-rate 80

# Configure GE0/0/1 to generate a log when the outbound interface rate exceeds 80% of the bandwidth and to clear a log when the outbound interface rate is lower than 60% of the bandwidth.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] log-threshold output-rate 80 resume-rate 60

log-threshold input-discard output-discard (interface view)
Function

The log-threshold input-discard command sets the log threshold for congestion-triggered packet loss and interval for collecting statistics on discarded packets in the inbound direction of an interface.

The log-threshold output-discard command sets the log threshold for congestion-triggered packet loss and interval for collecting statistics on discarded packets in the outbound direction of an interface.

The undo log-threshold input-discard command restores the default settings.

The undo log-threshold output-discard command restores the default settings.

By default, the log threshold for congestion-triggered packet loss in the inbound or outbound direction of an interface is 3000, and the interval for collecting statistics on discarded packets in the inbound or outbound direction of an interface is 300s.
Format

log-threshold { input-discard | output-discard } [ threshold-value interval interval-value ]

undo log-threshold { input-discard | output-discard }
Parameters
Parameter 	Description 	Value

input-discard
	

Records logs about congestion-triggered packet loss in the inbound direction of an interface.
	

-

output-discard
	

Records logs about congestion-triggered packet loss in the outbound direction of an interface.
	

-

threshold-value
	

Specifies the log threshold for congestion-triggered packet loss.
	

The value is an integer in the range from 100 to 4294967295.

interval interval-value
	

Specifies the interval for collecting statistics on discarded packets due to congestion.
	

The value is an integer in the range from 60 to 86400, in seconds.
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Network congestion during service transmission may cause packet loss. If a lot of packets are discarded, services are affected. To better monitor the number of discarded packets, you can run the log-threshold output-discard or log-threshold input-discard command to set the threshold for packet loss caused by congestion and interval for collecting statistics on discarded packets in the inbound or outbound direction of an interface. The device generates a log when the number of discarded incoming and outgoing packets on the interface in a specified period exceeds the threshold. Logs help you know the congestion on the interface. You can determine whether to increase the bandwidth or cancel the bandwidth limit on the interface based on the logs. In this way, the congestion problem can be solved.

Precautions

    If the number of discarded incoming and outgoing packets falls below the threshold in a specified period, the device generates a log indicating that the number of discarded packets falls below the threshold.

    If the number of discarded packets exceeds the threshold in an interval for collecting statistics on discarded packets, the device immediately generates a log indicating that the number of discarded packets exceeds the threshold, and enters the next statistics interval. In the next statistics interval, the number of discarded packets on an interface is calculated using the following formula:

    Number of discarded packets = Current number of discarded packets - Number of discarded packets in the beginning of the statistics interval
    If the number of discarded packets exceeds the threshold in several consecutive statistics intervals, the device only generates a log in the first statistics interval, indicating that the number of discarded packets exceeds the threshold. If the number of discarded packets falls below the threshold, the device generates a log indicating that the number of discarded packets falls below the threshold. If the number of discarded packets on an interface exceeds the threshold again, the device will generate a log indicating that the number of discarded packets exceeds the threshold.
    If the user log function is disabled in the system view, the user log function no longer takes effect in the interface view. To record user logs, run the log-threshold { input-discard | output-discard }* command in the system view to enable the log function first.

Example

# Set the log threshold for congestion-triggered packet loss to 100 and interval for collecting statistics on discarded packets to 60 seconds in the inbound direction of GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] log-threshold input-discard 100 interval 60

log-threshold
Function

The log-threshold command enables the log function for congestion-triggered packet loss on all interfaces of a device.

The undo log-threshold command disables the log function for congestion-triggered packet loss on all interfaces of a device.

By default, the log function is enabled for congestion-triggered packet loss on all interfaces of a device.
Format

log-threshold { input-discard | output-discard }*

undo log-threshold { input-discard | output-discard }*
Parameters
Parameter 	Description 	Value

input-discard
	

Records logs about congestion-triggered packet loss in the inbound direction of an interface.
	

-

output-discard
	

Records logs about congestion-triggered packet loss in the outbound direction of an interface.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Enable or disable the log function for congestion-triggered packet loss on all interfaces of a device in the system view.
Example

# Enable the log function for inbound congestion-triggered packet loss on a device.

<HUAWEI> system-view
[HUAWEI] log-threshold input-discard 

loopback
Function

The loopback command enables loopback detection on an interface.

The undo loopback command disables loopback detection on an interface.

By default, loopback detection is not configured on an interface.
Format

loopback internal

undo loopback
Parameters

Parameter
	

Description
	

Value

internal
	

Configures internal loopback detection on interfaces.
	

-
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, MultiGE interface view. 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When testing some special functions, for example, locating an Ethernet fault, you need to enable loopback detection on Ethernet interfaces to check whether the interfaces are working properly. After internal loopback detection is enabled on an Ethernet interface, the interface is always physically up if it works properly and is down if it fails.

In internal loopback detection, a packet from an interface is sent back to the interface through the internal chip. Internal loopback detection checks whether the connection between the interface and internal chip is normal. In external loopback detection, a packet from an interface is sent back to the interface through a loopback connector. External loopback detection checks whether the interface properly sends and receives packets. Currently, the device supports only internal loopback detection. In Figure 1, after internal loopback detection is configured on GE0/0/1, the chip generates some test packets, and these packets are sent back to the chip through GE0/0/1. The internal loopback detection is then complete.
Figure 4-1 Internal loopback detection

Follow-up Procedure

Run the display interface command to check whether the current status of the interface configured with internal loopback detection is up. If so, the internal forwarding function works properly; otherwise, a fault occurs during internal forwarding.

After loopback detection is enabled on an interface, the Speed field in the display this interface command output indicates the configured interface rate or the rate of the installed optical module, copper module, or network cable, and the Bandwidth field in the display interface ethernet brief command output indicates the actual interface rate. Installing and then removing the optical or copper module or restarting the device may affect the actual interface rate.

Precautions

    Loopback detection interrupts the operation of Ethernet interfaces and links. After loopback detection is complete, disable loopback detection immediately.
    The loopback command cannot be used to perform loopback detection on a fabric port.
    The loopback command and the single-fiber enable command cannot be configured on the same interface.
    The loopback internal command configures the loopback detection mode but not loop detection for an Ethernet interface. If the Ethernet interface works properly, it is always physically up. To detect loops, run the loopback-detect enable command on the interface.

Example
# Configure internal loopback detection on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] loopback internal
Warning: The configuration may cause loops.

loopbacktest
Function

The loopbacktest command configures internal loopback detection on an interface.

By default, internal loopback detection is not configured.
Format

loopbacktest internal
Parameters

Parameter
	

Description
	

Value

internal
	
Configures internal loopback detection. Internal loopback detection is used to check whether the internal forwarding chip controls forwarding on the interface correctly.

    If the test packet is received, the internal forwarding chip functions properly.
    If the test packet is not received, the internal forwarding chip is faulty.

	

-
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view
Default Level

3: Management level
Usage Guidelines

You can run the loopbacktest command to check whether the internal forwarding chip functions properly.

Loopback detection is not required when an interface is shut down.

Loopback detection is not supported on a service stack interface.

The internal loopback detection result can be used only when no service is configured on the switch.

You cannot run the loopbacktest command to perform loopback detection on a fabric port.

After the energy-saving mode is set to basic or deep, loopback detection is disabled on an interface. Therefore, before performing loopback detection, set the energy-saving mode to standard.
Example

# Configure internal loopback detection on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] loopbacktest internal
Warning: This command may conflict with other service configurations. It can only be used on a device with no configuration. Continu
e?[Y/N]:y
Info: This operation may take a few seconds. Please wait for a moment....................
Info: Loopback packet test succeeded.

mdi
Function

The mdi command configures the medium dependent interface (MDI) mode of an Ethernet electrical interface.

The undo mdi command restores the default MDI mode of an Ethernet electrical interface.

By default, an Ethernet electrical interface automatically identifies the network cable type.
Format

mdi { across | auto | normal }

undo mdi
Parameters

Parameter
	

Description
	

Value

across
	

Sets the MDI mode of an Ethernet electrical interface to across.
	

-

auto
	

Sets the MDI mode of an Ethernet electrical interface to auto. An Ethernet electrical interface automatically identifies the network cable type.
	

-

normal
	

Sets the MDI mode of an Ethernet electrical interface to normal.
	

-
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Twisted pairs used to connect Ethernet devices include:

    Straight-through cable: connects devices of different types, such as a switch and a PC or a switch and a router.
    Crossover cable: connects devices of the same type, such as two switches, two routers, or two PCs.

Generally, if two interfaces are connected with a twisted-pair cable, the receive pin on the local end must be connected to the transmit pin on the remote end and the transmit pin on the local end must be connected to the receive pin on the remote end so that a link can be Up. According to pin assignment, twisted-pair cables are classified into straight-through and crossover cables. The device must support negotiation and crossover of receive and transmit pins so that Ethernet electrical interfaces can support the two types of twisted-pair cables. The device supports the following medium dependent interface (MDI) modes: auto, normal, and across.
Generally, when interfaces at both ends work in auto mode, devices can communicate regardless of whether the straight-through or crossover cable is used. Set the MDI mode to normal or across only when the device cannot identify the network cable type. When configuring an MDI mode on an interface, pay attention to the following points:

    When a straight-through cable is used, the local and remote interfaces must use different MDI modes, for example, across mode on one end and normal mode on the other end.
    When a crossover cable is used, the local and remote interfaces must use the same MDI mode. For example, both ends must use the across or normal mode, or at least one end uses the auto mode

Electrical interfaces support the MDI type configuration.

The XGE electrical interfaces on the ES5D21X08T00 card of the S5731-H, and S5731S-H can only use the auto MDI type.

The MDI type can be configured on an optical interface that has a GE copper module installed. Before installing a GE copper module on a 25GE optical interface, you need to run the port mode ge command to configure the interface to work at the rate of 1 Gbit/s.
Example

# Set the MDI mode of GE0/0/1 to across.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] mdi across

negotiation auto
Function

The negotiation auto command configures an Ethernet interface to work in auto-negotiation mode.

The undo negotiation auto command configures an Ethernet interface to work in non-auto negotiation mode.

By default, an Ethernet interface works in auto-negotiation mode.
Format

negotiation auto

undo negotiation auto
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, port group view, Meth interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Earlier Ethernet worked in 10M half-duplex mode and required mechanisms such as Carrier Sense Multiple Access (CSMA)/Collision Detection (CD) to ensure system stability. As Ethernet technology develops, full-duplex Ethernet and 100 Mbit/s Ethernet emerge. This greatly improves Ethernet performance. Auto-negotiation technology allows new Ethernet to be compatible with earlier Ethernet. In auto-negotiation mode, interfaces on both ends of a link negotiate their operating parameters, including the duplex mode and rate. If the negotiation succeeds, the two interfaces work at the same operating parameters.

Precautions

    For details about Ethernet interfaces supporting the auto-negotiation function, see Licensing Requirements and Limitations for Ethernet Interfaces.
    By default, auto-negotiation is enabled on GE optical interfaces and rate auto-negotiation is disabled. You can run the speed auto-negotiation command to enable rate auto-negotiation.
    When a GE optical module is installed on an XGE optical interface, the interface works in auto-negotiation mode by default. To configure the interface to work in non-auto-negotiation mode, run the undo negotiation auto command. If you replace the GE optical module with an XGE optical module, the interface does not support the auto-negotiation mode and works in non-auto-negotiation mode by default. If you replace the XGE optical module with a GE optical module, the undo negotiation auto command configuration becomes ineffective. If you need the interface to still work in non-auto-negotiation mode, reconfigure this command.
    After configuring the auto-negotiation function on an interface, if you remove and install a single optical fiber on the interface, the interface may be Up and the remote interface may be Down. You can run the shutdown and undo shutdown commands on the remote interface to make the remote interface go Up.
    Before you insert a GE optical module in an XGE interface, you are advised to run the device transceiver 1000base-x command and then the undo negotiation auto command to make the interface automatically take effect after the GE optical module is inserted.

Example
# Configure GE0/0/1 to work in non-auto negotiation mode.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] undo negotiation auto

negotiation priority
Function

The negotiation priority command configures the protocol that a MultiGE interface in auto-negotiation mode preferentially uses.

The undo negotiation priority command restores the default protocol that a MultiGE interface in auto-negotiation mode preferentially uses.

By default, a MultiGE interface in auto-negotiation mode preferentially uses IEEE 802.3bz.

Only multi-GE interfaces on the S5720-28X-PWH-LI-AC, S5720-28X-PWH-LI-ACF, S5732-H48XUM2CC, S5736-S24UM4XC, S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002) support this command.
Format

negotiation priority { 802.3bz | mgbase-t }

undo negotiation priority
Parameters
Parameter 	Description 	Value

802.3bz
	

Configures IEEE 802.3bz as the protocol that a MultiGE interface in auto-negotiation mode preferentially uses.
	

-

mgbase-t
	

Configures Mgbase-t as the protocol that a MultiGE interface in auto-negotiation mode preferentially uses.
NOTE:

Only the S5732-H24UM2CC, S5732-H48XUM2CC, and S5732-H48UM2CC do not support this parameter.
	

-
Views

MultiGE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If the peer device supports 2.5 Gbit/s or 5 Gbit/s rate when the peer device connects to the MultiGE interface of Huawei switch and the peer device uses the proprietary protocol Mgbase-t of the Broadcom company, the MultiGE interface of the interconnected Huawei switch may fail to be enabled. You can configure Mgbase-t as the protocol that the MultiGE interface on the Huawei switch preferentially uses, so that the MultiGE interface can be properly enabled.
Example

# Configure Mgbase-t as the protocol that a MultiGE interface in auto-negotiation mode preferentially uses.

<HUAWEI> system-view
[HUAWEI] interface MultiGE 0/0/1
[HUAWEI-MultiGE0/0/1] negotiation priority mgbase-t

port clock-mode slave
Function

The port clock-mode slave command sets the clock negotiation mode of an XGE electrical interface to the slave mode.

The undo port clock-mode slave command restores the clock negotiation mode of an XGE electrical interface to the auto-negotiation mode.

By default, the clock negotiation mode of an XGE electrical interface is the auto-negotiation mode.

Only the XGE electrical interfaces of the ES5D21X08T00 cards support this command.
Format

port clock-mode slave

undo port clock-mode slave
Parameters

None
Views

XGE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

On a modern communications network, most telecommunications services require that the frequency offset or time difference between devices be in an acceptable range. When an XGE electrical interface on an ES5D21X08T00 card of a Huawei device connects to a non-Huawei device, the clock negotiation mode of the XGE electrical interface on the local device is auto-negotiation by default. The two devices determine the master/slave relationship based on the negotiation result and perform network clock synchronization. When the local device negotiates to become the master device, the interfaces on both ends may fail to go Up or their rate may decrease due to the impact of the non-Huawei device. In this case, run the port clock-mode slave command to set the clock negotiation mode of the XGE electrical interface of the local device to the slave mode. This configuration ensures clock synchronization between the two devices.

Precautions

If the interfaces on both ends are configured to work in slave mode, clock negotiation will fail and the interfaces cannot go Up.
Example

# Set the clock negotiation mode of an XGE electrical interface to slave.

<HUAWEI> system-view
[HUAWEI] interface XGigabitEthernet 0/1/1
[HUAWEI-XGigabitEthernet0/1/1] port clock-mode slave

port link-flap auto-detect protection disable
Function

The port link-flap auto-detect protection disable command disables global link flapping protection.

The undo port link-flap auto-detect protection disable or port link-flap auto-detect protection enable command enables global link flapping protection.

By default, global link flapping protection is enabled.
Format

port link-flap auto-detect protection disable

undo port link-flap auto-detect protection disable

port link-flap auto-detect protection enable
Parameters

Parameter
	

Description
	

Value

enable
	

Enables global link flapping protection.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If network jitter or a link fault occurs on an interface, the physical status of the interface frequently alternates between Up and Down, affecting service traffic forwarding. After global link flapping detection protection is enabled, if the number of times that an interface alternates between Up and Down within a specified period reaches the configured threshold, the system shuts down the interface so that the interface goes Down. This reduces the impact of interface link flaps on services.

By default, global link flapping protection is enabled and the system detects link flaps on all interfaces. If the number of link flaps on an interface reaches the threshold within the link flapping detection period, the system automatically shuts down this interface and records the interface status as LINK-FLAP DOWN. That is, the interface goes Down due to link flapping protection. By default, the link flapping detection period is 10 seconds, the threshold for the number of link flaps is 5, and the automatic recovery period is 60 seconds. If an interface alternates between Up and Down five times within 10 seconds, the interface goes Down. After 60 seconds, the interface automatically goes Up. To set the link flapping detection period, run the port link-flap auto-detect interval command. To set the threshold for the number of link flaps, run the port link-flap auto-detect threshold command. To set the automatic recovery period, run the port link-flap auto-detect recovery interval command.

Precautions

    To check whether a link flap occurs on a specified interface, run the port link-flap protection enable command on this interface to enable link flapping protection. The link flapping protection function on an interface and the global link flapping protection function are mutually exclusive.
    If link flapping protection is enabled on an interface, global link flapping protection does not take effect on this interface.
    If an interface is set to Down due to link flapping protection, enabling link flapping protection on this interface will restore the interface to Up.
    Stack interfaces do not support link flapping protection.

Example

# Disable global link flapping protection.

<HUAWEI> system-view
[HUAWEI] port link-flap auto-detect protection disable

port link-flap auto-detect interval
Function

The port link-flap auto-detect interval command sets the global link flapping detection period.

The undo port link-flap auto-detect interval command restores the default global link flapping detection period.

By default, the global link flapping detection period is 10s.
Format

port link-flap auto-detect interval interval-value

undo port link-flap auto-detect interval
Parameters

Parameter
	

Description
	

Value

interval interval-value
	

Specifies the global link flapping detection period.
	

The value is an integer that ranges from 5 to 600, in seconds. The default value is 10s.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

If the number of link flaps on an interface reaches the threshold within the link flapping detection period, the system automatically shuts down this interface and records the interface status as LINK-FLAP DOWN. That is, the interface goes Down due to link flapping protection. By default, the link flapping detection period is 10 seconds, the threshold for the number of link flaps is 5, and the automatic recovery period is 60 seconds. If an interface alternates between Up and Down five times within 10 seconds, the interface goes Down. After 60 seconds, the interface automatically goes Up.

If high network reliability is required, you can run this command to shorten the detection period to quickly detect network flapping. Otherwise, you can increase the detection period.
Example

# Set the global link flapping detection period to 50s.

<HUAWEI> system-view
[HUAWEI] port link-flap auto-detect interval 50

port link-flap auto-detect threshold
Function

The port link-flap auto-detect threshold command sets the global threshold for the number of link flaps within a specified period.

The undo port link-flap auto-detect threshold command restores the default global threshold for the number of link flaps within a specified period.

By default, the global threshold for the number of link flaps within a specified period is 5.
Format

port link-flap auto-detect threshold threshold-value

undo port link-flap auto-detect threshold
Parameters

Parameter
	

Description
	

Value

threshold-value
	

Specifies the threshold for the number of link flaps within a specified period.
	

The value is an integer in the range from 1 to 10. The default value is 5.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

If the number of link flaps on an interface reaches the threshold within the link flapping detection period, the system automatically shuts down this interface and records the interface status as LINK-FLAP DOWN. That is, the interface goes Down due to link flapping protection. By default, the link flapping detection period is 10 seconds, the threshold for the number of link flaps is 5, and the automatic recovery period is 60 seconds. If an interface alternates between Up and Down five times within 10 seconds, the interface goes Down. After 60 seconds, the interface automatically goes Up.

If high network reliability is required, you can run this command to reduce the threshold for the number of link flaps to quickly detect network flapping. Otherwise, you can increase the threshold for the number of link flaps.
Example

# Set the threshold for the number of link flaps within a specified period to 5.

<HUAWEI> system-view
[HUAWEI] port link-flap auto-detect threshold 5

port link-flap auto-detect recovery interval
Function

The port link-flap auto-detect recovery interval command sets the automatic recovery period after interfaces go Down due to global link flapping protection.

The undo port link-flap auto-detect recovery interval command restores the default automatic recovery period after interfaces go Down due to global link flapping protection.

By default, the automatic recovery period after interfaces go Down due to global link flapping protection is 60 seconds.
Format

port link-flap auto-detect recovery interval interval-value

undo port link-flap auto-detect recovery interval
Parameters

Parameter
	

Description
	

Value

interval-value
	

Specifies the automatic recovery period after interfaces go Down due to global link flapping protection.
	

The value is an integer that ranges from 60 to 86400, seconds. The default value is 60 seconds, and the increment value is 60 seconds. That is, the value must be a multiple of 60.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

If the number of link flaps on an interface reaches the threshold within the link flapping detection period, the system automatically shuts down this interface and records the interface status as LINK-FLAP DOWN. That is, the interface goes Down due to link flapping protection. By default, the link flapping detection period is 10 seconds, the threshold for the number of link flaps is 5, and the automatic recovery period is 60 seconds. If an interface alternates between Up and Down five times within 10 seconds, the interface goes Down. After 60 seconds, the interface automatically goes Up. To set the automatic recovery period after interfaces go Down due to global link flapping protection, run the port link-flap auto-detect recovery interval command.
Example

# Set the automatic recovery period after interfaces go Down due to global link flapping protection to 120 seconds.

<HUAWEI> system-view
[HUAWEI] port link-flap auto-detect recovery interval 120

port link-flap interval
Function

The port link-flap interval command sets the link flapping detection interval.

The undo port link-flap interval command restores the default link flapping detection interval.

By default, the link flapping detection interval is 10s.
Format

port link-flap interval interval-value

undo port link-flap interval
Parameters

Parameter
	

Description
	

Value

interval interval-value
	

Specifies the link flapping detection interval.
	

The value is an integer that ranges from 5 to 600, in seconds. The default value is 10s.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

A link flap occurs when the physical status of an interface frequently alternates between Up and Down due to network flapping or network cable faults. This causes frequent network topology changes and affects user communication. For example, two links work in primary/backup mode. If the interface of the primary link experiences frequent Up/Down transitions, flows are switched between the primary and backup links. Frequent service switchovers increase load of the device and may result in service data loss.
Link flapping protection can solve the problem. To be specific, you can configure link flapping protection globally or on a specified interface. This function disables interfaces that frequently alternate between Up and Down so that the interfaces become Down. This prevents the network topology from changing frequently. When the system detects frequent physical status changes on the interface of the primary link, the system directly disables the interface to trigger a primary/backup link switchover. The backup link then steadily transmits services. The link flapping protection function involves the following parameters:

    Number of link flaps: A link flap refers to an interface Up/Down transition.
    Link flapping detection period: It is a period during which the system counts the number of link flaps.

If the number of link flaps on an interface reaches the threshold within a link flapping detection period, the system disables the interface and records its status as ERROR DOWN(link-flap) when link flapping protection is configured on this interface or records its status as LINK-FLAP DOWN when link flapping protection is configured globally. By default, after link flapping protection is enabled, an interface goes Down if its status changes five times within 10 seconds.

Prerequisites

The configured interval takes effect only after link flapping protection is enabled using the port link-flap protection enable command on the interface.

Precautions

If you run the port link-flap interval command multiple times in the same interface view, only the latest configuration takes effect.
Example

# Set the link flapping detection interval to 50s on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] port link-flap interval 50

port link-flap protection enable
Function

The port link-flap protection enable command enables link flapping protection on an interface.

The undo port link-flap protection enable command disables link flapping protection on an interface.

By default, link flapping protection is disabled on an interface.
Format

port link-flap protection enable

undo port link-flap protection enable
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

A link flap occurs when the physical status of an interface frequently alternates between Up and Down due to network flapping or network cable faults. This causes frequent network topology changes and affects user communication. For example, two links work in primary/backup mode. If the interface of the primary link experiences frequent Up/Down transitions, flows are switched between the primary and backup links. Frequent service switchovers increase load of the device and may result in service data loss.
Link flapping protection can solve the problem. To be specific, you can configure link flapping protection globally or on a specified interface. This function disables interfaces that frequently alternate between Up and Down so that the interfaces become Down. This prevents the network topology from changing frequently. When the system detects frequent physical status changes on the interface of the primary link, the system directly disables the interface to trigger a primary/backup link switchover. The backup link then steadily transmits services. The link flapping protection function involves the following parameters:

    Number of link flaps: A link flap refers to an interface Up/Down transition.
    Link flapping detection period: It is a period during which the system counts the number of link flaps.

If the number of link flaps on an interface reaches the threshold within a link flapping detection period, the system disables the interface and records its status as ERROR DOWN(link-flap) when link flapping protection is configured on this interface or records its status as LINK-FLAP DOWN when link flapping protection is configured globally. By default, after link flapping protection is enabled, an interface goes Down if its status changes five times within 10 seconds.

Follow-up Procedure

    Run the port link-flap interval interval-value command to set the link flapping interval for the interface.

    Run the port link-flap threshold threshold-value command to set the number of link flappings for the interface.
    An interface in ERROR DOWN(link-flap) state can be recovered using either of the following methods:
        Manual recovery. If a few interfaces need to be recovered forcibly, run the shutdown and undo shutdown commands in sequence in the interface view. Alternatively, run the restart command in the interface view to restart the interface.
        Automatic recovery. If a large number of interfaces need to be recovered, manual recovery is time consuming and error prone. Instead, you can run the error-down auto-recovery cause link-flap interval interval-value command in the system view to enable automatic interface recovery and set the automatic recovery delay. Interfaces in Error-Down state then automatically recover after the specified delay expires.

Example

# Enable link flapping protection on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] port link-flap protection enable

port link-flap threshold
Function

The port link-flap threshold command sets the maximum number of link flapping events on an interface.

The undo port link-flap threshold command restores the default maximum number of link flapping events on an interface.

By default, the maximum number of link flapping events is 5.
Format

port link-flap threshold threshold-value

undo port link-flap threshold
Parameters

Parameter
	

Description
	

Value

threshold threshold-value
	

Specifies the maximum number of link flapping events on an interface.
	

The value is an integer that ranges from 1 to 10. The default value is 5.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

A link flap occurs when the physical status of an interface frequently alternates between Up and Down due to network flapping or network cable faults. This causes frequent network topology changes and affects user communication. For example, two links work in primary/backup mode. If the interface of the primary link experiences frequent Up/Down transitions, flows are switched between the primary and backup links. Frequent service switchovers increase load of the device and may result in service data loss.
Link flapping protection can solve the problem. To be specific, you can configure link flapping protection globally or on a specified interface. This function disables interfaces that frequently alternate between Up and Down so that the interfaces become Down. This prevents the network topology from changing frequently. When the system detects frequent physical status changes on the interface of the primary link, the system directly disables the interface to trigger a primary/backup link switchover. The backup link then steadily transmits services. The link flapping protection function involves the following parameters:

    Number of link flaps: A link flap refers to an interface Up/Down transition.
    Link flapping detection period: It is a period during which the system counts the number of link flaps.

If the number of link flaps on an interface reaches the threshold within a link flapping detection period, the system disables the interface and records its status as ERROR DOWN(link-flap) when link flapping protection is configured on this interface or records its status as LINK-FLAP DOWN when link flapping protection is configured globally. By default, after link flapping protection is enabled, an interface goes Down if its status changes five times within 10 seconds.

Prerequisites

The port link-flap threshold command configuration takes effect only after link flapping protection is enabled using the port link-flap protection enable command on the interface.

Precautions

If you run the port link-flap threshold command multiple times in the same interface view, only the latest configuration takes effect.
Example

# Set the maximum number of link flapping events on GE0/0/1 to 10.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] port link-flap threshold 10

port-group
Function

The port-group command creates a permanent port group and displays the permanent port group view.

The undo port-group command deletes permanent port groups.

By default, no permanent port group is configured.
Format

port-group port-group-name

undo port-group { all | port-group-name }
Parameters

Parameter
	

Description
	

Value

port-group-name
	

Specifies the name of a permanent interface group. The value cannot conflict with the group-member keyword. For example, the name cannot be g, gr, or group-m.
	
The value is a string of 1 to 32 case-insensitive characters without spaces. When double quotation marks are used around the string, spaces are allowed in the string.
NOTE:

A permanent port group cannot be named all. Meanwhile, to avoid a usage conflict between the port-group group-member command and port-group-name, do not specify g, group-member, or first letters of group-member as the name of a permanent interface group.

all
	

Deletes all port groups.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If you need to perform the same operations on multiple Ethernet interfaces, configuring each interface one by one easily causes incorrect configurations and is labor-intensive.

The port group function easily solves the problem. You can add all the Ethernet interfaces to the same port group. After you run a configuration command once in the port group view, the configuration takes effect on all the Ethernet interfaces in the port group, reducing the configuration workload.
Two types of port groups are available:

    Temporary port group: To temporarily deliver a configuration to multiple interfaces, you can create a temporary port group. After you deliver the configuration and exit from the port group view, the system automatically deletes the temporary port group.
    Permanent port group: To deliver configurations to interfaces multiple times, you can create a permanent port group. After you exit from the port group view, the port group and member interfaces in the group still exist, facilitating subsequent batch configuration for the member interfaces. To delete a permanent port group, run the undo port-group { all | port-group-name } command.

Follow-up Procedure

Run the group-member command to add Ethernet interfaces to the created permanent port group.

Precautions

    The system supports a maximum of 32 permanent port groups and each port group supports a maximum of 48 member interfaces.
    Deleting a permanent port group will not clear the configurations of an interface in the port group.

Example

# Create port group portgroup1 and enter the port group view.

<HUAWEI> system-view
[HUAWEI] port-group portgroup1
[HUAWEI-port-group-portgroup1]

port-group group-member
Function

The port-group group-member command creates a temporary port group and adds specified Ethernet interfaces to the temporary port group. Commands configured for a temporary port group will be automatically run on all member interfaces.

By default, no temporary port group is created.
Format

port-group group-member { interface-type interface-number1 [ to interface-type interface-number2 ] } &<1-10>
Parameters
Parameter 	Description 	Value
interface-type interface-number1 [ to interface-type interface-number2 ] 	Specifies Ethernet interfaces to be added to a temporary port group.

to indicates an interface range. All interfaces numbered between interface-number1 and interface-number2 are added to the temporary port group.
	The value of interface-number2 must be larger than the value of interface-number1.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If you need to perform the same operations on multiple Ethernet interfaces, configuring each interface one by one easily causes incorrect configurations and is labor-intensive.

The port group function easily solves the problem. You can add all the Ethernet interfaces to the same port group. After you run a configuration command once in the port group view, the configuration takes effect on all the Ethernet interfaces in the port group, reducing the configuration workload.
Two types of port groups are available:

    Temporary port group: To temporarily deliver a configuration to multiple interfaces, you can create a temporary port group. After you deliver the configuration and exit from the port group view, the system automatically deletes the temporary port group.
    Permanent port group: To deliver configurations to interfaces multiple times, you can create a permanent port group. After you exit from the port group view, the port group and member interfaces in the group still exist, facilitating subsequent batch configuration for the member interfaces. To delete a permanent port group, run the undo port-group { all | port-group-name } command.

Configuration Impact

If the port-group group-member command is run more than once, all configurations take effect.

Precautions

    The port-group group-member command is equivalent to the group-member command executed in the permanent port group view. Multiple interfaces can be added to a permanent port group in batches using the group-member command.

    When you specify the keyword to in the port-group group-member command:
        The interfaces specified by interface-number1 and interface-number2 must reside on the same member switch. To add contiguous interfaces on different member switches to the same port group, run this command several times or use the keyword to several times.
        The interfaces specified by interface-number1 and interface-number2 must be of the same type, for example, both of the interfaces are GE interfaces.
        The interfaces specified before and after the keyword to must have the same attribute. For example, both of them are main interfaces or sub-interfaces. If they are sub-interfaces, they must belong to the same main interface.
        If to is not specified, the preceding limitations do not apply.

        Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support sub-interfaces.

Example
# Add GE0/0/1, GE0/0/2, and GE0/0/3 to a temporary port group.

<HUAWEI> system-view
[HUAWEI] port-group group-member gigabitethernet 0/0/1 to gigabitethernet 0/0/3
[HUAWEI-port-group]

port-isolate enable
Function

The port-isolate enable command enables port isolation.

The undo port-isolate enable command disables port isolation.

By default, port isolation is disabled.
Format

port-isolate enable [ group group-id ]

undo port-isolate enable [ group group-id ]
Parameters

Parameter
	

Description
	

Value

group group-id
	

Specifies the ID of a port isolation group.
	

The value is an integer that ranges from 1 to 64.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view, Eth-Trunk interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

To implement Layer 2 isolation between interfaces, add different interfaces to different VLANs. This, however, wastes VLAN resources. To save VLAN resources, enable port isolation to isolate interfaces in a VLAN. That is, you can add interfaces to a port isolation group to implement Layer 2 isolation between these interfaces. Port isolation provides secure and flexible networking schemes for customers.

Precautions

    After port isolation is configured, ports are isolated at Layer 2 but can communicate at Layer 3 by default. To configure both Layer 2 isolation and Layer 3 isolation, run the port-isolate mode all command.

    Interfaces in a port isolation group are isolated from each other, but interfaces in different port isolation groups can communicate. If group-id is not specified, interfaces are added to port isolation group 1 by default.
    There is no limit on the number of members in a port isolation group on the S200, and S1730S-S1. The maximum number of members in a port isolation group on other switch models is 512.
    In the same VLAN, if the mac-address learning disable command is run to disable MAC address learning and traffic is forwarded in broadcast mode, the device first copies the traffic received on the inbound interface before checking whether port isolation is configured, though port isolation has been configured. When the copied traffic exceeds the chip performance, the device discards the traffic, resulting in packet loss in forwarding.

Example

# Enable port isolation on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] port-isolate enable group 1

port-isolate exclude vlan
Function

The port-isolate exclude vlan command excludes a VLAN where port isolation needs to be disabled.

The undo port-isolate exclude vlan command cancels the configuration.

By default, no VLAN is excluded when port isolation is configured.
Format

port-isolate exclude vlan { vlan-id1 [ to vlan-id2 ] } &<1-10>

undo port-isolate exclude vlan { vlan-id1 [ to vlan-id2 ] } &<1-10>
Parameters

Parameter
	

Description
	

Value

vlan-id1
	

Specifies the ID of a VLAN.
	

The value is an integer that ranges from 1 to 4094.

vlan-id2
	

Specifies the ID of a VLAN.
	

The value is an integer that ranges from 1 to 4094.

vlan-id1 to vlan-id2
	

Specifies VLAN IDs in a batch.

    vlan-id1 specifies the first VLAN ID.

    vlan-id2 specifies the last VLAN ID.

    vlan-id2 must be greater than vlan-id1. vlan-id1 and vlan-id2 determine a VLAN range.

    If you do not specify to vlan-id2, only one VLAN is specified.

	

The values of vlan-id1 and vlan-id2 are integers that range from 1 to 4094.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

To enable communication between users in a VLAN where port isolation needs to be disabled, run the port-isolate exclude vlan command to exclude the VLAN.

Only SS1720GW-E, S1720GWR-E, S5720I-SI, S5720-LI, S5720S-LI, S5735S-H, S5736-S, S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6720S-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support this command.
Example

# Exclude VLAN 10 where port isolation needs to be disabled.

<HUAWEI> system-view
[HUAWEI] port-isolate exclude vlan 10

protect-group member
Function

The protect-group member command adds the specified Ethernet interface to an interface protection group.

The undo protect-group member command deletes an Ethernet interface from an interface protection group.

By default, no Ethernet interface is added to an interface protection group.
Format

protect-group member interface-type interface-number { master | standby }

undo protect-group member interface-type interface-number
Parameters

Parameter
	

Description
	

Value
interface-type interface-number 	Specifies the type and number of the interface to be added to an interface protection group. 	

-
master 	Indicates the working interface. 	

-
standby 	Indicates the protected interface. 	

-
Views

Interface protection group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Hosts are usually connected to an external network through a default gateway. If the outbound interface of the default gateway fails, the hosts cannot communicate with the external network, interrupting normal service transmission and degrading device reliability. The port protection function solves this problem. Without changing the networking, you can add two interfaces on the device to a port protection group to implement interface backup in active/standby mode. When the active interface fails, services are immediately switched to the standby interface, ensuring non-stop service transmission.

Prerequisites

An interface protection group has been created using the port protect-group command.

Precautions
An interface protection group contains only a working interface and a protected interface.
Example

# Add GigabitEthernet0/0/1 to an interface protection group.

<HUAWEI> system-view
[HUAWEI] port protect-group 1
[HUAWEI-protect-group1] protect-group member gigabitethernet 0/0/1 master

port mode 2.5ge
Function

The port mode 2.5ge command configures an interface to work at the rate of 2.5 Gbit/s.

The undo port mode command restores the default interface rate.

By default, the rate of a GE interface is 1 Gbit/s, and the rate of an XGE interface is 10 Gbit/s.
Only the following interfaces on the following models can be configured to work at the rate of 2.5 Gbit/s:

    S5731-S32ST4X, S5731-S32ST4X-A, S5731-S32ST4X-D, S5731S-S32ST4X-A, and S5731S-S32ST4X-A1: 24 downlink GE interfaces
    S5731-S48S4X, S5731-S48S4X-A, S5731S-S48T4X-A, and S5731S-S48T4X-A1: 44 GE interfaces numbered 5 to 48
    S5731-H24HB4XZ and S5731S-H24HB4XZ-A: first 20 downlink GE interfaces and four downlink 10GE interfaces
    S5731-H48HB4XZ and S5731S-H48HB4XZ-A: 28 GE interfaces numbered 1 to 8 and 25 to 44 and four downlink 10GE interfaces
    S5736-S48S4X-A and S5736-S48S4X-D: 48 GE ports and 4 XGE ports on the panel

Format

port mode 2.5ge

undo port mode
Parameters

None
Views

GE interface view, XGE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

GE and XGE interfaces can work at the rate of 2.5 Gbit/s. You can run this command to change the rate of a GE or XGE interface based on networking and bandwidth requirements. After the change, replace the transmission medium to enable the interface to work at the corresponding rate.

For the S5736-S48S4X-A and S5736-S48S4X-D: The working rate of an interface is switched based on a single interface. You can switch the working rate of only one interface at a time. For other models: The working rate of interfaces is switched by group. Every four interfaces form a group. If the working rate of any interface in the group is changed, the working rate of other interfaces in the same group is switched at the same time. For GE interfaces, the four interfaces in the same group work at the same rate (either all 1 Gbit/s or all 2.5 Gbit/s). For XGE interfaces, the following situations exist: The four interfaces in the same group work at the same rate (all 2.5 Gbit/s, all 1 Gbit/s, or all 10 Gbit/s). The four interfaces in the same group work at different rates, that is, some interfaces work at the rate of 1 Gbit/s, while other interfaces work at the rate of 10 Gbit/s.

Precautions

    After an interface is configured to work at the rate of 2.5 Gbit/s, the interface cannot be configured to work in auto-negotiation mode, and does not support single-fiber communication, MACsec, training, FEC, 100M optical modules, GE optical modules, or optical-to-electrical conversion modules.
    After an interface is configured to work at the rate of 2.5 Gbit/s, it cannot be configured as a stack interface. Similarly, after an interface is configured as a stack interface, it cannot be configured to work at the rate of 2.5 Gbit/s.
    For the S5731-H24HB4XZ, S5731-H48HB4XZ, S5731S-H24HB4XZ-A, and S5731S-H48HB4XZ-A, if the interface rate is changed to 2.5 Gbit/s after a subcard is installed, the subcard becomes unavailable due to insufficient bandwidth. You need to confirm the operation as prompted before changing the interface rate.

Example

# Configure a GE interface to work at the rate of 2.5 Gbit/s.

<HUAWEI> system-view
[HUAWEI] interface ge 0/0/3
[HUAWEI-GigabitEthernet0/0/3] port mode 2.5ge
Warning: The interface(s)(GigabitEthernet0/0/1, GigabitEthernet0/0/2, GigabitEthernet0/0/3, GigabitEthernet0/0/4) will be converted to 2.5GE mode, Continue? [Y/N]:y
Info: This operation may take a few seconds. Please wait for a moment.....done. 

port mode ge (25GE interface)
Function

The port mode ge command configures a 25GE interface to work at the rate of 1 Gbit/s.

The undo port mode command restores the rate of a 25GE interface to 25 Gbit/s.

By default, when a 25GE medium is installed on a 25GE interface, the interface works at the rate of 25 Gbit/s; when an XGE medium is installed on a 25GE interface, the interface works at the rate of 10 Gbit/s; when a GE medium is installed on a 25GE interface, the interface cannot go Up.

Only the S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002), S5732-H48XUM2CC, S6730-H28Y4C, S6730-H24X4Y4C, and S7Y08000 cards support this command.

This command is supported when the interface working mode on the S7X08000 or S7X0800K0 card is set to 25GE using the set card port-config-mode 25g-port enable command.
Format

port mode ge

undo port mode
Parameters

None
Views

25GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

A 25GE interface can work at the rate of 1 Gbit/s. You can configure the rate as required and replace the transmission medium.
When a 25GE interface is configured to work at the rate of 1 Gbit/s, all interfaces in the interface group to which the 25GE interface belongs are configured to work at the rate of 1 Gbit/s.

    For the S6730-H28Y4C, each group of interfaces numbered 1 to 4, 5 to 8, 9 to 16, 17 to 20, 21 to 24, or 25 to 28 belong to the same interface group.
    Interfaces numbered 1 and 2 on the S7X08000 or S7X0800K0 card belong to the same interface group.
    For the S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002), S5732-H48XUM2CC, S6730-H24X4Y4C and S7Y08000 card, each group of interfaces (numbered 1 to 4, 5 to 8, and 9 to 12, for example) belong to the same interface group.

Precautions

    Configure the remote interface to work at the same rate as that of the local interface.

    Ensure that all interfaces in the interface group in which the interface rate is to be changed are in Down status before running this command. If the status of an interface is Up, run the shutdown command on the interface and then change the interface rate.
    After the port mode ge command is run on an interface, if any interface in the same interface group as that interface is Up, the command configuration will not be cleared after the clear configuration this or clear configuration interface command is run. If all the interfaces in the interface group are Down, the command configuration will be cleared after the clear configuration this or clear configuration interface command is run.
    25GE interfaces split from other interfaces cannot work at the rate of 1 Gbit/s.

Example

# Configure a 25GE interface to work at the rate of 1 Gbit/s.

<HUAWEI> system-view
[HUAWEI] interface 25ge 0/1/1
[HUAWEI-25GE0/1/1] port mode ge
Warning:The interface(s)(25GE0/1/1,25GE0/1/2) will be converted to GE mode.[Y/N]:y 
Info: This operation may take a few seconds. Please wait for a moment....done.

port-isolate mode
Function

The port-isolate mode command sets the port isolation mode.

The undo port-isolate mode command restores the default port isolation mode.

By default, ports are isolated at Layer 2 but can communicate at Layer 3.
Format

port-isolate mode { l2 | all }

undo port-isolate mode
Parameters

Parameter
	

Description
	

Value

l2
	

Indicates that ports are isolated at Layer 2 but can communicate at Layer 3.
	

-

all
	

Indicates that ports are isolated at both Layer 2 and Layer 3.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

To implement Layer 2 isolation between interfaces, you can add different interfaces to different VLANs. This wastes VLAN resources. Port isolation can isolate interfaces in the same VLAN. That is, you only need to add interfaces to a port isolation group to implement Layer 2 isolation between these interfaces. Port isolation provides secure and flexible networking schemes.

You can configure the interface isolation mode to all to implement Layer 2 and Layer 3 isolation between interfaces in a port isolation group.

The S5720-LI, S2730S-S, S5735-L-I, S5735-L1,S300, S500, S5735-L, S5735S-L1, and S5720S-LI support isolation at Layer 2 and interworking at Layer 3, and do not support this command.
Example

# Configure Layer 2 isolation and Layer 3 communication.

<HUAWEI> system-view
[HUAWEI] port-isolate mode l2

port media type (GE interface view)
Function

The port media type command determines whether an interface configuration item belongs to an optical or electrical interface.

The undo port media type command restores the default settings.
Format

port media type { copper | fiber }

undo port media type { copper | fiber }
Parameters

Parameter
	

Description
	

Value

copper
	

Determines that the interface configuration item belongs to a combo interface or GE interface that is equipped with a copper module and works as an electrical interface.
	

-

fiber
	

Determines that the interface configuration item belongs to a combo interface or GE interface that is equipped with a copper module and works as an optical interface.
	

-
Views

GE interface view
Default Level

2: Configuration level
Usage Guidelines

This command only distinguishes optical interface configuration and electrical interface configuration, and is not configurable.

If you have specified the interface attributes (such as auto-negotiation, speed, and full-duplex mode) on a combo interface, the system automatically generates this command to determine whether an interface configuration item belongs to the optical interface or electrical interface. After this command is generated, the configuration for the other interface type (such as optical interface) will not be lost if the combo interface works as an electrical interface.

For example, after you run the display this command on a combo interface, the interface configuration is as follows:

#  
interface GigabitEthernet0/0/1
 port media type copper        
  undo negotiation auto        
  speed 100                    
 port media type fiber         
  undo negotiation auto        
#    

The command output shows that there are two configuration items undo negotiation auto and speed 100 when the combo interface works as an electrical interface and one configuration item undo negotiation auto when the combo interface works as an optical interface.
Example

None
port media type (XGE interface view)
Function

The port media type command determines whether an interface configuration item belongs to the optical or electrical interface.

The undo port media type command restores the default settings.
Format

port media type { copper | fiber }

undo port media type { copper | fiber }
Parameters

Parameter
	

Description
	

Value

copper
	

Determines the interface configuration item belongs to an XGE interface that is equipped with a copper module and works as an electrical interface.
	

-

fiber
	

Determines the interface configuration item belongs to an XGE interface that is equipped with a copper module and works as an optical interface.
	

-
Views

XGE interface view
Default Level

2: Configuration level
Usage Guidelines

This command cannot be manually configured and belongs to internal implementation commands. This command only distinguishes optical interface configuration and electrical interface configuration, and is not configurable.

If you have installed a copper module on an XGE interface and specified the interface attributes (such as auto-negotiation, speed, and full-duplex mode), the system automatically generates this command to determine whether an interface configuration item belongs to the optical or electrical interface.

For example, after you run the display this command on an XGE interface, the interface configuration is as follows:

#  
interface XGigabitEthernet0/0/1
 port media type copper                                                                                                             
  mdi across                                                                                                                        
 port media type fiber                                                                                                              
  als enable                                                                                                                        
#  

The command output indicates that there is one configuration item mdi across when the XGE interface works as an electrical interface and one configuration item als enable when the XGE interface works as an optical interface.
Example

None
port media type (25GE interface view)
Function

The port media type command determines whether an interface configuration item belongs to an optical or electrical interface.

The undo port media type command restores the default settings.
Format

port media type { copper | fiber }

undo port media type { copper | fiber }
Parameters

Parameter
	

Description
	

Value

copper
	

Determines the interface configuration item belongs to a 25GE interface that is equipped with a GE copper module and works as an electrical interface.
	

-

fiber
	

Determines the interface configuration item belongs to a 25GE interface that is equipped with a GE copper module and works as an optical interface.
	

-
Views

25GE interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

This command only distinguishes optical interface configuration and electrical interface configuration, and is not configurable.

If you have run the port mode ge command to configure a 25GE interface to work at the rate of 1 Gbit/s, installed a GE copper module on the 25GE interface, and specified the interface attributes (such as auto-negotiation and MDI type) for the 25GE interface, the system automatically generates this command to determine whether an interface configuration item belongs to the optical or electrical interface.

For example, after you run the display this command on a 25GE interface, the interface configuration is as follows:

#  
interface 25GigabitEthernet0/0/1
 port media type copper                                                                                                             
  mdi across                                                                                                                        
 port media type fiber                                                                                                              
  als enable                                                                                                                        
#  

The command output indicates that there is one configuration item mdi across when the 25GE interface works as an electrical interface and one configuration item als enable when the 25GE interface works as an optical interface.
Example

None
port protect-group
Function

The port protect-group command creates an interface protection group and enters the interface protection group view.

The undo port protect-group command deletes the created interface protection group.

By default, no interface protection group is created.
Format

port protect-group protect-group-index

undo port protect-group protect-group-index
Parameters

Parameter
	

Description
	

Value
protect-group-index 	Specifies the ID of an interface protection group. 	The value is an integer that ranges from 0 to 63.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Hosts are usually connected to an external network through a default gateway. If the outbound interface of the default gateway fails, the hosts cannot communicate with the external network, interrupting normal service transmission and degrading device reliability. The port protection function solves this problem. Without changing the networking, you can add two interfaces on the device to a port protection group to implement interface backup in active/standby mode. When the active interface fails, services are immediately switched to the standby interface, ensuring non-stop service transmission.

Follow-up Procedure

Run the protect-group member command to add the specified Ethernet interface to an interface protection group.
Example

# Create an interface protection group.

<HUAWEI> system-view
[HUAWEI] port protect-group 1

port work-mode
Function

The port work-mode command sets the working mode of an electrical interface.

The undo port work-mode command restores the default working mode of an electrical interface.

By default, an electrical interface works in auto mode.
Format

port work-mode { master | slave | auto }

undo port work-mode
Parameters

Parameter
	

Description
	

Value

master
	

Configures an electrical interface to work in master mode.
	

-

slave
	

Configures an electrical interface to work in slave mode.
	

-

auto
	

Configures an electrical interface to work in auto mode.
	

-
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When an electrical interface of a HUAWEI device is connected to a non-Huawei device, you can specify the working mode of the HUAWEI device during the auto-negotiation of the interface rate. If the working mode is set to master, the negotiated rate is subject to that of the HUAWEI device. If the working mode is set to slave, the negotiated rate is subject to that of the peer device. When the working mode is set to auto, the rate is determined through auto-negotiation.
Precautions

    It is recommended that you run this command in auto-negotiation mode.
    The electrical interfaces at both ends cannot be both configured to work in slave mode. Otherwise, the interconnected interfaces cannot go Up.

Example

# Configure electrical interface GE0/0/1 to work in master mode.

<HUAWEI> system-view
[HUAWEI] interface GE0/0/1
[HUAWEI-GigabitEthernetE0/0/1] port work-mode master

port split
Function

The port split command splits a specified interface.

The undo port split command cancels the split configuration on an interface.

By default, an interface is not split.

Only interfaces on the panel of the S5731-S24N4X2Q-A, S5731-S24UN4X2Q, S5731-S8UM16UN2Q, S5731S-S24N4X2Q-A1, S5731S-S24UN4X2Q-A, S5731S-S8UM16UN2Q-A support interface split and merge.

For the devices that have the ES5D21Q02Q00, ES5D21Q04Q01, S7C02000, or S7Q02001 card installed, interfaces on the card support interface split and merge.
Format

40GE interfaces on the device panel or card

port split split-type 40GE:4*XGE

100GE interfaces on the device panel or card

port split split-type 100GE:4*25GE

10GE and 25GE interfaces split from other interfaces

undo port split
Parameters
Parameter 	Description 	Value

40GE:4*XGE
	

Splits a specified 40GE interface into four 10GE interfaces.
	

-

100GE:4*25GE
	

Splits a specified 100GE interface into four 25GE interfaces.
	

-
Views

XGE interface view, 40GE interface view25GE interface view, 100GE interface view
Default Level

3: Management level
Usage Guidelines

Usage Scenario

To split an interface, run the port split split-type command in the view of the interface. To merge converted interfaces into the original interface, run the undo port split command in the view of only one of the converted interfaces.

Precautions

    After configuring interface split using the port split split-type command, restart the interface card to make the configuration take effect.
    If interface split or merge is configured on an interface, the original configuration on the interface is lost. Therefore, exercise caution when deciding to perform the interface split or merge operation.

    10GE interfaces converted from a 40GE interface are numbered based on the number of the last 10GE interface on the switch. For interfaces on the switch panel, if the last 10GE interface is numbered XGE 0/y/m and a 40GE interface to be split is numbered 40GE 0/y/n, the four 10GE interfaces converted from the 40GE interface are numbered XGE 0/y/(m + 4 * (n - 1) + z + 1). For example, if the last 10GE interface on a switch is numbered XGE 0/0/48, the four 10GE interfaces converted from 40GE 0/0/3 are numbered XGE 0/0/57, XGE 0/0/58, XGE 0/0/59, and XGE 0/0/60. For interfaces on a card, m has a fixed value of 0. For example, the four 10GE interfaces converted from 40GE 1/1/1 on a card are numbered XGE 1/1/1, XGE 1/1/2, XGE 1/1/3, and XGE 1/1/4.
        y: indicates the subcard number.
        m: indicates the sequence number of the last 10GE interface on the switch.
        n: indicates the sequence number of the 40GE interface.
        z: indicates the interface location. The value ranges from 0 to 3.
    25GE interfaces converted from a 100GE interface are numbered based on the number of the last 25GE interface on the switch. Because only the 100GE interfaces on cards support interface split, if a 100GE interface to be split is numbered 100GE 0/y/n, the four 25GE interfaces converted from the 100GE interface are numbered 25GE 0/y/(4 * (n - 1) + z + 1). For example, the four 25GE interfaces converted from 100GE 0/1/1 on a card are numbered 25GE 0/1/1, 25GE 0/1/2, 25GE 0/1/3, and 25GE 0/1/4.
        y: indicates the subcard number.
        n: indicates the sequence number of the 100GE interface.
        z: indicates the interface location. The value ranges from 0 to 3.

Split interfaces are numbered in the same sequence as the wires of a cable are numbered. For example, in a 1-to-4 cable, the wire numbered 1 corresponds to the interface with the lowest interface number, and the wire numbered 4 corresponds to the interface with the highest interface number.

    After interface split is configured, the interface and converted interfaces cannot be added to a stack interface, regardless of whether the configuration takes effect. If an interface has been added to a stack interface, the interface cannot be split.
    After configuring interface split using the port split split-type 40GE:4*XGE command, or using the undo port split command, restart the device to make the configuration take effect. You can run the display port split command in any view to check the status of a split interface.
    When the ES5D21Q04Q01 is installed on the S5736-S or S5735S-H and 40GE interfaces are split into 10GE interfaces, the interfaces are grouped according to Table 4-32. The following limitations apply to interfaces in each group:
        Traffic of interfaces in each group is automatically isolated and cannot be forwarded between these interfaces. For example, traffic of XGE0/1/1 in group 1 cannot be forwarded to XGE0/1/16 in group 1. If the fourth 40GE interface is not split, traffic of XGE0/1/1 cannot be forwarded to 40GE0/1/4.
        If port isolation is configured on an interface in a group to isolate it from another interface, all interfaces in the group are isolated from the other interface. For example, if port isolation is configured on XGE0/1/1 in group 1 to isolate XGE0/1/1 from XGE0/0/10, XGE0/1/16 in group 1 is also isolated from XGE0/0/10.
    Table 4-32 Description of interface grouping

    Group ID
    	

    Interface 1
    	

    Interface 2

    1
    	

    XGE0/1/1
    	

    XGE0/1/16 or 40GE0/1/4 (If the fourth 40GE interface is not split, interface 2 is 40GE0/1/4.)

    2
    	

    XGE0/1/2
    	

    XGE0/1/12 or 40GE0/1/3 (If the third 40GE interface is not split, interface 2 is 40GE0/1/3.)

    3
    	

    XGE0/1/3
    	

    XGE0/1/15

    4
    	

    XGE0/1/4 or 40GE0/1/1 (If the first 40GE interface is not split, interface 1 is 40GE0/1/1.)
    	

    XGE0/1/13

    5
    	

    XGE0/1/5 or 40GE0/1/2 (If the second 40GE interface is not split, interface 1 is 40GE0/1/2.)
    	

    XGE0/1/14

    6
    	

    XGE0/1/6
    	

    XGE0/1/11

    7
    	

    XGE0/1/7
    	

    XGE0/1/10

    8
    	

    XGE0/1/8
    	

    XGE0/1/9

Example

# Split a 40GE interface into four 10GE interfaces and restart the device to make the configuration take effect.

<HUAWEI> system-view
[HUAWEI] interface 40GE 0/0/1
[HUAWEI-40GE0/0/1] port split split-type 40GE:4*XGE
Warning: This command will take effect only after resetting the board. 40GE0/0/1 will be split up into XGE, and the port configuration will be lost when the port type is changed. Continue? [Y/N]:y
Info: Succeeded in setting the configuration.
[HUAWEI-40GE0/0/1] return
<HUAWEI> reboot
Info: The system is now comparing the configuration, please wait.
Warning: The configuration has been modified, and it will be saved to the next startup saved-configuration file flash:/device.cfg. Continue? [Y/N]:y
Now saving the current configuration to the slot 0.
Save the configuration successfully.
Info: If want to reboot with saving diagnostic information, input 'N' and then execute 'reboot save diagnostic-information'.
System will reboot! Continue?[Y/N]:y

port serdes-mode
Function

The port serdes-mode command configures the Serdes mode of a MultiGE interface.

The undo port serdes-mode command restores the default Serdes mode of a MultiGE interface.

By default, a MultiGE interface can work in 1G or 10G Serdes mode.

This command is supported only on the following switch models:

S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002), S5732-H48XUM2CC (excluding MultiGE interfaces numbered 9 to 12)
Format

port serdes-mode { 2500-base-x | 5000-base-x } { sgmii | xfi }

port serdes-mode sgmii xfi

undo port serdes-mode
Parameters

Parameter
	

Description
	

Value

2500-base-x
	

Configures an interface to work in 2.5G Serdes mode.
	

-

5000-base-x
	

Configures an interface to work in 5G Serdes mode.
	

-

sgmii
	

Configures an interface to work in 1G Serdes mode.
	

-

xfi
	

Configures an interface to work in 10G Serdes mode.
	

-
Views

MultiGE interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

By default, when a MultiGE interface works at the rate of 2.5 Gbit/s or 5 Gbit/s, the Serdes mode of the MultiGE interface is 10G. When a Huawei device is connected to a non-Huawei device, if the preamble of packets sent from the non-Huawei device is not fixed, the MultiGE interface connecting the Huawei device to the non-Huawei device discards the packets. To prevent this problem, when a Huawei device connects to a non-Huawei device and receives the ENTITYTRAP_1.3.6.1.4.1.2011.5.25.219.2.2.3 hwBoardFail alarm with EntityTrapFaultID being 132282, run the port serdes-mode command to change the Serdes mode of the MultiGE interface to 2.5G or 5G based on the alarm information.

When a Huawei device connects to a non-Huawei device, the MultiGE interface connecting the Huawei device to the non-Huawei device cannot go Up if its Serdes mode is different from that on the non-Huawei device. To prevent this problem, when a Huawei device connects to a non-Huawei device and receives the ENTITYTRAP_1.3.6.1.4.1.2011.5.25.219.2.2.3 hwBoardFail alarm with EntityTrapFaultID being 132283, run the port serdes-mode command to change the Serdes mode of the MultiGE interface to be the same as that on the non-Huawei device based on the alarm information.

Precautions

MultiGE interfaces of different devices can be split into separate interface groups based on rules. MultiGE interfaces in each interface group support only two Serdes modes.

    On the S5732-H24UM2CC (part number: 02353HUC), each group of MultiGE interfaces 1 to 8, 9 to 16, and 17 to 24 forms an interface group.
    On the S5732-H24UM2CC (part number: 02353HUC), each group of MultiGE interfaces 1 to 8, 9 to 16, 17 to 24, 25 to 32, 33 to 36, 37 to 40, 41 to 44, and 45 to 48 forms an interface group.
    On the S5732-H48XUM2CC, each group of MultiGE interfaces 1 to 8, 13 to 20, and 21 to 24 forms an interface group.

Example

# Configure a MultiGE interface to work in 2.5G or 10G Serdes mode.

<HUAWEI> system-view
[HUAWEI] interface MultiGE 0/0/1
[HUAWEI-MultiGE0/0/1] port serdes-mode 2500-base-x xfi

portswitch
Function

The portswitch command changes the working mode of Ethernet interfaces from Layer 3 mode to Layer 2 mode.

The undo portswitch command changes the working mode of Ethernet interfaces from Layer 2 mode to Layer 3 mode.

By default, an Ethernet interface works in Layer 2 mode.
Format

portswitch

undo portswitch
Parameters

None
Views

GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, Eth-Trunk interface view, port group view, MultiGE interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

By default, an Ethernet interface on the device works in Layer 2 mode. To enable Layer 3 functions on the interface, run the undo portswitch command on the interface.

Precautions

    If an interface has the non-attribute configuration, this command cannot be executed. Before running this command, delete the non-attribute configuration on the interface.

    The minimum interval between running the portswitch and undo portswitch commands must be 30s.

Only interfaces on the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support switching between Layer 2 and Layer 3 modes.

Ethernet interfaces working at Layer 3 support IP address configuration.

By default, Ethernet interfaces on the device work at Layer 2 mode and have been added to VLAN 1. You can run the undo portswitch command to change the working mode to Layer 3 mode. The Ethernet interfaces are removed from VLAN 1 only after Layer 3 protocols become Up.
Example

# Change the working mode of GE0/0/1 from Layer 2 mode to Layer 3 mode.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] undo portswitch
[HUAWEI-GigabitEthernet0/0/1] ip address 10.10.10.10 255.255.255.0 

portswitch batch
Function

The portswitch batch command changes the working mode of Ethernet interfaces from Layer 3 mode to Layer 2 mode in batches.

The undo portswitch batch command changes the working mode of Ethernet interfaces from Layer 2 mode to Layer 3 mode in batches.

By default, the working mode of the interface is Layer 2 mode.
Format

portswitch batch interface-type { interface-number1 [ to interface-number2 ] } &<1-10>

undo portswitch batch interface-type { interface-number1 [ to interface-number2 ] } &<1-10>
Parameters
Parameter 	Description 	Value

interface-type interface-number1 [ to interface-number2 ]
	
Specifies interfaces of which the working mode needs to be changed.

    interface-number1 specifies the number of the first interface.

    interface-number2 specifies the number of the last interface.

    The value of interface-number2 must be larger than the value of interface-number1. interface-number1 and interface-number2 specify the range of interfaces.

    If to interface-number2 is not specified, only the working mode of the interface specified by interface-number1 is changed.

NOTE:

You can specify a maximum of 10 interface number ranges at a time. The entered ranges cannot overlap.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

You can run the portswitch batch or undo portswitch batch command to change the working mode of interfaces in batches.

Precautions

    The mode switching function takes effect when the interface only has attribute configurations (for example, shutdown and description configurations). If the service configuration (for example, port link-type access configuration) exists on the interface, you must clear the service configuration before running this command.

    The minimum interval between running the portswitch batch and undo portswitch batch commands must be 30s.

Only interfaces on the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support switching between Layer 2 and Layer 3 modes.

Ethernet interfaces working at Layer 3 support IP address configuration.
Example

# Change the working mode of GE0/0/1, 0/0/2, and 0/0/3 to Layer 2 mode.

<HUAWEI> system-view

[HUAWEI] portswitch batch gigabitethernet 0/0/1 0/0/2 0/0/3

preamble compatible-mode enable
Function

The preamble compatible-mode enable command enables the preamble compatibility mode on an interface.

The undo preamble compatible-mode enable command disables the preamble compatibility mode on an interface.

By default, the preamble compatibility mode is disabled on an interface.

This command is supported only by the S5732-H, S6730-H, S6730-S, S6730S-S, S6730S-H.
Format

preamble compatible-mode enable

undo preamble compatible-mode enable
Parameters

None
Views

XGE interface view, MultiGE interface view, 25GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When a local interface is connected to a remote 100M interface, if packet forwarding is abnormal and packet statistics on the local interface show that the packets received by the local interface include CRC error packets, the preamble of the packets sent by the remote 100M interface may be incorrect. In this case, you can run this command to enable the preamble compatibility mode on the local interface so that the interface is compatible with the packets with the incorrect preamble of the remote interface.

Precautions

This command can be delivered only when the interface rate is negotiated to 100 Mbit/s.
Example

# Enable the preamble compatibility mode on XGE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface xgigabitethernet 0/0/1
[HUAWEI-XGigabitEthernet0/0/1] preamble compatible-mode enable

reset statistics-peak
Function

The reset statistics-peak command clears Peak Information Rate (PIR) statistics on an interface.
Format

reset statistics-peak interface interface-type interface-number

PIR statistics on the management interface cannot be cleared.
Parameters

Parameter
	

Description
	

Value

interface interface-type interface-number
	
Clears PIR statistics on a specified interface.

    interface-type specifies the interface type.
    interface-number specifies the interface number.

	

-
Views

All views
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario
Generally, the PIR of an interface indicates the maximum rate of the interface in a long time. To check the recent peak rate of an interface, run the reset statistics-peak command to clear the previous peak rate record and obtain the new peak rate. To view the peak rate of an interface, run the display interface command. The following information is displayed:

Input peak rate 244425848 bits/sec,Record time: 2008-01-01 00:16:37             
Output peak rate 753496 bits/sec,Record time: 2008-01-15 19:25:12

Precautions

PIR statistics on a specified interface cannot be restored after they are cleared. Exercise caution before clearing the statistics.
Example

# Clear PIR statistics on GE0/0/1.

<HUAWEI> reset statistics-peak interface gigabitethernet 0/0/1

reset statistics-peak interface
Function

The reset statistics-peak interface command clears peak information rate (PIR) statistics on all the interfaces in one click.
Format

reset statistics-peak interface

PIR statistics on management interfaces cannot be cleared.
Parameters
None
Views
User view
Default Level
2: Configuration level
Usage Guidelines

Usage Scenario

Generally, the PIR of an interface indicates the maximum rate of the interface in a long time. To check the recent PIR of a specified interface, run the reset statistics-peak command to clear the previous PIR statistics and obtain the new PIR. To check recent PIR statistics on multiple or all interfaces, you may need to spend a long time in clearing the PIR statistics, increasing the workload. To reduce the workload, you can run this command in the user view to clear PIR statistics on all the interfaces.

Precautions

PIR statistics on an interface cannot be restored after they are cleared. Exercise caution before clearing the statistics.
Example

# Clear PIR statistics on all the interfaces.

<HUAWEI> reset statistics-peak interface

reset virtual-cable-test
Function

The reset virtual-cable-test command deletes cable test results on an interface.
The service interfaces on the following devices do not support this command:

    MultiGE interfaces on the S5720-28X-PWH-LI-AC and S5736-S24UM4XC
    XGE electrical interfaces on the ES5D21X08T00 card

Format

reset virtual-cable-test { interface-type interface-number | all }
Parameters

Parameter
	

Description
	

Value

interface-type interface-number
	
Deletes cable test results on a specified interface.

    interface-type specifies an interface type.
    interface-number specifies an interface number.

	

-

all
	

Deletes cable test results on all interfaces.
	

-
Views

All views
Default Level

3: Management level
Usage Guidelines

Usage Scenario

Before conducting a cable test on an electrical interface, you can use this command to delete the previous test results.

Precautions

The cable test results cannot be restored after being cleared. Exercise caution before clearing the statistics.
Example
# Delete cable test results on GE0/0/1.

<HUAWEI> reset virtual-cable-test gigabitethernet 0/0/1

set card port-config-mode 25g-port enable
Function

The set card port-config-mode 25g-port enable command sets the card interface working mode to 25GE.

The undo set card port-config-mode 25g-port enable command restores the default card interface working mode.

By default, the card interface working mode is 10GE.

The following switch models support this command when equipped with an S7X08000 card:

    S5731-H24T4XC, S5731-H24P4XC, S5731-H48T4XC, S5731-H48P4XC, S5731-H24HB4XZ, S5731-H48HB4XZ
    S5731S-H24T4XC-A, S5731S-H48T4XC-A, S5731S-H24HB4XZ-A, S5731S-H48HB4XZ-A
    S5736-S
    S5732-H24UM2CC, S5732-H48UM2CC, S5732-H48XUM2CC

Format

set card port-config-mode 25g-port enable slot slot-id

undo set card port-config-mode 25g-port enable slot slot-id
Parameters

Parameter
	

Description
	

Value

slot slot-id
	

Configures the interface working mode for the card in a specified slot.
	

The value must be set according to the device configuration.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

By default, the card interface working mode is 10GE, and the number of interfaces is 8*10GE. To use 25GE interfaces, run the set card port-config-mode 25g-port enable command. In this case, the number of interfaces on the card is 2*25GE, and the last six interfaces are unavailable.

Precautions

    After running this command, you need to confirm the automatic reset of cards as prompted to make the configuration take effect.
    After the interface working mode is changed, replace the connection medium.
    When the interface working mode of a card is being changed, the card cannot be removed and then reinstalled.
    After you run the reset factory-configuration command to restore factory settings and restart the device, the card interface working mode is restored to 10GE.
    If there are stack ports on a card, changing the card interface working mode may cause a stack split after the card is reset.

Example

# Configure the card interface working mode to 25GE.

<HUAWEI> system-view
[HUAWEI] set card port-config-mode 25g-port enable slot 1 
Warning: Only the first two ports will be available after the subcard is automatically initialized. Continue? [Y/N]:y               
Warning: The subcard needs to be reset for the new port mode to take effect. Ensure that subcard is properly installed during re-ini
tialization. Otherwise, port mode switching fails. Continue? [Y/N]:y                                                                
Info: The system is executing the command. Please wait.....................................    
Info: The port mode is changed successfully.     

set device port-config-mode enable
Function

The set device port-config-mode enable command changes the working mode of SFP28 Ethernet optical ports or MultiGE interfaces on the device panel and changes the working mode of QSFP28 Ethernet optical ports or splits QSFP28 Ethernet optical ports.

The undo set device port-config-mode enable command restores the default configuration.

By default, four SFP28 Ethernet optical ports on the panel of the S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002) and S5732-H48XUM2CC work at the rate of 25 Gbit/s, and two QSFP28 Ethernet optical ports work at the rate of 40 Gbit/s. On the panel of the S5731-S8UM16UN2Q and S5731S-S8UM16UN2Q-A, the first 16 MultiGE interfaces work at the rate of 2.5 Gbit/s, the last eight MultiGE interfaces work at the rate of 10 Gbit/s, four SFP+ Ethernet optical ports are unavailable, and two QSFP+ Ethernet optical ports work at the rate of 40 Gbit/s.

This command is supported only on the S5731-S8UM16UN2Q, S5731S-S8UM16UN2Q-A, S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002) and S5732-H48XUM2CC.
Format

set device port-config-mode port-config-mode enable { all | slot slot-id }

undo set device port-config-mode enable { all | slot slot-id }
Parameters
Parameter 	Description 	Value

port-config-mode
	

Specifies the working mode of ports on the device panel.
	

The value is a character string:

    4*25GE+2*40GE
    4*25GE+4*10GE+40GE
    4*25GE+40GE+4*10GE
    4*25GE+8*10GE
    2*100GE
    4*25GE+100GE
    100GE+4*25GE
    8*25GE
    8*10G+16*2.5G+2*40G

    12*10G+12*2.5G+4*10G

NOTE:

The 8*10G+16*2.5G+2*40G and 12*10G+12*2.5G+4*10G parameters are supported only on the S5731-S8UM16UN2Q and S5731S-S8UM16UN2Q-A.

all
	

Indicates all slots.
	

-

slot slot-id
	

Specifies a slot ID.
	

The value must be set according to the device configuration.
Views

System view
Default Level

3: Management level
Usage Guidelines

Usage Scenario

There are four SFP28 Ethernet optical ports and two QSFP28 Ethernet optical ports on the panel of S5732-H24UM2CC (part number: 02353HUC/02353HUC-003/02353SJY/02353SJY-001/02353SJY-004/02353SJY-010/02353SJY-011/02353SJY-014/02353SJY-015/02353SJY-016/02353SJY-019/02353SJY-002/02353SJY-003/02353SJY-012/02353SJY-013/02353SJY-017/02353SJY-018), S5732-H48UM2CC (part number: 02353HUB/02353HUB-002/02353SJT/02353SJT-001/02353SJT-003/02353SJT-004/02353SJT-010/02353SJT-011/02353SJT-013/02353SJT-014/02353SJT-015/02353SJT-016/02353SJT-018/02353SJT-002) and S5732-H48XUM2CC. You can run the set device port-config-mode enable command to change the working mode of SFP28 Ethernet optical ports on the device panel and change the working mode of QSFP28 Ethernet optical ports or split QSFP28 Ethernet optical ports. The device supports eight types of working mode switching modes or interface split modes:

    4*25GE+2*40GE: Four SFP28 Ethernet optical ports work at the rate of 25 Gbit/s, and two QSFP28 Ethernet optical ports work at the rate of 40 Gbit/s.
    4*25GE+4*10GE+40GE: Four SFP28 Ethernet optical ports work at the rate of 25 Gbit/s, QSFP28 Ethernet optical port 1 is split into four 10GE ports, and QSFP28 Ethernet optical port 2 works at the rate of 40 Gbit/s.
    4*25GE+40GE+4*10GE: Four SFP28 Ethernet optical ports work at the rate of 25 Gbit/s, QSFP28 Ethernet optical port 1 works at the rate of 40 Gbit/s, and QSFP28 Ethernet optical port 2 is split into four 10GE ports.
    4*25GE+8*10GE: Four SFP28 Ethernet optical ports work at the rate of 25 Gbit/s, and each of two QSFP28 Ethernet optical ports is split into four 10GE ports.
    2*100GE: Four SFP28 Ethernet optical ports are unavailable, and two QSFP28 Ethernet optical ports work at the rate of 100 Gbit/s.
    4*25GE+100GE: Four SFP28 Ethernet optical ports are unavailable, QSFP28 Ethernet optical port 1 is split into four 25GE ports, and QSFP28 Ethernet optical port 2 works at the rate of 100 Gbit/s.
    100GE+4*25GE: Four SFP28 Ethernet optical ports are unavailable, QSFP28 Ethernet optical port 1 works at the rate of 100 Gbit/s, and QSFP28 Ethernet optical port 2 is split into four 25GE ports.
    8*25GE: Four SFP28 Ethernet optical ports are unavailable, and each of two QSFP28 Ethernet optical ports is split into four 25GE ports.

On the panel of the S5731-S8UM16UN2Q and S5731S-S8UM16UN2Q-A, there are 24 MultiGE interfaces, four SPF+ Ethernet optical ports, and two QSFP+ Ethernet optical ports. You can switch the interface working mode as required. The device supports the following working mode switching modes:

    8*10G+16*2.5G+2*40G: On the panel, the first 16 MultiGE interfaces work at the rate of 2.5 Gbit/s, the last eight MultiGE interfaces work at the rate of 10 Gbit/s, four SFP+ Ethernet optical ports are unavailable, and two QSFP+ Ethernet optical ports work at the rate of 40 Gbit/s.
    12*10G+12*2.5G+4*10G: On the panel, the first 12 MultiGE interfaces work at the rate of 2.5 Gbit/s, the last 12 MultiGE interfaces work at the rate of 10 Gbit/s, four SFP+ Ethernet optical ports work at the rate of 10 Gbit/s, and two QSFP+ Ethernet optical ports are unavailable.

Precautions

    After the working mode of an interface is changed or an interface is split, the configuration on the original interface is lost. Therefore, exercise caution when performing this operation.

    After running this command, you need to confirm the automatic restart of the device as prompted to make the configuration take effect. To prevent configuration loss, save the configuration in advance.
    After interface split is configured, the interface and converted interfaces cannot be added to a stack interface, regardless of whether the configuration takes effect. If an interface has been added to a stack interface, the interface cannot be split.

Example

# Configure the two QSFP28 Ethernet optical ports on the device panel to work at the rate of 100 Gbit/s.

<HUAWEI> system-view
[HUAWEI] set device port-config-mode 2*100GE enable all
Warning: After the command is run, some ports may become unavailable or their configurations may be lost, and the device automatically restarts. Continue? [Y/N]:y
Warning: Save the configuration before restart. Otherwise, configuration will be lost and the device will restart. Continue? [Y/N]:y

set ethernet speed down-grade
Function

The set ethernet speed down-grade command enables the rate decrease auto-negotiation function on an interface.

The undo set ethernet speed down-grade command disables the rate decrease auto-negotiation function on an interface.

By default, rate decrease auto-negotiation is disabled on an interface.
The rate decrease auto-negotiation function takes effect only on the following interfaces:

    MultiGE interface
    GE electrical interface
    GE optical interface that has a GE copper module installed
    Last four 10GE electrical interfaces on the ES5D21X08T00 card of the S5731-H and S5731S-H
    10GE optical interfaces and 25GE optical interfaces that have 10GE copper modules installed on the S5735-L48T4X-A1, S5732-H, S6730-H, S6730S-H

Format

set ethernet speed down-grade

undo set ethernet speed down-grade
Parameters

None
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Two devices are connected through two GE electrical interfaces using a network cable. The two GE interfaces are configured to work in rate auto-negotiation mode. The network cable can only work at the rate of 100 Mbit/s or 10 Mbit/s because it deteriorates, but the maximum rate supported by the two GE interfaces is 1000 Mbit/s. The interfaces negotiate the working rate to 1000 Mbit/s, but cannot go Up because the network cable does not support the rate of 1000 Mbit/s.

You can use the rate decrease auto-negotiation function to solve this problem. After rate decrease auto-negotiation is enabled using this command, the two GE interfaces can decrease the negotiated rate to 10 Mbit/s or 100 Mbit/s, and then can go Up.

Prerequisites

The two connected interfaces work in auto-negotiation mode. If an interface works in non-auto-negotiation mode, run the negotiation auto command in the interface view to configure it to work in auto-negotiation mode.

Precautions

If rate decrease auto-negotiation is configured on the local interface, but not on the remote interface, the local interface can still decrease the negotiated rate to 100 Mbit/s. If the rate decrease auto-negotiation function is configured on an interface of the S5720-28X-PWH-LI-AC or S5720-28X-PWH-LI-ACF, configure this function on the remote interface; otherwise, the local and remote interfaces may not go Up.

If the network cable quality is low, a MultiGE interface takes longer time to go Up after the rate decrease auto-negotiation function is configured. For example, if the rate is decreased from 10 Gbit/s to 100 Mbit/s, the MultiGE interface takes about 40 seconds to go Up. If the rate is decreased from 2.5 Gbit/s to 100 Mbit/s, the MultiGE interface takes about 20 seconds to go Up. It is recommended that you replace the network cable.

After the rate decrease auto-negotiation function is configured on a MultiGE interface, the interface rate may automatically decrease to 1000 Mbit/s, if a network cable is removed and reinstalled on the interface in Down state continuously or if the shutdown and undo shutdown commands are frequently run on the interface. To restore the interface rate to 2500 Mbit/s, remove and reinstall the network cable again after the interface goes Up or run the shutdown and undo shutdown commands on the remote interface.

After the rate decrease auto-negotiation function is configured on a GE interface, the interface rate may automatically decrease to 100 Mbit/s, if a network cable is removed and reinstalled on the interface in Down state continuously or if the shutdown and undo shutdown commands are frequently run on the interface. To restore the interface rate to 1000 Mbit/s, remove and reinstall the network cable again after the interface goes Up or run the shutdown and undo shutdown commands on the remote interface.
Example
# Configure the rate decrease auto-negotiation function on a GE interface.

<HUAWEI> system-view
[HUAWEI] set ethernet speed down-grade

set error-statistics trigger speed-down-grade
Function

The set error-statistics trigger speed-down-grade command enables the device to automatically reduce the interface rate when the number of error packets on an interface reaches the threshold.

The undo set error-statistics trigger speed-down-grade command disables the device from automatically reducing the interface rate when the number of error packets on an interface reaches the threshold.

By default, the device is enabled to automatically reduce the interface rate when the number of error packets on an interface reaches the threshold.

This command is supported only on the following switch models: S5731-S, S5731S-S, S5731-H, S5731S-H.
Format

set error-statistics trigger speed-down-grade { disable | enable }

undo set error-statistics trigger speed-down-grade disable
Parameters
Parameter 	Description 	Value

disable
	

Disables the device from automatically reducing the interface rate when the number of error packets on an interface reaches the threshold.
	

-

enable
	

Enables the device to automatically reduce the interface rate when the number of error packets on an interface reaches the threshold.
	

-
Views

GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When a GE electrical interface on a device is connected to a specific printer and the interface rate is higher than 10 Mbit/s, the interface can go Up, but the printer cannot work properly. Alignment error packets will be detected on the interface. In this case, you can enable the device to automatically reduce the interface rate when the number of error packets on the interface reaches the threshold. The device then automatically sets the interface rate to 10 Mbit/s, reports an alarm (hwPortErrPktSpeedDownGrade), and records a log (IFPDT/1/ERRPKT_SPEEDDOWN) when the following conditions are met:

    The interface receives three alignment error packets within 60 seconds.
    The interface is in the auto-negotiation state and works at the rate of 100 Mbit/s.
    Only one MAC address is learned on the interface, and the MAC address starts with 001B-82 or is in the MAC address blacklist configured using error-statistics trigger speed-down-grade command.

After the interface rate is set to 10 Mbit/s, the device does not automatically reduce the interface rate if any of the following conditions is met. Instead, the device restores the interface rate to the default value obtained through auto-negotiation, sends a clear alarm (hwPortErrPktSpeedDownGradeResume), and records a log (IFPDT/1/ERRPKT_SPEEDDOWNRECOVER).

    The set ethernet speed down-grade disable command is run to disable the device from automatically reducing the interface rate when the number of error packets on an interface reaches the threshold.
    The auto speed command is run on the interface to set the auto-negotiation rate.
    The undo negotiation auto command is run on the interface to set the working mode of the interface to non-auto-negotiation.
    A new MAC address is learned on the interface, and the number of MAC address entries on the interface is not 1.

To prevent the interface rate reduction information from being lost after the device restarts, the device automatically records the interface rate information in the file named speeddowngrade.txt every 10 minutes or you can run the save command to record the information in the file named speeddowngrade.txt. After the device restarts, the interface rate remains unchanged. Running the reset saved-configuration or reset factory-configuration command automatically clears the saved files.

Precautions

    After the interface rate is set to 10 Mbit/s, you need to restart the printer so that the printer can work properly.
    When the interface goes Down, the function of automatically reducing the interface rate when the number of error packets on an interface reaches the threshold still takes effect, and the interface rate remains 10 Mbit/s.

Example
# Enable the device to automatically reduce the interface rate when the number of error packets on an interface reaches the threshold.

<HUAWEI> system-view
[HUAWEI] set error-statistics trigger speed-down-grade enable

set flow-statistics include-interframe
Function

The set flow-statistics include-interframe command configures traffic statistics on an interface to contain the inter-frame gap and preamble.

The undo set flow-statistics include-interframe command configures traffic statistics on an interface not to contain the inter-frame gap and preamble.

By default, traffic statistics on an interface contain the inter-frame gap and preamble.
Format

set flow-statistics include-interframe

undo set flow-statistics include-interframe
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view, Eth-Trunk interface view
Default Level

2: Configuration level
Usage Guidelines

You can run the display interface command to view the running status and traffic statistics on an interface. The Last 300 seconds input rate or Last 300 seconds output rate field in the command output indicates the inbound or outbound traffic rate on the interface in the last 300 seconds.

    If you want to obtain the total number of bytes passing through an interface in a period, configure the device to count the bytes in the interframe gap (IFG) and preamble when collecting traffic statistics on the interface. The interface traffic rate is as follows:

    Interface traffic rate = (Original packet length + IFG + Preamble) x Number of packets passing through the interface every second

    If you want to obtain only the number of packet bytes passing through an interface in a period, configure the device not to count the bytes in the IFG and preamble when collecting traffic statistics on the interface. The interface traffic rate is as follows:

    Interface traffic rate = Original packet length x Number of packets passing through the interface every second

    By default, the IFG has a fixed value of 12 bytes and the preamble has a fixed value of 8 bytes.

Example

# Configure traffic statistics on GE0/0/1 to contain the inter-frame gap and preamble.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] set flow-statistics include-interframe

set flow-change-ratio
Function

The set flow-change-ratio { input-threshold | output-threshold } upper-limit command sets the trap threshold for a sudden traffic volume change on interfaces.

The undo set flow-change-ratio { input-threshold | output-threshold } upper-limit command restores the default trap threshold for a sudden traffic volume change on interfaces.

By default, the trap threshold for a sudden traffic volume change on interfaces is 50%.
Format

set flow-change-ratio { input-threshold | output-threshold } upper-limit threshold

undo set flow-change-ratio { input-threshold | output-threshold } upper-limit
Parameters
Parameter 	Description 	Value

input-threshold
	

Specifies the trap threshold for a sudden traffic volume change in the inbound direction of interfaces.
	

-

output-threshold
	

Specifies the trap threshold for a sudden traffic volume change in the outbound direction of interfaces.
	

-

upper-limit threshold
	

Specifies the threshold for the traffic volume change percentage on interfaces.
	

The value is an integer that ranges from 0 to 100. The default value is 50.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

To allow the switch to detect real-time traffic volume changes on interfaces, you can run this command to set the trap threshold for a sudden traffic volume change on interfaces for triggering a trap.

Traffic volume change percentage on interfaces = |Interface rate in the current traffic statistics collection interval - Interface rate in the previous traffic statistics collection interval| / Interface rate in the previous traffic statistics collection interval

Configuration Impact

If the trap function for a sudden traffic volume change is enabled (using the snmp-agent trap enable feature ifpdt trap-name hwInputRateChangeOverThresholdNotice or snmp-agent trap enable feature ifpdt trap-name hwOutputRateChangeOverThresholdNotice command) after the set flow-change-ratio command is enabled, a trap will be generated when the traffic volume change percentage on interfaces exceeds the specified threshold (value of threshold) and the bandwidth usage percentage is not lower than the lower threshold (threshold configured using the set flow-change-ratio start-check command).

Precautions

You can run the set flow-stat interval command to configure the traffic statistics collection interval on interfaces. The default interval is 300 seconds.
Example

# Set the trap threshold for a sudden traffic volume change in the inbound direction of interfaces to 70%.

<HUAWEI> system-view
[HUAWEI] set flow-change-ratio input-threshold upper-limit 70

set flow-change-ratio input-broadcast-detect disable
Function

The set flow-change-ratio input-broadcast-detect disable command disables detection of a sudden broadcast traffic volume change in the inbound direction of interfaces.

The undo set flow-change-ratio input-broadcast-detect disable command enables detection of a sudden broadcast traffic volume change in the inbound direction of interfaces.

By default, detection of a sudden broadcast traffic volume change in the inbound direction of interfaces is enabled.
Format

set flow-change-ratio input-broadcast-detect disable

undo set flow-change-ratio input-broadcast-detect disable
Parameters

None
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

By default, the switch checks whether the volume of broadcast traffic in the inbound direction of interfaces changes suddenly, and generates a trap after detecting a sudden change, facilitating network maintenance.

If the switch has many interfaces, detection of a sudden broadcast traffic volume change in the inbound direction of interfaces consumes some CPU and memory resources. You can run the set flow-change-ratio input-broadcast-detect disable command to disable the function.

Precautions

If the system software is upgraded from V200R009C00 or an earlier version to V200R010C00 or a later version, detection of a sudden broadcast traffic volume change in the inbound direction of interfaces is disabled by default.
Example

# Disable detection of a sudden broadcast traffic volume change in the inbound direction of interfaces.

<HUAWEI> system-view
[HUAWEI] set flow-change-ratio input-broadcast-detect disable

set flow-change-ratio start-check
Function

The set flow-change-ratio start-check bandwidth-usage command sets the lower threshold of the initial bandwidth usage percentage for triggering a trap.

The undo set flow-change-ratio start-check bandwidth-usage command restores the default lower threshold of the initial bandwidth usage percentage for triggering a trap.

By default, the lower threshold of the initial bandwidth usage percentage for triggering a trap is 20%.
Format

set flow-change-ratio start-check bandwidth-usage bandwidth-usage-threshold

undo set flow-change-ratio start-check bandwidth-usage
Parameters
Parameter 	Description 	Value

bandwidth-usage bandwidth-usage-threshold
	

Specifies the lower threshold of the initial bandwidth usage percentage for triggering a trap.
	

The value is an integer that ranges from 1 to 100. The default value is 20.
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

To allow the switch to detect real-time traffic volume changes on interfaces, you can run this command to set the lower threshold of the initial bandwidth usage percentage for triggering a trap.

Configuration Impact

If the trap function for a sudden traffic volume change is enabled (using the snmp-agent trap enable feature ifpdt trap-name hwInputRateChangeOverThresholdNotice or snmp-agent trap enable feature ifpdt trap-name hwOutputRateChangeOverThresholdNotice command) after the set flow-change-ratio command is enabled, a trap will be generated when the traffic volume change percentage on interfaces exceeds the specified threshold ( threshold configured using the set flow-change-ratio command) and the bandwidth usage percentage is not lower than the lower threshold (value of bandwidth-usage-threshold).

Precautions

You can run the set flow-stat interval command to configure the traffic statistics collection interval on interfaces. The default interval is 300 seconds.
Example

# Set the trap threshold for the lower threshold of the initial bandwidth usage percentage to 70%.

<HUAWEI> system-view
[HUAWEI] set flow-change-ratio start-check bandwidth-usage 70

set if-mib sample-interval
Function

The set if-mib sample-interval command configures the interval of collecting traffic statistics on an interface.

The undo set if-mib sample-interval command restores the default interval.

The default interval is 60 seconds.
Format

set if-mib sample-interval interval-value

undo set if-mib sample-interval [ interval-value ]
Parameters
Parameter 	Description 	Value
interval-value 	

Specifies the interval of collecting traffic statistics on an interface.
	

The value can be 0 or an integer multiple of 10 in the range from 10 to 300, in seconds. The value 0 indicates that the function of periodically collecting traffic statistics on an interface is disabled.
Views

System view
Default Level

2: Configuration level
Usage Guidelines
Usage Scenario

When the NMS obtains interface traffic statistics through the MIB tables iftable and ifxtable, the time for querying interface traffic statistics in real time is long. When the device has a large number of interfaces, the query efficiency of the NMS is low. To resolve this issue, switches can be configured to periodically collect traffic statistics on interfaces. In this case, the NMS can directly obtain traffic statistics collected on interfaces, improving the query efficiency.
Precautions

    If the command has been run for multiple times, only the latest configuration takes effect.
    When the undo set if-mib sample-interval [ interval-value ] command is run, if the interval is specified, the value must be consistent with the current configuration.
    A short interval will cause a high CPU usage.

Example

# Set the interval of collecting traffic statistics on an interface to 100 seconds.

<HUAWEI> system-view
[HUAWEI] set if-mib sample-interval 100

set log updown disable
Function

The set log updown disable command disables the log function for interface up/down changes.

The undo set log updown disable command enables the log function for interface up/down changes.

By default, the log function for interface up/down changes is enabled.
Format

set log updown disable

undo set log updown disable
Parameters

None
Views

Ethernet interface view, MultiGE interface view, GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

You can disable the log function for interface up/down changes in the following situation: A large number of interfaces repeatedly alternate between up and down states and users do not need to pay attention to the up/down changes of these interfaces, for example, interfaces alternate between up and down states when APs connected to the network go online and offline.

Precautions

This command is not supported on an interface that is configured as a stack interface.
Example

# Disable the log function for up/down changes on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/0] set log updown disable

set port-enable delay
Function

The set port-enable delay command sets the delay after which an interface goes Up after a device restart.

The undo set port-enable delay command deletes the delay after which an interface goes Up after a device restart.

By default, an interface goes Up immediately after a device restart.
Format

set port-enable delay delay-timer

undo set port-enable delay
Parameters

Parameter
	

Description
	

Value

delay-timer
	

Specifies the delay after which an interface goes Up after a device restart.
	

The value is an integer ranging from 0 to 1800, in seconds. The increment value is 10 seconds.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

On an unstable network, devices may fail to obtain IP addresses from the expected DHCP server. If devices obtain IP addresses from another DHCP server, the devices cannot obtain IP addresses on the expected network segment for a long time even after the network is recovered. To prevent this problem, you can set the delay after which interfaces go Up after a device restart.

Precautions

    If you run the shutdown and undo shutdown commands or run the restart command on the interface during the delay, the delay does not take effect.
    The configuration takes effect only after the device is restarted.

Example

# Set the delay after which GE0/0/1 goes Up after a device restart to 20 seconds.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] set port-enable delay 20
Warning: The configuration takes effect only after the card or subcard is restarted.

single-fiber enable
Function

The single-fiber enable command enables the single-fiber communication function on an optical interface.

The undo single-fiber enable command disables the single-fiber communication function on an optical interface.

By default, the single-fiber communication function is disabled on an optical interface.

The first four GE optical ports on the S5731-S48S4X, S5731-S48S4X-A, S5731S-S48S4X-A, and S5731S-S48S4X-A1 do not support this configuration.

GE, XGE, 25GE, and 40GE interfaces on the S5731-H24HB4XZ, S5731-H48HB4XZ, S5731S-H24HB4XZ-A, and S5731S-H48HB4XZ-A support this configuration. On other S5731-H, only XGE, 25GE, and 40GE interfaces support this configuration.

On the S5732-H, S6730-H, and S6730S-H, only 25GE, 40GE, and 100GE interfaces support this configuration.

On the S6730-S and S6730S-S, only 40GE interfaces support this configuration.

GE optical interfaces on the following models do not support this command: S5720-52X-LI-24S-AC1, S5720-52X-LI-48S-AC1, S5720-52X-LI-48S-DC1, S5736-S24S4XC, S5736-S48S4XC, S6720S-S24S28X-A.

XGE optical interfaces on the following models support this command after they have GE optical modules installed: S6735-S.

Optical interfaces of other models support this command.

Note the following:

    A GE optical interface supports this command only when it works at the rate of 1000 Mbit/s.
    An XGE optical interface supports this command only when it has no optical module installed or has an XGE optical module installed.
    A 25GE optical interface supports this command only when it has no optical module installed or has a GE, XGE, or 25GE optical module installed.
    A 40GE optical interface supports this command only when it has no optical module installed or has a 40GE optical module installed.
    A 100GE optical interface supports this command only when it has no optical module installed or has a 40GE or 100GE optical module installed.
    The QSFP-40G-SR-BD, QSFP-40G-SDLC-PAM, QSFP-40G-LR4-Lite, QSFP-40G-LX4-MM, and QSFP-40G-eSDLC-PAM optical modules do not support the single-fiber function.

Format

single-fiber enable

undo single-fiber enable
Parameters

None
Views

GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

During network management and maintenance, the administrator may need to send traffic from users to a specified server for analysis and processing. If a server can receive and send packets, there is a possibility that the server forwards user traffic to other devices, causing a security risk. The unidirectional single-fiber communication function can address this issue. A single fiber means that two optical modules are connected by only one fiber, and unidirectional communication means that packets can be sent in only one direction. With this function, a switch can only send but cannot receive packets, and an analysis server can only receive but cannot send packets. Data security on the analysis server is ensured.

Precautions

    The remote interface also works in non-auto negotiation mode and the rate of the peer interface is the same as the rate of the local interface.
    The single-fiber enable command and configuring internal loopback detection and MAC SWAP loopback test cannot be configured on the same interface.
    If this command has been run on an interface, the command configuration is lost in the following situations:
        The GE optical interface has an FE optical module installed.
        The GE optical interface does not work at a rate of 1000 Mbit/s.
        The XGE interface is connected to a cable or has a GE optical module installed.
        The 25GE interface is connected to a cable.
        The 40GE interface is connected to a cable.
        The 100GE interface is connected to a cable.

Example
# Enable XGigabitEthernet0/0/1 to send packets through a single fiber.

<HUAWEI> system-view
[HUAWEI] interface XGigabitEthernet 0/0/1
[HUAWEI-XGigabitEthernet0/0/1] single-fiber enable

speed
Function

The speed command sets the rate for an Ethernet interface in non-auto negotiation mode.

The undo speed command restores the default rate of an Ethernet interface in non-auto negotiation mode.

By default, an Ethernet interface works at its highest rate when it works in non-auto negotiation mode.
Format

speed { 10 | 100 | 1000 | 2500 | 5000 | 10000 }

undo speed
Parameters

Parameter
	

Description
	

Value

10
	

Indicates that the interface works at 10 Mbit/s.
	

-

100
	

Indicates that the interface works at 100 Mbit/s.
	

-

1000
	

Indicates that the interface works at 1000 Mbit/s.
NOTE:

FE interfaces do not support this parameter.
	

-

2500
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 2500 Mbit/s.
NOTE:

Only MultiGE interfaces support this parameter.
	

-

5000
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 5000 Mbit/s.
NOTE:

Only MultiGE interfaces support this parameter.
	

-

10000
	

Sets the auto-negotiation rate of an Ethernet electrical interface to 10000 Mbit/s.
NOTE:

Only MultiGE interfaces and 25GE interfaces with XGE/25GE dual-rate optical modules installed support this parameter.
	

-
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

In non-auto negotiation mode, if interfaces on two connected devices work at different rates, use the speed command to change the rates of the interfaces to be the same so that the two devices can communicate.

Precautions

    If the remote interface does not support the auto negotiation mode, run the undo negotiation auto command on the local interface to configure the interface to work in non-auto negotiation mode. You can then change the rate of the local interface to be the same as the rate of the remote interface to ensure proper communication.
    For details about the rates supported by Ethernet interfaces, see Licensing Requirements and Limitations for Ethernet Interfaces.
    On 25GE interfaces, the speed 10000 command is mutually exclusive with the following commands:
        port mode ge (25GE interface)
        fec mode rs
        fec mode base-r
    The rate of MultiGE interfaces on the S5732-H24UM2CC, S5732-H48UM2CC, and S5736-S24UM4XC can be increased using the RTU license. After the license is activated, you can run the assign group-speed command and restart the device to make the configured maximum rate supported by the interfaces in the MultiGE interface group take effect.

    To check the default rate of MultiGE interfaces, run the display device group-speed configuration command. The BaseSpeed field indicates the default rate.

Example
# Configure GE0/0/1 to work at 100 Mbit/s in non-auto negotiation mode.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] undo negotiation auto
[HUAWEI-GigabitEthernet0/0/1] speed 100

speed auto-negotiation
Function

The speed auto-negotiation command enables auto-negotiation on a GE optical interface.

The undo speed auto-negotiation command disables auto-negotiation on a GE optical interface.

By default, auto-negotiation is disabled on a GE optical interface.

Only the following models do not support this command:

    S200 series
    S300 series
    S500-8T4S, S500-8P4S, S500-24T4S, S500-16T4S, S500-24P4S, S500-16P4S, and S500-48T4S
    S1730S-S8T4S-A1, S1730S-S8P4S-A1, S1730S-S24T4S-A1, S1730S-S24P4S-A1, S1730S-S48T4S-A1, and S1730S-S48P4S-A1
    S2730S-S8FT4S-A, S2730S-S8FP4S-A, S2730S-S16FT4S-A, S2730S-S24FT4S-A, S2730S-S24FP4S-A, and S2730S-S48FT4S-A
    S5720-28TP-PWR-LI-ACL
    S5720S-28TP-PWR-LI-ACL
    S5731S-H24T4S-A and S5731S-H48T4S-A
    S5732-H24S6Q and S5732-H48S6Q
    S6720S-S24S28X-A

Format

speed auto-negotiation

undo speed auto-negotiation
Parameters

None
Views

GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If an optical interface is configured to work in auto-negotiation mode using the negotiation auto command, the interface cannot negotiate the rate with another interface. You can run the speed auto-negotiation command to configure the auto-negotiation function on the interface. After auto-negotiation is configured on the interface, if the interface is Down, the device cyclically switches the interface to the auto-negotiated 1000 Mbit/s, forced 1000 Mbit/s, and forced 100 Mbit/s until the interface goes Up.

Prerequisites

Run the negotiation auto command to enable auto-negotiation before using the speed auto-negotiation command on the interface.

Precautions

    The speed auto-negotiation command will make flow control auto-negotiation and internal loopback ineffective.
    After auto-negotiation is configured on an interface, if a single fiber is removed and then inserted or the link is not operational, the interface may be Up and the remote interface may be Down. You can run the shutdown and undo shutdown commands on the remote interface to make the remote interface go Up.
    After auto-negotiation is configured on an interface, if this interface becomes Up and the remote interface becomes Down after the negotiation, run the shutdown and undo shutdown commands on the remote interface or run the undo speed auto-negotiation and speed auto-negotiation commands on this interface to enable the two ends to negotiate their rate again.

Example
# Enable auto-negotiation on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] negotiation auto
[HUAWEI-GigabitEthernet0/0/1] speed auto-negotiation

statistic enable (interface view)
Function

The statistic enable command enables IPv4 or IPv6 packet statistics collection on an interface.

The undo statistic enable command disables IPv4 or IPv6 packet statistics collection on an interface.

By default, IPv4 or IPv6 packet statistics collection is disabled on an interface.

Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support this command.
Format

{ ipv4 | ipv6 } * statistic enable { both | inbound | outbound }

undo { ipv4 | ipv6 } * statistic enable { both | inbound | outbound }
Parameters

Parameter
	

Description
	

Value

ipv4
	

Indicates IPv4 packet statistics collection.
	

-

ipv6
	

Indicates IPv6 packet statistics collection.
	

-

both
	

Indicates statistics collection for incoming and outgoing packets.
	

-

inbound
	

Indicates statistics collection for incoming packets.
	

-

outbound
	

Indicates statistics collection for outgoing packets.
	

-
Views

Eth-Trunk interface view, GE interface view, XGE interface view, 25GE interface view, MultiGE interface view, 40GE interface view, 100GE interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

To check the network status or locate network faults, you can enable IPv4 or IPv6 packet statistics collection on an interface to collect IPv4 or IPv6 packet statistics on the interface.

Precautions

    If this command and the traffic-policy (interface view) command are configured together on the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6730-H, S6730S-H, S6730-S, and S6730S-S, traffic policy will fail to be applied.
    After the IPv4 or IPv6 packet statistics collection function is enabled on an interface, you can run the display counters protocol command to check traffic statistics on the interface.

Example

# Enable IPv4 packet statistics collection in the inbound direction of GigabitEthernet0/0/1.

<HUAWEI> system-view
[HUAWEI] interface GigabitEthernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] ipv4 statistic enable inbound

traffic-pppoe
Function

The traffic-pppoe command configures an interface to allow only PPPoE packets to pass through.

The undo traffic-pppoe command cancels the configuration.

By default, an interface allows all types of packets to pass through.

S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6730-H, S6730S-H, S6730-S, and S6730S-S do not support the configuration.
Format

traffic-pppoe { any | source-address } { any | destination-address }

undo traffic-pppoe { any | source-address } { any | destination-address }
Parameters

Parameter
	

Description
	

Value

{ any | source-address }
	
Indicates that an interface allows PPPoE packets with a specified source MAC address to pass through.

    any indicates that PPPoE packets with any source MAC address can pass through the interface.
    source-address indicates that PPPoE packets with a specified source MAC address can pass through the interface.

	

The value of source-address is in the format H-H-H. An H contains 1 to 4 hexadecimal digits.

{ any | destination-address }
	
Indicates that an interface allows PPPoE packets with a specified destination MAC address to pass through.

    any indicates that PPPoE packets with any destination MAC address can pass through the interface.
    destination-address indicates that PPPoE packets with a specified destination MAC address can pass through the interface.

	

The value of destination-address is in the format H-H-H. An H contains 1 to 4 hexadecimal digits.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 40GE interface view, port group view, Eth-Trunk interface view
Default Level

2: Configuration level
Usage Guidelines

If you run the traffic-pppoe any any command on an interface, the interface allows only PPPoE packets to pass through and discards other packets.
Example

# Configure GE0/0/1 to allow only PPPoE packets to pass through.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] traffic-pppoe any any

# Configure GE0/0/1 to allow only PPPoE packets with source MAC address 1-1-1 to pass through.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] traffic-pppoe 1-1-1 any

training (40GE interface view)
Function

The training disable and undo training enable commands disable the training function on a 40GE interface.

The training enable and undo training disable commands enable the training function on a 40GE interface.

By default, the training function is enabled on a 40GE interface.

    The training function can be configured on the 40GE interfaces of the S5735S-H, S5731-H, S5731S-H24T4XC-A, S5731S-H48T4XC-A or S5736-S that has the ES5D21Q02Q00 or ES5D21Q04Q01 card installed.

Format

training { enable | disable }

undo training { enable | disable }
Parameters

None
Views

40GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

With the increase of transmission rate or frequency, attenuation of signal's high-frequency components becomes increasingly severe. To guarantee transmission performance of signals, it is necessary to compensate for signals, and commonly used compensation technologies are pre-emphasis and balancing. The pre-emphasis technology increases high-frequency components of signals at the transmit end of transmission lines to compensate attenuation during the transmission. However, the pre-emphasis technology increases crosstalk while amplifying high-frequency components. To solve this problem, the balancing technology is developed. The balancing technology is used at the receive end of transmission lines to function like a filter for filtering high-frequency crosstalk.

After the training function is enabled on a 40GE interface, the transmit end exchanges frames with the receive end to automatically set the pre-emphasis and balancing parameters, improving processing efficiency of the two technologies. Note that the negotiated parameters for the training function are obtained based on the site environment. If the site environment changes, for example, from high-temperature environment to low-temperature environment, the parameters may be inaccurate. Therefore, bit errors may occur when the training function is enabled. The training function is optional in IEEE802.3 standards, and its implementation on different types of products from various vendors may differ.

When connecting two devices, enable or disable the training function on both ends simultaneously. By default, the training function is enabled on a 40GE interface. If the training function is disabled on the remote device or the remote device does not support the function, run the training disable or undo training enable command to disable the function.

Precautions

    The training disable and undo training enable commands can be configured on a 40GE interface only when the interface connects to a high-speed cable and is not a physical member interface in a stack.

    After a cable is installed on a 40GE interface without the training disable configuration, the training enable configuration is automatically generated on the interface.

    If no cable is installed on an interface, only the training enable and undo training disable commands can be configured on the interface.
    If the display this include-default command is run on an interface to view the training configuration after a cable is installed on the interface, the default training enable configuration is always displayed in the command output and does not change with the training configuration change.

    The training configuration on an interface takes effect only after a cable is installed on the interface. If the cable is replaced with an optical module, the training disable and training enable configurations will be automatically deleted from the interface.

    If a 40GE interface is configured as a physical member interface in a stack system, the training disable and training enable configurations will be automatically deleted from the interface.

    If a 40GE interface has been configured as a physical member interface in a stack system, the training function is disabled on the interface by default and cannot be enabled.
    If the training configuration does not exist on an interface of a switch running V200R008C00 or an earlier version, the training disable configuration is automatically generated on the interface after the system software is upgraded to a version later than V200R009C00. If the training configuration exists on the interface, the configuration remains unchanged after the system software is upgraded to a version later than V200R009C00.

Example

# Disable the training function on 40GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface 40ge 0/0/1
[HUAWEI-40GE0/0/1] training disable
Warning: The configuration will cause an abnormality in port running. Continue? [Y/N]:y

training (100GE interface view)
Function

The training disable and undo training enable commands disable the training function on a 100GE interface.

The training enable and undo training disable commands enable the training function on a 100GE interface.

By default, the training function is enabled on a 100GE interface.

Only the S6735-S supports this command.

The training disable and undo training enable commands can be configured on a 100GE interface only when the interface connects to a 40GE or 100GE cable.
Format

training { enable | disable }

undo training { enable | disable }
Parameters

None
Views

100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

With the increase of transmission rate or frequency, attenuation of signal's high-frequency components becomes increasingly severe. To guarantee transmission performance of signals, it is necessary to compensate for signals, and commonly used compensation technologies are pre-emphasis and balancing. The pre-emphasis technology increases high-frequency components of signals at the transmit end of transmission lines to compensate attenuation during the transmission. However, the pre-emphasis technology increases crosstalk while amplifying high-frequency components. To solve this problem, the balancing technology is developed. The balancing technology is used at the receive end of transmission lines to function like a filter for filtering high-frequency crosstalk.

After the training function is enabled on a 100GE interface, the transmit end exchanges frames with the receive end to automatically set the pre-emphasis and balancing parameters, improving processing efficiency of the two technologies. Note that the negotiated parameters for the training function are obtained based on the site environment. If the site environment changes, for example, from high-temperature environment to low-temperature environment, the parameters may be inaccurate. Therefore, bit errors may occur when the training function is enabled. The training function is optional in IEEE802.3 standards, and its implementation on different types of products from various vendors may differ.

When connecting two devices, enable or disable the training function on both ends simultaneously. By default, the training function is enabled on a 100GE interface. If the training function is disabled on the remote device or the remote device does not support the function, run the training disable or undo training enable command to disable the function.

Precautions

    After a 40GE or 100GE cable is installed on a 100GE interface without the training disable configuration, the training enable configuration is automatically generated on the interface.

    If no cable is installed on an interface, only the training enable and undo training disable commands can be configured on the interface.
    If the display this include-default command is run on an interface to view the training configuration after a cable is installed on the interface, the default training enable configuration is always displayed in the command output and does not change with the training configuration change.

    The training configuration on an interface takes effect only after a cable is installed on the interface. If the cable is replaced with an optical module, the training disable and training enable configurations will be automatically deleted from the interface.

Example

# Disable the training function on 100GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface 100ge 0/0/1
[HUAWEI-100GE0/0/1] training disable
Warning: The configuration will cause an abnormality in port running. Continue? [Y/N]:y
Info: This operation may take a few seconds. Please wait for a moment.......

transceiver power low trigger error-down
Function

The transceiver power low trigger error-down command enables an Ethernet optical interface to enter the error-down state when the optical power is low.

The undo transceiver power low trigger error-down command disabled an Ethernet optical interface from entering the error-down state when the optical power is low.

By default, an Ethernet optical interface does not enter the error-down state when the optical power is low.
Format

transceiver power low trigger error-down

undo transceiver power low trigger error-down
Parameters

None
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Low optical power of the device may cause intermittent service interruption. To ensure that services are running properly, enable an interface to enter the error-down state when the optical power is low so that services can be switched in a timely manner.

Follow-up Procedure
An interface in Error-down state can be recovered using either of the following methods:

    Manual recovery: If a few interfaces need to be recovered forcibly, run the shutdown and undo shutdown commands in the interface view. Alternatively, run the restart command in the interface view to restart the interfaces.
    Automatic recovery: If a large number of interfaces need to be recovered, manual recovery is time consuming and some interfaces may be omitted. You can run the error-down auto-recovery cause transceiver-power-low interval interval-value command in the system view to enable automatic interface recovery and set the recovery delay time. An interface in Error-down state automatically recovers when the specified delay time expires.

Example

# Enable GE0/0/1 to enter the error-down state when the optical power is low.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] transceiver power low trigger error-down

trap-threshold
Function

The trap-threshold command sets the inbound and outbound bandwidth usage thresholds for generating a trap.

The undo trap-threshold command restores the default inbound and outbound bandwidth usage thresholds for generating a trap.

The default inbound or outbound bandwidth usage threshold for generating a trap is 80.
Format

trap-threshold { input-rate | output-rate } bandwidth-in-use [ resume-rate resume-threshold ]

undo trap-threshold { input-rate | output-rate }
Parameters
Parameter 	Description 	Value

input-rate
	

Indicates inbound bandwidth.
	

-

output-rate
	

Indicates outbound bandwidth.
	

-

bandwidth-in-use
	

Specifies the bandwidth usage threshold for generating a trap.
	

The value is an integer that ranges from 1 to 100.

resume-rate resume-threshold
	

Specifies the bandwidth usage threshold for clearing a trap.
	

The value is an integer that ranges from 1 to bandwidth-in-use. The default value is bandwidth-in-use.
Views

Ethernet interface view, GE interface view, XGE interface view, 25GE interface view, MultiGE interface view, 40GE interface view, 100GE interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Monitoring bandwidth usage helps you know current load on a device. If the bandwidth usage exceeds a threshold, bandwidth resources are insufficient and the device capacity needs to be expanded. For example, if the bandwidth usage exceeds 95%, an alarm is generated, indicating that bandwidth resources are almost exhausted. As a result, some services may be interrupted before device capacity expansion.

You can configure two thresholds: low threshold (log threshold) and high threshold (alarm threshold). The system generates a log when the bandwidth usage exceeds the low threshold and generates an alarm when the bandwidth usage exceeds the high threshold. This configuration ensures that you can expand the device capacity in advance to avoid service interruptions caused by bandwidth exhaustion.

Outbound bandwidth usage = (Outbound interface rate/Outbound physical interface bandwidth) x 100

Inbound bandwidth usage = (Inbound interface rate/Inbound physical interface bandwidth) x 100

The interval for collecting statistics on the traffic rate on an interface is the value configured using the set flow-stat interval command on the interface.

The interface rate and bandwidth are expressed in bits per second.

To set a lower threshold, run the log-threshold command.
The trap-threshold command sets the bandwidth usage threshold for generating a trap. The trap-threshold with the following parameters provides various functions:

    trap-threshold input-rate bandwidth-in-use resume-rate resume-threshold: sets the inbound bandwidth usage threshold for generating a trap.
        If inbound bandwidth usage exceeds the threshold specified in bandwidth-in-use, an hwIfMonitorInputRateRising trap is generated, indicating that inbound bandwidth usage exceeds the configured threshold.
        If inbound bandwidth usage falls below the threshold specified in resume-threshold, an hwIfMonitorInputRateResume trap is generated, indicating that inbound bandwidth usage falls between the configured threshold for clearing a trap.
    trap-threshold output-rate bandwidth-in-use resume-rate resume-threshold: sets the outbound bandwidth usage threshold for generating a trap.
        If outbound bandwidth usage exceeds the threshold specified in bandwidth-in-use, an hwIfMonitorOutputRateRising trap is generated, indicating that outbound bandwidth usage exceeds the configured threshold.
        If outbound bandwidth usage falls below the threshold specified in resume-threshold, an hwIfMonitorOutputRateResume trap is generated, indicating that outbound bandwidth usage falls between the configured threshold for clearing a trap.

If the offset between the value of bandwidth-in-use and the value of resume-threshold is too small, trap information may be frequently displayed.

The log threshold must be lower than the trap threshold, providing efficient protection for services. For example, when the inbound bandwidth usage reaches 80%, a log is generated. If the inbound bandwidth usage continues to increase and reaches 95%, a trap is generated. This ensures that a log is generated for inbound bandwidth usage of 80%, and a trap is generated for inbound bandwidth usage of 95%. Either the log or the trap prompts for a bandwidth increase, preventing service interruption.
Example
# Configure GE0/0/1 to generate a trap when the outbound bandwidth usage exceeds 60%.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] trap-threshold output-rate 60

# Configure GE0/0/1 to generate a trap when the outbound bandwidth usage exceeds 80% and clear the trap when the outbound bandwidth usage falls below 60%.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] trap-threshold output-rate 80 resume-rate 60

trap-threshold enable
Function

The trap-threshold enable command enables the function of reporting an alarm if packets are discarded on an interface due to a congestion.

The undo trap-threshold enable command disables the function of reporting an alarm if packets are discarded on an interface due to a congestion.

By default, this function is disabled.
Format

trap-threshold { input-discard | output-discard } enable

undo trap-threshold { input-discard | output-discard } enable
Parameters
Parameter 	Description 	Value

input-discard
	

Enables the function of reporting an alarm if incoming packets are discarded on an interface due to a congestion.
	

-

output-discard
	

Enables the function of reporting an alarm if outgoing packets are discarded on an interface due to a congestion.
	

-
Views

GE interface view, MultiGE interface view, XGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view

Only the S5736-S equipped with the S7C02000, S7Q02001, ES5D21Q02Q00 or ES5D21Q04Q01 card supports this command in the 40GE interface view.
Default Level

2: Configuration level
Usage Guidelines

If a congestion occurs on a network that is running, packets may be discarded when service flows are transmitted on the network. If a lot of packets are discarded, services are affected. To improve transmission quality of service flows, you can run the trap-threshold enable command to enable the function of reporting an alarm if packets are discarded on an interface due to a congestion. The device then reports an alarm if the number of discarded incoming and outgoing packets on the interface in a specified period exceeds the threshold. Such alarms help you know the congestion on the interface. You can determine whether to increase the bandwidth or cancel the bandwidth limit on the interface based on the logs. In this way, the congestion problem can be rectified.
Example

# Enable the function of reporting an alarm if incoming packets are discarded on XGE0/0/1 due to a congestion.

<HUAWEI> system-view
[HUAWEI] interface XGigabitEthernet 0/0/1
[HUAWEI-XGigabitEthernet0/0/1] trap-threshold input-discard enable

trap-threshold error-percentage
Function

The trap-threshold error-percentage command configures the alarm threshold for the percentage of CRC packets against all the received packets on an interface and alarm interval.

The undo trap-threshold error-percentage command deletes the configured alarm threshold and interval.

By default, the alarm threshold and interval are not configured.
Format

trap-threshold error-percentage threshold-value interval interval-value

undo trap-threshold error-percentage [ threshold-value interval interval-value ]
Parameters
Parameter 	Description 	Value

threshold-value
	

Specifies the alarm threshold for the percentage of CRC packets against all the received packets on the interface.
	

The value is an integer that ranges from 1 to 50.
NOTE:

You are advised to set the threshold to be smaller than the alarm threshold configured in the error-down-threshold error-percentage command.

interval interval-value
	

Specifies the interval for calculating the percentage of CRC packets against all the received packets on the interface.
	

The value is an integer that ranges from 10 to 65535, in seconds.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

When an interface receives too many CRC packets, packet forwarding is affected. To enable the device to report the corresponding alarm if the percentage of received CRC packets against all the received packets within the specified period exceeds the alarm threshold, run this command.

Precautions

This command is mutually exclusive to the trap-threshold error-statistics command. After this command is configured, the trap-threshold error-statistics command configuration does not take effect.
Example

# Set the alarm threshold for the percentage of CRC packets against all the received packets to 10% and the interval for calculating the percentage of CRC packets against all the received packets to 20 seconds on GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface GigabitEthernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] trap-threshold error-percentage 10 interval 20

trap-threshold error-statistics
Function

The trap-threshold error-statistics command sets the alarm threshold for error packets and alarm interval.

The undo trap-threshold error-statistics command restores the default alarm threshold for error packets and default alarm interval.

By default, the alarm threshold for error packets is 3 and the alarm interval is 10 seconds.
Format

trap-threshold error-statistics threshold-value interval interval-value

undo trap-threshold error-statistics
Parameters

Parameter
	

Description
	

Value

threshold-value
	

Sets the alarm threshold for error packets.
	

The value is an integer that ranges from 1 to 65535.
NOTE:

The value should not be greater than the alarm threshold for error packets that cause the interface status to change to Error-Down configured by the error-down-threshold error-statistics command.

interval interval-value
	

Sets the interval for reporting alarms for error packets.
	

The value is an integer that ranges from 10 to 65535, in seconds.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, 40GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

The system generates an alarm when the number of error packets received by an interface within an alarm interval exceeds the alarm threshold. If the number of received error packets is 0 in the next alarm interval, the system displays an alarm clearance message.
Example

# Set the alarm threshold for error packets on GE0/0/1 to 10 and the alarm interval to 30 seconds.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] trap-threshold error-statistics 10 interval 30

trap-threshold interval
Function

The trap-threshold interval command sets the interval for reporting an alarm if packets are discarded on an interface due to a congestion.

The undo trap-threshold interval command restores the default interval for reporting an alarm if packets are discarded on an interface due to a congestion.

By default, the interval for reporting an alarm if packets are discarded on an interface due to a congestion is 300 seconds.
Format

trap-threshold { input-discard | output-discard } interval interval-value

undo trap-threshold { input-discard | output-discard } interval
Parameters
Parameter 	Description 	Value

input-discard
	

Enables the function of reporting an alarm if incoming packets are discarded on an interface due to a congestion.
	

-

output-discard
	

Enables the function of reporting an alarm if outgoing packets are discarded on an interface due to a congestion.
	

-

interval interval-value
	

Specifies the interval for reporting an alarm.
	

The value is an integer ranging from 60 to 86400, in seconds. It must be an integer multiple of 10.
Views

GE interface view, MultiGE interface view, XGE interface view, 25GE interface view, 100GE interface view, port group view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Network congestion during service transmission may cause packet loss. If a lot of packets are discarded, services are affected. To improve transmission quality of service flows, you need to enable the device to report alarms to notify users of the current network status if the number of packets discarded due to a congestion in a period of time reaches the specified limit. In this case, you can run the trap-threshold interval command to flexibly adjust the interval for reporting an alarm if packets are discarded due to a congestion based on actual service situations. Such alarms help you know the congestion on the interface. You can determine whether to increase the bandwidth or cancel the bandwidth limit on the interface based on the logs. In this way, the congestion problem can be solved.

Precautions

After this command is run, only the interval for reporting an alarm if packets are discarded on an interface due to a congestion is set. The corresponding alarm is triggered only after the function of reporting an alarm if packets are discarded on an interface due to a congestion is enabled using the trap-threshold enable command and the number of discarded packets on the interface within a specified period of time reaches the alarm threshold.

If this command is executed multiple times, only the latest configuration takes effect.
Example

# Set the interval for reporting an alarm if incoming packets are discarded on XGE0/0/1 due to a congestion to 80 seconds.

<HUAWEI> system-view
[HUAWEI] interface XGigabitEthernet 0/0/1
[HUAWEI-XGigabitEthernet0/0/1] trap-threshold input-discard interval 80

trap-threshold threshold
Function

The trap-threshold threshold command sets the alarm threshold for the number of discarded packets on an interface due to a congestion.

The undo trap-threshold threshold command restores the default alarm threshold for the number of discarded on an interface due to a congestion.

By default, the alarm threshold for the number of discarded packets on an interface due to a congestion is 6000.
Format

trap-threshold { input-discard | output-discard } threshold threshold-value

undo trap-threshold { input-discard | output-discard } threshold
Parameters
Parameter 	Description 	Value

input-discard
	

Enables the function of reporting an alarm if incoming packets are discarded on an interface due to a congestion.
	

-

output-discard
	

Enables the function of reporting an alarm if outgoing packets are discarded on an interface due to a congestion.
	

-

threshold-value
	

Specifies the alarm threshold for the number of discarded packets on an interface due to a congestion.
	

The value is an integer that ranges from 100 to 4294967295.
Views

Ethernet interface view, GE interface view, XGE interface view, MultiGE interface view, 25GE interface view, port group view

Only the S5736-S equipped with the S7C02000, S7Q02001, ES5D21Q02Q00 or ES5D21Q04Q01 card supports this command in the 40GE interface view.
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Network congestion during service transmission may cause packet loss. If a lot of packets are discarded, services are affected. To improve transmission quality of service flows, you need to enable the device to report alarms to notify users of the current network status if the number of packets discarded due to a congestion in a period of time reaches the specified limit. In this case, you can run the trap-threshold threshold command to flexibly adjust the alarm threshold for the number of discarded packets on an interface due to a congestion based on actual service situations. Such alarms help you know the congestion on the interface. You can determine whether to increase the bandwidth or cancel the bandwidth limit on the interface based on the logs. In this way, the congestion problem can be solved.

Precautions

    After this command is run, only the interval for reporting an alarm if packets are discarded on an interface due to a congestion is set. The corresponding alarm is triggered only after the function of reporting an alarm if packets are discarded on an interface due to a congestion is enabled using the trap-threshold enable command and the number of discarded packets on the interface within a specified period of time reaches the alarm threshold.
    If the number of discarded packets exceeds the threshold in several consecutive statistics intervals, the device only reporting an alarm in the first statistics interval, indicating that the number of discarded packets exceeds the threshold. If the number of discarded packets falls below the threshold, the device reporting an alarm indicating that the number of discarded packets falls below the threshold. If the number of discarded packets on an interface exceeds the threshold again, the device will report an alarm indicating that the number of discarded packets exceeds the threshold.
    If this command is executed multiple times, only the latest configuration takes effect.

Example

# Set the alarm threshold for the number of discarded incoming packets on XGE0/0/1 due to a congestion to 200.

<HUAWEI> system-view
[HUAWEI] interface XGigabitEthernet 0/0/1
[HUAWEI-XGigabitEthernet0/0/1] trap-threshold input-discard threshold 200

virtual-cable-test
Function

The virtual-cable-test command tests the cable connected to an Ethernet electrical interface and displays the test result.

The MEth management interfaces on the following devices support this command: S5731-S, S5731S-S, S5731-H, S5731S-H, S5732-H, S6730-S, S6730S-S, S6730-H, S6730S-H, S6735-S.
The service interfaces on the following devices do not support this command:

    MultiGE interfaces on the S5720-28X-PWH-LI-AC and S5736-S24UM4XC
    XGE electrical interfaces on the ES5D21X08T00 card

For the S5731-S24N4X2Q-A, S5731-S24UN4X2Q, S5731-S8UM16UN2Q, S5731S-S24N4X2Q-A1, S5731S-S24UN4X2Q-A, S5731S-S8UM16UN2Q-A, S5732-H24UM2CC (part number: 02353SJY-020, 02353SJY-021, 02353SJY-024), and S5732-H48UM2CC (part number: 02353SJT-020, 02353SJT-021, 02353SJT-023, 02353SJT-024), if the MultiGE interface is configured to work in auto-negotiation mode, and the peer interface is set to 100 Mbit/s, the local check result obtained using the virtual-cable-test command is inaccurate.
Format

virtual-cable-test
Parameters

None
Views

MEth interface view, Ethernet interface view, GE interface view, XGE interface view, 25GE interface view
Default Level

3: Management level
Usage Guidelines

Usage Scenario
If the cable is faulty, the interface is in Down state or the interface rate is abnormal even if it is in Up state. You can run the virtual-cable-test command to check whether the cable works properly. According to the command output, you can locate and rectify cable faults.

    If the cable works properly, the total length of the cable is displayed.

    If the cable cannot work properly, the distance between the interface and the failure point is displayed.

VCT can be performed in either of the following modes:

    Common mode: The test speed is fast (about 2.5s), but the test precision is low.
    Enhanced mode: The test precision is high, but the test duration is longer (about 8s).

For the S5736-S24T4XC, S5736-S48T4XC, S5736-S24U4XC, and S5736-S48U4XC, when ports are Up, VCT operates in common mode; when ports are Down, VCT operates in enhanced mode. Other devices support only VCT in enhanced mode.

Precautions

    The test result is only for reference and may be inaccurate for cables of some vendors.
    If the detection result is Unknown, you are advised to use the cable analyzer to perform the test.
    The test result is related to the cable signal attenuation. When the cable length is shorter than 3 m, the cable signal attenuation mostly is resulted from the connector, not the cable. The test result is therefore inaccurate.
    Running the virtual-cable-test command may affect services on the interface in a short period of time, and the interface in Up state may alternate between Up and Down.
    Combo electrical interfaces support cable tests, but cable tests are not recommended on combo electrical interfaces because services will be interrupted.
    This command can be used on an XGE optical interface or GE optical interface when the interface has a GE copper module installed.
    After a 25GE optical interface is configured to work at the rate of 1 Gbit/s using the port mode ge command and has a GE copper module installed, the virtual-cable-test command can be configured on the interface.
    When a GE electrical interface on the S5720-LI, S2730S-S, S5735-L-I, S5735-L1, S300, S5735-L, S5735S-L1, S5720S-LI, S5735S-H, S5736-S, S6720S-S, S500, S5735-S, S5735-S-I, and S5720I-SI works at a rate of 1000 Mbit/s or 100 Mbit/s and the interface is up, the detection result is inaccurate.
    On the S5732-H, S6730-H, S6730S-H, S6730-S, S6730S-S, and S6735-S, when a GE electrical interface works at a rate of 100 Mbit/s, the detection result is inaccurate.
    On the S5731-H, S5731S-H, S5731-S, and S5731S-S, when a GE electrical interface works at a rate of 10 Mbit/s, 100 Mbit/s, or 1000 Mbit/s and the interface is up, the detection result is inaccurate.
    The test result is inaccurate when the interface is in the Up state or the remote interface is shut down.
    An FE electrical port uses only two pairs of wire pairs. The test result of the two pairs of wire pairs that are not used during the VCT test is inaccurate.
    When a GE electrical port works at a rate of 10 Mbit/s or 100 Mbit/s, only two pairs of cables are used to detect the VCT status. The other two pairs of cables do not detect or return the default result.
    The virtual cable test (VCT) cannot be performed on multiple interfaces of the device at the same time.

Example
# Test the cable connected to Ethernet electrical interface GE0/0/1.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] virtual-cable-test
Warning: The command will stop service for a while. Continue? [Y/N]y
Info: This operation may take a few seconds. Please wait for a moment..........done.
Pair A length: 189meter(s)
Pair B length: 189meter(s)
Pair C length: 189meter(s)
Pair D length: 189meter(s)
Pair A state: Ok
Pair B state: Ok
Pair C state: Ok
Pair D state: Ok  
Info: The test result is only for reference.

Table 4-33 Description of the virtual-cable-test command output

Item
	

Description

Pair A/B/C/D
	

Four pairs of circuits in a network cable.

A: orange/white and orange

B: green/white and green

C: blue/white and blue

D: brown/white and brown

Pair A length
	
Length of a network cable. The command output is for reference only. You are advised to use a network cable analyzer to perform a test.

    The length is the distance between the interface and the faulty point if a fault occurs.
    The length is the actual length of the cable when the cable works properly.
    The length is the default length 0 m if the interface is not connected to any cable. The test result of different chips may vary.

NOTE:

If the cable length is displayed as Unknown, the cable status is OK, but the cable length test result cannot be used.

If the cable status is Open (indicating open circuit), the cable length in the VCT result can be used.
If the remote interface is shut down, the cable length in the VCT result can be used for combo electrical interfaces on the following switches:

    S5720I-SI
    S5720-52X-LI-48S-AC

If the remote interface is shut down, the cable length in the VCT result can be used for electrical interfaces on the following switches:

    S5731-H
    S6730-H
    S6730S-H
    S5720-16X-PWH-LI-AC, S5720-28X-PWH-LI-AC, S5720-28X-PWH-LI-ACF, S5720-52X-LI-48S-AC

Pair A state
	
Network cable status. The command output is for reference only. You are advised to use a network cable analyzer to perform a test.

    Ok: indicates that the circuit pair is terminated normally.
    Open: indicates that the circuit pair is not terminated.
    Short: indicates that the circuit pair is short-circuited.
    Crosstalk: indicates that the circuit pairs interfere with each other.
    Unknown: Other unknown fault causes are detected or the detection result is inaccurate.

