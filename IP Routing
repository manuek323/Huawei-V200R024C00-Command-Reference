1 IP Routing
1.1 Overview of IP Routing
1.2 Understanding IP Routing
1.1 Overview of IP Routing
Routing is the basic element of data communications networks. It is the process of
selecting paths on a network along which packets are sent from a source to a
destination.
According to the destination address, routes are classified into one of the
following types:
● Network segment route
The destination is a network segment. In this case, if the destination is an
IPv4 address, the subnet mask is less than 32 bits, and if the destination is an
IPv6 address, the prefix length is less than 128 bits.
● Host route
The destination is a host. In this case, if the destination is an IPv4 address, the
subnet mask is 32 bits, and if the destination is an IPv6 address, the prefix
length is 128 bits.
According to whether the destination directly connects to a router, routes are
classified into one of the following types:
● Direct route
The router directly connects to the network where the destination is located.
● Indirect route
The router indirectly connects to the network where the destination is located.
According to the destination address type, routes are classified into one of the
following types:
● Unicast route
The destination address is a unicast address.
● Multicast route
The destination address is a multicast address.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 1
1.2 Understanding IP Routing
1.2.1 Routers and Routing
On the Internet, network connecting devices such as hubs, bridges, switches, and
routers control traffic and ensure data transmission quality. Each of these devices
serves as a different role, but for a common purpose: forming a functioning
network. The following describes a router's role in a network, and the purpose and
nature of routes.
A router selects routes and forwards packets. Upon receiving a packet, a router
selects a proper path, which may have one or more hops, to send the packet to
the next router according to the destination address in the packet. The last router
is responsible for sending the packet to the destination host.
A route is a path along which packets are sent from the source to the destination.
When multiple routes are available to send packets from a router to the
destination, the router can select the optimal route from an IP routing table.
Optimal route selection depends on routing protocol preferences and metrics of
routes. When multiple routes have the same routing protocol preference and
metric, load balancing can be implemented among these routes to relieve network
pressure. When multiple routes have different routing protocol preferences and
metrics, route backup can be implemented among these routes to improve
network reliability.
1.2.2 Static Routes and Dynamic Routes
Routers support direct, static, and dynamic routes. Dynamic routes include Routing
Information Protocol (RIP) routes, Open Shortest Path First (OSPF) routes,
Intermediate System-to-Intermediate System (IS-IS) routes, and Border Gateway
Protocol (BGP) routes.
Differences Between Static Routes and Dynamic Routes
Routing protocols are the rules used by routers to discover routes, generate
routing tables, and guide packet forwarding. Routes are classified into the
following types according to their origin:
● Direct routes: are discovered by link layer protocols.
● Static routes: are manually configured by network administrators.
● Dynamic routes: are discovered by dynamic routing protocols.
Static routes are easy to configure, have low system requirements, and apply to
simple, stable, and small networks. The disadvantage of static routes is that they
require subsequent maintenance as they cannot automatically adapt to network
topology changes.
Dynamic routing protocols have routing algorithms. Therefore, dynamic routes can
automatically adapt to network topology changes and apply to networks on which
Layer 3 devices are deployed. The disadvantages of dynamic routes are that they
are complex to configure, have higher system requirements than static ones, and
consume network and system resources.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 2
Classification of Dynamic Routing Protocols
Dynamic routing protocols are classified based on the following two criteria.
According to the application range, dynamic routing protocols are classified into
the following types:
● Interior Gateway Protocols (IGPs)
Run inside an autonomous system (AS), including RIP, OSPF, and IS-IS.
● Exterior Gateway Protocols (EGPs)
Run between ASs, including BGP (most widely used EGP).
According to the type of algorithm they use, dynamic routing protocols are
classified into the following types:
● Distance-vector routing protocols
Include RIP and BGP. BGP is also called a path-vector protocol.
● Link-state routing protocols
Include OSPF and IS-IS.
The preceding algorithms differ mainly in route discovery and calculation
methods.
1.2.3 Routing Table and FIB Table
Routers forward packets based on routing tables and forwarding information base
(FIB) tables. Each router maintains at least one routing table and one FIB table.
Routers select routes based on routing tables and forward packets based on FIB
tables.
Routing Table
Each router maintains a local core routing table (namely, an IP routing table), and
each routing protocol maintains its own routing table.
● Local core routing table
A router uses the local core routing table to store preferred routes. The router
then sends the preferred routes to the FIB table to guide packet forwarding.
The router selects routes according to routing protocol preferences and costs
stored in the routing table.
● Protocol routing table
A protocol routing table stores routing information discovered by the protocol.
A routing protocol can import and advertise routes that are discovered by
other routing protocols. For example, a router runs the Open Shortest Path
First (OSPF) protocol. To use OSPF to advertise direct routes, static routes, or
Intermediate System-Intermediate System (IS-IS) routes, the router must
import the routes into the OSPF routing table.
Routing Table Contents
You can run the display ip routing-table command on a router to view basic
information about the routing table of the router. The command output is as
follows:
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 3
<HUAWEI> display ip routing-table
Proto: Protocol Pre: Preference
Route Flags: R - relay, D - download to fib, T - to vpn-instance
------------------------------------------------------------------------------
Routing Tables: Public
Destinations : 14 Routes : 14
Destination/Mask Proto Pre Cost Flags NextHop Interface
0.0.0.0/0 Static 60 0 RD 10.137.216.1 Vlanif20
10.10.10.0/24 Direct 0 0 D 10.10.10.10 Vlanif20
10.10.10.10/32 Direct 0 0 D 127.0.0.1 InLoopBack0
10.10.10.255/32 Direct 0 0 D 127.0.0.1 InLoopBack0
10.10.11.0/24 Direct 0 0 D 10.10.11.1 LoopBack0
10.10.11.1/32 Direct 0 0 D 127.0.0.1 InLoopBack0
10.10.11.255/32 Direct 0 0 D 127.0.0.1 InLoopBack0
10.137.216.0/23 Direct 0 0 D 10.137.217.208 Vlanif20
10.137.217.208/32 Direct 0 0 D 127.0.0.1 InLoopBack0
10.137.217.255/32 Direct 0 0 D 127.0.0.1 InLoopBack0
127.0.0.0/8 Direct 0 0 D 127.0.0.1 InLoopBack0
127.0.0.1/32 Direct 0 0 D 127.0.0.1 InLoopBack0
127.255.255.255/32 Direct 0 0 D 127.0.0.1 InLoopBack0
255.255.255.255/32 Direct 0 0 D 127.0.0.1 InLoopBack0
A routing table contains the following key data for each IP packet:
● Destination: identifies the destination IP address or destination network
address of an IP packet.
● Mask: supplements the destination address to specially identify the address of
the network segment where the destination host or router resides.
The network segment address of a destination host or router is obtained
through the "AND" operation on the destination address and network mask.
For example, if the destination address is 10.1.1.1 and the mask is
255.255.255.0, the address of the network segment where the host or router
resides is 10.1.1.0.
The network mask is composed of several consecutive 1s. These 1s can be
expressed in either the dotted decimal notation or the number of consecutive
1s in the mask. For example, the network mask can be expressed either as
255.255.255.0 or 24.
● Proto: indicates the protocol through which routes are learned.
● Pre: indicates the routing protocol preference of a route. There may be
multiple routes to the same destination, which have different next hops and
outbound interfaces. These routes may be discovered by different routing
protocols or manually configured. A router selects the route with the highest
preference (the smallest value) as the optimal route. For the routing protocol
preference, see 1.2.5 Routing Protocol Preference.
● Cost: indicates the route cost. When multiple routes to the same destination
have the same preference, the route with the lowest cost is selected as the
optimal route.
NOTE
The Preference value is used to compare the preferences of different routing protocols,
while the Cost value is used to compare the preferences of different routes of the
same routing protocol.
● NextHop: indicates the IP address of the next device that an IP packet passes
through.
● Interface: indicates the outbound interface through which an IP packet is
forwarded.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 4
In Figure 1-1, the routing table of RouterA shows that it connects to three
networks, so it has three IP addresses and three outbound interfaces.
Figure 1-1 Routing table
Matching with FIB Table
After selecting an optimal route from the routing table, a router sends it to the FIB
table. When receiving a packet, the router compares it against the FIB table to
find the optimal route to forward the packet.
Each entry in the FIB table contains the physical or logical interface through which
a packet is sent to a network segment or host to reach the next router. An entry
can also indicate whether the packet can be sent to a destination host in a directly
connected network.
The router performs the "AND" operation on the destination address in the packet
and the network mask of each entry in the FIB table. The router then compares
the result of the "AND" operation with the entries in the FIB table to find a match
and chooses the optimal route to forward packets according to the longest match
rule.
For example, assume that a router has the following routing table:
Routing Tables:
Destination/Mask Proto Pre Cost Flags NextHop Interface
0.0.0.0/0 Static 60 0 D 192.168.0.2 GigabitEthernet1/0/0
10.8.0.0/16 Static 60 3 D 192.168.0.2 GigabitEthernet1/0/0
10.9.0.0/16 Static 60 50 D 172.16.0.2 GigabitEthernet3/0/0
10.9.1.0/24 Static 60 4 D 192.168.0.2 GigabitEthernet2/0/0
10.20.0.0/16 Direct 0 0 D 172.16.0.1 GigabitEthernet4/0/0
After receiving a packet carrying the destination address 10.9.1.2, the router
searches the following FIB table:
FIB Table:
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 5
Total number of Routes : 5
Destination/Mask Nexthop Flag TimeStamp Interface TunnelID
0.0.0.0/0 192.168.0.2 SU t[37] GigabitEthernet1/0/0 0x0
10.8.0.0/16 192.168.0.2 DU t[37] GigabitEthernet1/0/0 0x0
10.9.0.0/16 172.16.0.2 DU t[9992] GigabitEthernet3/0/0 0x0
10.9.1.0/24 192.168.0.2 DU t[9992] GigabitEthernet2/0/0 0x0
10.20.0.0/16 172.16.0.1 U t[9992] GigabitEthernet4/0/0 0x0
The router performs the "AND" operation on the destination address 10.9.1.2 and
the masks 0, 16, and 24 to obtain the network segment addresses: 0.0.0.0/0,
10.9.0.0/16, and 10.9.1.0/24. The three addresses match three entries in the FIB
table. The router chooses the entry 10.9.1.0/24 according to the longest match
rule, and forwards the packet through GigabitEthernet2/0/0.
1.2.4 Route Recursion
Routes can be used to forward traffic only when they have directly connected next
hops. However, this condition may not be met when routes are generated. The
system then needs to search for directly connected next hops and corresponding
outbound interfaces. This process is called route recursion. In most cases, BGP
routes, static routes, and user network routes (UNRs) do not have directly
connected next hops, and route recursion is required. The following examples
demonstrate how route recursion generates an FIB entry.
A next-hop IP address of a BGP route is often the IP address of an indirectly
connected peer's Loopback interface, and therefore the BGP route needs to be
recursed. The system searches the IP routing table for a direct route (an IGP route
in most cases) that is destined for the next-hop IP address of the BGP route. Then,
the system adds the next-hop IP address and outbound interface of the IGP route
to the IP routing table, generating a FIB entry.
A next-hop IP address of a BGP VPN route is often the IP address of an indirectly
connected PE's Loopback interface, and the BGP route needs torecurse to a tunnel.
The system searches the tunnel list for a tunnel that is destined for this Loopback
IP address. Then, the system adds the tunnel information to the routing table,
generating a FIB entry.
1.2.5 Routing Protocol Preference
Routing protocols (including static routing) may discover different routes to the
same destination, but not all routes are optimal. Only one routing protocol at a
time determines the optimal route to a destination. To select the optimal route,
each routing protocol (including static routing) is assigned a preference (a smaller
value indicates a higher preference). When multiple routing information sources
coexist, the route discovered by the routing protocol with the highest preference is
selected as the optimal route and added to the local routing table.
Routers define external and internal preferences. External preference is manually
configured for each routing protocol. Table 1-1 lists the default external
preferences of routing protocols.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 6
Table 1-1 Routing protocols and their default external preferences
Routing Protocol or
Route Type
Default External Preference
Direct 0
OSPF 10
IS-IS 15
Static 60
RIP 100
OSPF ASE 150
OSPF NSSA 150
IBGP 255
EBGP 255
NOTE
In Table 1-1, the value 0 indicates direct routes and the value 255 indicates routes learned
from unreliable sources. A smaller value indicates a higher preference.
You can manually configure the external preference of all routing protocols except direct
routes. The preference for each static route varies.
Internal preferences of routing protocols cannot be manually configured. Table
1-2 lists the internal preferences of routing protocols.
Table 1-2 Internal preferences of routing protocols
Routing Protocol or
Route Type
Internal Preference
Direct 0
OSPF 10
IS-IS Level-1 15
IS-IS Level-2 18
Static 60
RIP 100
OSPF ASE 150
OSPF NSSA 150
IBGP 200
EBGP 20
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 7
During route selection, a router first compares the external preferences of routes.
When the same external preference is set for different routing protocols, the
router selects the optimal route based on the internal preference. For example,
assume that there are two routes to 10.1.1.0/24: a static route and an OSPF route.
Both routes have the same external preference: 5. In this case, the router
determines the optimal route based on the internal preference listed in Table 1-2.
An OSPF route has an internal preference of 10, and a static route has an internal
preference of 60. This indicates that the OSPF route has a higher preference than
the static route, so the router selects the OSPF route as the optimal route.
NOTE
● If multiple OSPFv2 or OSPFv3 processes learn routes to the same destination and the
external and internal preferences of the routes are the same, the system selects the
route with the smallest link cost; if the link costs of the routes are the same, the routes
participate in load balancing.
● If multiple IS-IS processes learn routes to the same destination and the external and
internal preferences of the routes are the same, the system selects the route with the
smallest link cost; if the link costs of the routes are the same, the routes participate in
load balancing.
● If multiple RIP or RIPng processes learn routes to the same destination and the external
and internal preferences of the routes are the same, the system selects the route with
the smallest link cost; if the link costs of the routes are the same, the routes participate
in load balancing.
In addition, policy-based routing (PBR) provides a mechanism for selecting routes
based on user-defined policies. It allows switches to forward packets based on
users even after routing entries are generated. PBR takes precedence over direct
routes, static routes, and routes generated by dynamic routing protocols.
1.2.6 Route Metric
A route metric specifies the cost of a route to a specified destination address. The
following factors often affect the route metric:
● Path length
Path length is the most common factor that affects the route metric. Link-
state routing protocols allow you to assign a link cost for each link to identify
the path length of a link. In this case, the path length is the sum of the link
costs of all the links that packets pass through. Distance-vector routing
protocols use the hop count to identify the path length. The hop count is the
number of devices that packets pass through from the source to the
destination. For example, the hop count from a router to its directly
connected network is 0, and the hop count from a router to a network that
can be reached through just another router is 1. Other lengths can be
deduced in the same manner.
● Network bandwidth
Network bandwidth is the transmission capability of a link. For example, a 10-
Gigabit link has a higher transmission capability than a 1-Gigabit link.
Although bandwidth defines the maximum transmission rate of a link, routes
over high-bandwidth links are not necessarily better than routes over low-
bandwidth links. For example, when a high-bandwidth link is congested,
forwarding packets over this link will require more time.
● Load
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 8
The load is the degree to which a network resource is busy. You can obtain
the load by calculating the CPU usage and packets processed per second.
Continually monitoring the CPU usage and packets processed per second
helps you learn more about network usage.
● Communication cost
The communication cost is the operating cost of a route over a link. The
communication cost is another important indicator, especially if you do not
care about network performance but are concerned about the operating
expenditure.
1.2.7 Load Balancing and Route Backup
When multiple routes have the same routing protocol preference and metric, these
routes are called equal-cost routes, among which load balancing can be
implemented. When multiple routes have different routing protocol preferences
and metrics, route backup can be implemented among these routes.
Load Balancing
Routers support the multi-route mode, which allows you to configure multiple
routes with the same destination and preference. If the destinations and costs of
multiple routes discovered by the same routing protocol are the same, load
balancing can be performed among the routes.
Currently, static routes and routing protocols (such as RIP, OSPF, BGP, and IS-IS)
use per-flow load balancing. During load balancing, a router forwards packets
based on the packets' 5-tuple (source IP address, destination IP address, source
port, destination port, and transmission protocol). When the 5-tuple information is
the same, the router always chooses the next-hop address that is the same as the
last one to send packets. When the 5-tuple information is different, the router
forwards packets over idle paths.
Figure 1-2 Networking diagram of load balancing
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 9
In the example shown in Figure 1-2, RouterA forwards the first packet P1 to
10.1.1.0/24 through GE0/0/1 and needs to forward subsequent packets to
10.1.1.0/24 and 10.2.1.0/24 respectively. The forwarding process is as follows:
● If the 5-tuple information of P2 destined for 10.1.1.0/24 is the same as that of
P1 destined for 10.1.1.0/24, RouterA forwards P2 and subsequent packets
destined for 10.1.1.0/24 through GE0/0/1.
● If the 5-tuple information of P1 destined for 10.2.1.0/24 is different from that
of P1 destined for 10.1.1.0/24, RouterA forwards P1 and subsequent packets
destined for 10.2.1.0/24 through GE0/0/2.
NOTE
The number of equal-cost routes for load balancing varies with product models.
Route Backup
Route backup can improve network reliability. You can configure multiple routes
to the same destination as required. The route with the highest preference
functions as the primary route, and other routes with lower preferences function
as backup routes.
A router generally uses the primary route to forward data. When the primary link
fails, the primary route becomes inactive. The router selects a backup route with
the highest preference to forward data. In this manner, data is switched from the
primary route to a backup route. When the primary link recovers, the router
selects the primary route to forward data again because the primary route has the
highest preference. Data is then switched back from the backup route to the
primary route.
1.2.8 IP FRR
Definition
IP fast reroute (FRR) is a method that implements fast route backup. It enables a
router to immediately use a backup link for packet forwarding if the router detects
a fault at the physical or data link layer. With IP FRR, the router also reports the
fault to the upper-layer routing system.
Purpose
On traditional IP networks, when a fault occurs at the lower layer on a network,
the physical interface on the router becomes Down. After the router detects the
fault, it informs the upper-layer routing system to recalculate routes and then
updates routing information. Usually, it takes the routing system several seconds
to re-select an available route.
Second-level convergence is intolerable to services that are sensitive to delay and
packet loss because it may lead to service interruptions. For example, Voice over
Internet Protocol (VoIP) services are only tolerant of millisecond-level
interruptions.
IP FRR resolves this by ensuring that the forwarding system rapidly detects a link
fault and then uses a backup route to restore services as soon as possible.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 10
IP FRR Classification and Implementation
IP FRR, which is designed for routes on IP networks, is classified into IP FRR on
public networks and IP FRR on private networks.
● Public network IP FRR protects routers on public networks.
● Private network IP FRR protects Customer Edges (CEs).
IP FRR is implemented as follows:
1. If the primary link is available, you can configure an IP FRR policy to provide
the forwarding information of the backup route to the forwarding engine.
2. If the forwarding engine detects a primary link fault, the engine uses the
backup link to forward traffic before the routes on the control plane converge.
Comparison Between IP FRR and VPN FRR
Table 1-3 Comparison Between IP FRR and VPN FRR
Item Description
IP FRR IP FRR is suitable for IP services that
require a low delay and low packet
loss ratio.
● Protects the public network and
CEs.
● Implements FRR through a backup
route.
VPN FRR VPN FRR is suitable for services that
require a low delay and low packet
loss ratio on VPNs.
● Protects provider edges (PEs).
● Implements FRR through a backup
tunnel.
Comparison Between IP FRR and Load Balancing
Table 1-4 Comparison Between IP FRR and Load Balancing
Item Description
IP FRR Implements FRR through a backup
route. IP FRR is applicable to networks
where a primary link and a backup
link exist and load balancing is not
configured.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 11
Item Description
Load Balancing Implements fast route switching
through equal-cost routes. Load
balancing is applicable to multi-link
networking with load balancing.
IP FRR Typical Application
In the example shown in Figure 1-3, IP FRR is configured to improve network
reliability. CE1 is dual-homed to PE1 and PE2 and has two outbound interfaces
and two next hops configured. That is, link B functions as the backup of link A.
When link A fails, traffic can be rapidly switched to link B.
Figure 1-3 IP FRR
1.2.9 Route Convergence
Definition
Route convergence is the action of recalculating routes to replace existing routes
in the case of network topology changes. The integration of multiple network
services urgently requires differentiated services. Routes for key services, such as
Voice over IP (VoIP), video conferences, and multicast services, need to be
converged rapidly, while routes for common services can be converged relatively
slowly. In this case, the system needs to converge routes based on their
convergence priorities to improve network reliability.
Priority-based convergence is a mechanism that allows the system to converge
routes based on the convergence priority. You can set different convergence
priorities for routes: critical, high, medium, and low (in descending order of
priority). The system then converges routes based on the convergence priorities
and certain convergence rules, that is, schedules these routes in proportion, to
guide service forwarding.
Principles
Routing protocols first compute and deliver routes of high convergence priority to
the system. You can reconfigure the scheduling weight values as required. Table
1-5 lists the default convergence priorities of public routes.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 12
Table 1-5 Default convergence priorities of public routes
Routing Protocol or Route Type Convergence Priority
Direct High
Static Medium
32-bit host routes of OSPF and IS-IS Medium
OSPF routes (excluding 32-bit host
routes)
Low
IS-IS routes (excluding 32-bit host
routes)
Low
RIP Low
BGP Low
NOTE
For private routes, only the convergence priorities of 32-bit OSPF and IS-IS host routes are
identified as medium, and the convergence priorities of the other routes are identified as
low.
Priority-based Route Convergence
Figure 1-4 shows a networking arrangement for multicast services. OSPF and IS-IS
run on the network. The receiver connects to RouterA, and the multicast source
server 10.10.10.10/32 connects to RouterB. The route to the multicast source
server must be converged faster than other routes such as 10.12.10.0/24. You can
set the convergence priority of route 10.10.10.10/32 to be higher than that of
route 10.12.10.0/24. When routes are converged on the network, the route to the
multicast source server 10.10.10.10/32 is converged first. This ensures the
transmission of multicast services.
Figure 1-4 Networking diagram of priority-based route convergence
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 13
1.2.10 Default Routes
Default routes are special routes used only when packets to be forwarded do not
match any routing entry in a routing table. If the destination address of a packet
does not match any entry in the routing table, the packet is sent through a default
route. If no default route exists and the destination address of the packet does not
match any entry in the routing table, the packet is discarded. An Internet Control
Message Protocol (ICMP) packet is then sent, informing the originating host that
the destination host or network is unreachable.
In a routing table, a default route is the route to network 0.0.0.0 (with the mask
0.0.0.0). You can run the display ip routing-table command to check whether a
default route is configured. Generally, administrators can manually configure
default static routes. Default routes can also be generated through dynamic
routing protocols such as OSPF and IS-IS.
1.2.11 Route Importing
Different routing protocols using different algorithms may discover different
routes. If multiple routing protocols run on a large network, the routing protocols
need to re-advertise the routes they discover.
Each routing protocol can import routes discovered by other routing protocols,
direct routes, and static routes.
1.2.12 Autonomous System
An Autonomous System (AS) is a set of IP networks and routers under one
administration entity and with common routing policies.
Each AS supports multiple IGPs. All the networks in an AS are assigned the same
AS number and managed by the same administration group. Two types of AS
numbers are available: a 2-byte AS number (ranges from 1 to 65535) and a 4-byte
AS number (ranges from 1 to 4294967295). Available AS numbers can become
exhausted and thereby 2-byte AS numbers need to be extended to 4-byte AS
numbers. A 4-byte AS number can also be shown in the X.Y format, where X
ranges from 1 to 65535 and Y ranges from 0 to 65535.
AS numbers are classified into public AS numbers and private AS numbers,
depending on the network where they are used. Table 1-6 lists the two types of
AS numbers and their ranges.
Table 1-6 AS number types and ranges
AS Number Type 2-Byte AS Number 4-Byte AS Number
Public AS number 1 to 64511 1 to 64511, 65536 to
4294967295
Private AS number 64512 to 65535 64512 to 65535
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 14
1.2.13 Router ID
A router ID is a 32-bit integer used to uniquely identify a device that uses a
specific dynamic routing protocol for route exchange. A router ID uses the same
format as an IP address. Router IDs are classified into global router IDs of devices
and router IDs of dynamic routing protocols.
A router ID can be manually configured or automatically selected by a device. To
ensure OSPF stability, you are advised to manually configure the IP address of a
loopback interface as a router ID.
Manually Configured Router ID
● If a router ID of a specific dynamic routing protocol is configured, this router
ID takes effect.
● If no router ID of a specific dynamic routing protocol is configured and a
global router ID is configured for the device, the global router ID takes effect.
Router ID Automatically Selected by a Device
If the administrator does not configure a global router ID or configure a router ID
for a specific dynamic routing protocol on the device, the router selects a router ID
based on IP addresses of current interfaces:
● If there are loopback interfaces that have IP addresses configured, the device
selects the largest IP address among loopback interface addresses as the
global router ID.
● If no loopback interface is configured or loopback interfaces do not have IP
addresses configured, the device selects the largest IP address among
interface addresses as the global router ID without considering the Up/Down
state of interfaces.
The device selects a router ID again only when the interface IP address that has
been selected as the router ID is deleted or changed.
When a device is being initialized and there is no interface address on the device,
the first configured IP address on the device, which may be a loopback interface
address or another interface address, will become the global router ID of the
device. This global router ID remains unchanged even if there is a larger interface
IP address on the device. The device selects a new global router ID based on the
preceding rules when the IP address that has been used as the existing global
router ID is deleted.
S300, S500, S2700, S5700 and S6700 Series Ethernet
Switches
Configuration Guide - IP Unicast Routing 1 IP Routing
Issue 01 (2024-09-30) Copyright © Huawei Technologies Co., Ltd. 15
