ip route recursive-lookup inherit-label-route enable
Function

The ip route recursive-lookup inherit-label-route enable command allows a device to recurse routes to cross routes on the remote VPN.

The undo ip route recursive-lookup inherit-label-route enable command disables a device from recursing routes to cross routes on the remote VPN.

By default, routes except static routes cannot recurse to cross routes on the remote VPN.

Only the S5731-H, S5731S-H, S5731-S, S5731S-S, S6730-S, S6730S-S, S5732-H, S6735-S, S6730S-H, and S6730-H support this command.

Format

ip route recursive-lookup inherit-label-route enable

undo ip route recursive-lookup inherit-label-route enable
Parameters

None
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Recursion is required if the next hop of a route is unreachable. To allow routes to recurse to cross routes on the remote VPN, run the ip route recursive-lookup inherit-label-route enable command. After the command is run, routes inherit the labels and tokens of the cross routes on the remote VPN, ensuring correct traffic forwarding. This command mainly applies to BGP/MPLS IP VPN scenarios.

In Figure 7-1, PE1 and PE2 are IBGP peers, and CE1 and PE1 are IGP neighbors. PE2 learns the IP address of CE1's loopback interface, and an EBGP peer relationship is established between CE1 and PE2 using loopback interface IP addresses. By default, the BGP routes that PE2 learns from CE1 through the EBGP peer connection cannot recurse to cross routes on the remote VPN. As a result, traffic fails to be forwarded. To address this problem, run the ip route recursive-lookup inherit-label-route enable command to allow the BGP routes to recurse to cross routes on the remote VPN. After the BGP routes inherit the labels and tokens of the cross routes, traffic can be correctly forwarded.
Figure 7-1 Basic BGP/MPLS IP VPN networking

Example

# Allow a device to recurse routes to cross routes on the remote VPN.

<HUAWEI> system-view

[HUAWEI] ip route recursive-lookup inherit-label-route enable

