UDP Helper Configuration Commands

    Command Support
    display udp-helper port
    display udp-helper server
    reset udp-helper packet
    udp-helper enable
    udp-helper port
    udp-helper server

Command Support

Only the following switch models support UDP helper:

S5720I-SI, S5735-S, S5735-L, S5735-S-I, S5735S-H, S5736-S, S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6720S-S, S6730-H, S6730S-H, S6730-S, and S6730S-S
display udp-helper port
Function

The display udp-helper port command displays the configured UDP ports to which packets need to be relayed on the device.
Format

display udp-helper port
Parameters

None
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

To view the configured UDP ports to which packets need to be relayed, run this command. If the UDP helper function is not enabled, the system displays the following information:

Info: Udp-helper has not been enabled, please enable udp-helper first.

Example

# Display the UDP ports to which packets need to be relayed.

<HUAWEI> display udp-helper port
Udp-Port-Number       Description
-------------------------------------------------------------
       1              TCP Port Service Multiplexer
      37              Time
      49              Login Host Protocol
      53              Domain Name Server
      69              Trivial File Transfer
     137              NETBIOS Name Service
     138              NETBIOS Datagram Service

Table 6-40 Description of the display udp-helper port command output

Item
	

Description

Udp-Port-Number
	

UDP ports to which packets need to be relayed.

UDP ports are classified into the following types:

    Well-known port: The well-known port numbers range from 0 to 1023. These ports are used by standard TCP/UDP protocols.
    Registered port: The registered port numbers range from 1024 to 49151. They are vendor-specific ports.
    Dynamic/Static port: The dynamic or static port numbers range from 49152 to 65535. These ports can be used as required and may conflict on a network.

To configure the UDP ports, run the udp-helper port command.

Description
	

UDP port description.
display udp-helper server
Function

The display udp-helper server command displays the VLANIF interface, destination server address, and number of relayed UDP packets.
Format

display udp-helper server [ interface interface-type interface-number ]
Parameters

Parameter
	

Description
	

Value

interface interface-type interface-number
	
Displays statistics about UDP broadcast packets relayed on the specified interface.

    interface-type specifies the interface type.
    interface-number specifies the interface number.

	

The interface type must be VLANIF.
Views

All views
Default Level

1: Monitoring level
Usage Guidelines

This command displays statistics about packets relayed by UDP helper. The statistics help you monitor the UDP helper function.

If no parameter is specified, statistics about relayed packets on all VLANIF interfaces are displayed.

This command collects statistics on only the packets forwarded by the UDP helper server. Successful packet forwarding depends on the reachable route.
Example

# Display statistics about relayed packets on VLANIF 100.

<HUAWEI> display udp-helper server interface vlanif 100
vlan-interface        Server-Ip                   packet-num
Vlanif100           10.10.10.10                            0

Table 6-41 Description of the display udp-helper server command output

Item
	

Description

vlan-interface
	

VLANIF interface on which UDP packets are relayed.

Server-Ip
	

Destination server address.

You can run the udp-helper server command to set the destination server address.

packet-num
	

Number of packets sent to the destination server.
reset udp-helper packet
Function

The reset udp-helper packet command clears statistics about packets relayed by UDP helper.
Format

reset udp-helper packet
Parameters

None
Views

User view
Default Level

2: Configuration level
Usage Guidelines

This command clears statistics about packets relayed by UDP helper. Before collecting packet statistics in a certain period, run this command to clear existing statistics first.

UDP helper statistics cannot be restored after being cleared. Exercise caution when you run the reset udp-helper packet command.
Example

# Clear statistics about packets relayed by UDP helper.

<HUAWEI> reset udp-helper packet
Warning: This command will delete the packet statistics of udp-helper.Continue?[Y/N]y

udp-helper enable
Function

The udp-helper enable command enables the UDP Helper function.

The undo udp-helper enable command disables the UDP Helper function.

By default, the UDP Helper function is disabled.
Format

udp-helper enable

undo udp-helper enable
Parameters

None
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

Hosts on an enterprise intranet may need to obtain the network configuration or resolve host names by sending UDP broadcast packets to the server. If the host and the server are located in different broadcast domains, broadcast packets cannot reach the server and the host cannot obtain the configuration from the server. The switch provides the UDP Helper function to solve this problem. UDP Helper can relay the UDP broadcast packets with specified destination ports. It converts the broadcast packets into unicast packets and sends the unicast packets to the specified destination servers.

The packets that can be forwarded by UDP Helper must meet the following requirements:

    The destination MAC address is the broadcast MAC address (ffff-ffff-ffff).
    The Time-to-Live (TTL) is larger than 1.
    The protocol type is UDP.
    The destination port is a specified UDP port.

Precautions

UDP helper enables a device to relay DHCP packets destined for UDP port 67 (that is, DHCP packets sent to the DHCP server).

However, a UDP helper-enabled device cannot relay DHCP packets destined for UDP port 68 (that is, DHCP packets sent to the DHCP client). To relay this type of DHCP packets, you must enable the DHCP relay function.

After the UDP Helper function is enabled, the switch relays broadcast packets destined for the following UDP ports by default.

Protocol
	

UDP Port Number

Trivial File Transfer Protocol (TFTP)
	

69

Domain Name System (DNS)
	

53

Time Service
	

37

NetBIOS Name Service (NetBIOS-NS)
	

137

NetBIOS Datagram Service (NetBIOS-DS)
	

138

Terminal Access Controller Access Control System (TACACS)
	

49

After UDP Helper is disabled, all specified UDP ports and default ports are canceled.

After the UDP Helper function is enabled, the switch automatically relays the UDP broadcast packets on six default ports. If you want to relay the packets on only one default port, run the undo udp-helper port { dns | netbios-ds | netbios-ns | tacacs | tftp | time } command to disable packet relay on other five ports.
Example

# Enable UDP Helper.

<HUAWEI> system-view
[HUAWEI] udp-helper enable

udp-helper port
Function

The udp-helper port command specifies the UDP ports to which UDP broadcast packets are relayed.

The undo udp-helper port command deletes the UDP ports to which packets are relayed.

By default, no UDP port is specified. After UDP helper is enabled, the switch relays broadcast packets destined for ports 37, 49, 53, 69, 137, and 138 by default.
Format

udp-helper port { port-number | dns | netbios-ds | netbios-ns | tacacs | tftp | time }

undo udp-helper port { port-number | dns | netbios-ds | netbios-ns | tacacs | tftp | time }
Parameters

Parameter
	

Description
	

Value

port-number
	

Specifies the UDP ports to which packets are relayed.
	

The value is an integer that ranges from 1 to 65535, excluding 68.

dns
	

Relays the UDP broadcast packets sent by DNS. The UDP port number is 53.
	

-

netbios-ds
	

Relays the UDP broadcast packets sent by NetBIOS-DS. The UDP port number is 138.
	

-

netbios-ns
	

Relays the UDP broadcast packets sent by NetBIOS-NS. The UDP port number is 137.
	

-

tacacs
	

Relays the UDP broadcast packets sent by TACACS. The UDP port number is 49.
	

-

tftp
	

Relays the UDP broadcast packets sent by TFTP. The UDP port number is 69.
	

-

time
	

Relays the UDP broadcast packets sent by time service. The UDP port number is 37.
	

-
Views

System view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

After UDP helper is enabled and the UDP ports are specified, the switch relays the received UDP broadcast packets destined for the specified ports.

Precautions

The udp-helper port command takes effect globally. That is, if the switch is configured to relay packets destined for a UDP port, all the interfaces configured with the destination server address will relay such packets.

UDP helper enables a device to relay DHCP packets destined for UDP port 67 (that is, DHCP packets sent to the DHCP server).

However, a UDP helper-enabled device cannot relay DHCP packets destined for UDP port 68 (that is, DHCP packets sent to the DHCP client). To relay this type of DHCP packets, you must enable the DHCP relay function.

The switch supports a maximum of 16 UDP ports.
Example

# Configure the switch to relay the broadcast packets destined for UDP port 100.

<HUAWEI> system-view
[HUAWEI] udp-helper enable
[HUAWEI] udp-helper port 100

udp-helper server
Function

The udp-helper server command configures the destination server to which UDP packets are relayed.

The undo udp-helper server command deletes the destination server to which UDP packets are relayed.

By default, no destination server is configured for UDP Helper.
Format

udp-helper server ip-address

undo udp-helper server [ ip-address ]
Parameters

Parameter
	

Description
	

Value

ip-address
	

Specifies the IP address of a destination server. The IP address can be a unicast address or a subnet broadcast address, but cannot be 255.255.255.255. Otherwise, the configuration fails.
	

The value is in dotted decimal notation.
Views

VLANIF interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

If UDP Helper is enabled and the destination server is configured on an interface, when the interface receives the UDP broadcast packets destined for the specified port, it converts the broadcast packets into unicast packets with the destination address ip-address and sends them to the specified server.

Precautions

    A maximum of 20 destination servers can be configured on an interface. If multiple destination servers are configured on an interface, the switch converts the broadcast packets into unicast packets and sends them to all these servers.
    When specifying the IP address of a destination server, ensure that the switch has a reachable route to the network segment where the destination server is located. If no route is reachable, packets cannot be forwarded.
    When the undo udp-helper server command is used without parameter specified, all the configured destination servers on the interface are deleted.

Example

# Configure destination server 10.1.1.2 on VLANIF 100.

<HUAWEI> system-view
[HUAWEI] interface vlanif 100
[HUAWEI-Vlanif100] udp-helper server 10.1.1.2

