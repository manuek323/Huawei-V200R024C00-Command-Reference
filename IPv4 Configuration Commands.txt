IPv4 Configuration Commands

    Command Support
    ip address
    ip address unnumbered
    display ip interface

Command Support

Commands provided in this section and all the parameters in the commands are supported by all switch models (except the S5751-L, S5731-L, and S5731S-L), unless otherwise specified. For details, see specific commands.
ip address
Function

The ip address command configures an IP address for an interface.

The undo ip address command deletes an IP address from an interface.

By default, the IP address 192.168.1.253 255.255.255.0 is configured on VLANIF1 of the S1720GW-E and S1720GWR-E. On other switches, no IP address is configured for an interface.
Format

ip address ip-address { mask | mask-length } [ sub ]

undo ip address [ ip-address { mask | mask-length } [ sub ] ]
Parameters

Parameter
	

Description
	

Value

ip-address
	

Specifies the IP address of an interface.
	

The value is in dotted decimal notation.

mask
	

Specifies a subnet mask.
	

The value is in dotted decimal notation.

mask-length
	

Specifies the mask length.
	

The value is an integer that ranges from 0 to 32.

sub
	

Configures a secondary IP address for an interface. This parameter is optional. To implement communication between multiple subnets of an interface, configure secondary IP addresses for the interface.
	

-
Views

Interface view
Default Level

2: Configuration level
Usage Guidelines

Usage Scenario

The ip address command configures IP addresses for interfaces on the switch so that the switch can communicate with different network segments. To connect an interface to multiple network segments, configure multiple IP addresses for the interface. Among these IP addresses, one is the primary IP address and the others are secondary IP addresses. If you configure a new primary IP address for the interface, the new IP address overrides the original one.
The following conditions are prohibited for different interfaces on the same switch:

    The IP addresses are the same.
    The broadcast addresses (with the host number field containing all 1s in the binary mode) corresponding to the IP addresses are the same. For example, if the IP address of interface A is 10.1.1.1/16 and its corresponding broadcast address is 10.1.255.255 and the IP address of interface B is 10.1.1.2/24 and its corresponding broadcast address is 10.1.1.255, the configuration is successful. However, if the IP address of interface B is also 10.1.1.2/16 and its corresponding broadcast address is also 10.1.255.255, the configuration fails.
    The IP address of an interface is the same as the broadcast address of another interface. For example, if the IP address of interface A is 10.1.2.1/28 and its broadcast address is 10.1.2.15 and the IP address of interface B is 10.1.2.15/26, the configuration fails.

When you run the undo ip address command:

    The undo ip address command deletes all IP addresses from an interface.
    The undo ip address ip-address { mask | mask-length } command deletes the primary IP address of an interface.
    The undo ip address ip-address { mask | mask-length } sub command deletes a secondary IP address.

Precautions

You can configure a secondary IP address only after configuring a primary IP address on the interface. You must delete all secondary IP addresses before deleting the primary IP address.

You can configure multiple IP addresses for a Layer 3 interface on the switch, one as the primary IP address, and the others as secondary IP addresses. Each Layer 3 interface can have a maximum of 31 secondary IP addresses.

The subnet IP address cannot be used as the IP address on an interface.

On the S1720GW-E and S1720GWR-E, if no IP address is configured, VLANIF1 uses the IP address 192.168.1.253 255.255.255.0 by default. After VLANIF1 obtains an IP address through DHCP successfully, the IP address 192.168.1.253 255.255.255.0 is deleted.

    Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support Ethernet sub-interfaces.
    Only hybrid and trunk interfaces on the preceding switches support Layer 2 Ethernet sub-interface configuration.

    After you run the undo portswitch command to switch Layer 2 interfaces on the preceding series of switches into Layer 3 interfaces, you can configure Layer 3 Ethernet sub-interfaces on the interfaces.

    After an interface is added to an Eth-Trunk, sub-interfaces cannot be configured on the interface.
    VLAN termination sub-interfaces cannot be created on a VCMP client.

Example

# Configure a primary IP address 10.1.0.1 and a secondary IP address 10.2.0.1 for VLANIF10, with subnet mask 255.255.255.0.

<HUAWEI> system-view
[HUAWEI] interface vlanif 10
[HUAWEI-Vlanif10] ip address 10.1.0.1 255.255.255.0
[HUAWEI-Vlanif10] ip address 10.2.0.1 255.255.255.0 sub

# Configure a primary IP address 10.1.0.1 and a secondary IP address 10.2.0.1 for GE0/0/1, with subnet mask 255.255.255.0.

<HUAWEI> system-view
[HUAWEI] interface gigabitethernet 0/0/1
[HUAWEI-GigabitEthernet0/0/1] undo portswitch
[HUAWEI-GigabitEthernet0/0/1] ip address 10.1.0.1 255.255.255.0
[HUAWEI-GigabitEthernet0/0/1] ip address 10.2.0.1 255.255.255.0 sub

ip address unnumbered
Function

The ip address unnumbered command configures IP unnumbered on an interface so that the interface can borrow the IP address from another interface.

The undo ip address unnumbered command cancels the IP unnumbered configuration on an interface.

By default, an interface does not borrow the IP address from another interface.
Format

ip address unnumbered interface interface-type interface-number [ all-address ]

undo ip address unnumbered
Parameters

Parameter
	

Description
	

Value

interface interface-type interface-number
	
Specifies the numbered interface from which the IP address will be borrowed.

    interface-type specifies the interface type.
    interface-number specifies the interface number.

	

-

all-address
	

Enables an interface to borrow all IP addresses of another interface. This parameter can be configured only in the VLANIF interface view.
	

-
Views

GE interface view, GE sub-interface view, XGE interface view, XGE sub-interface view, 25GE interface view, 25GE sub-interface view, 40GE interface view, 40GE sub-interface view, 100GE interface view, 100GE sub-interface view, MultiGE interface view, MultiGE sub-interface view, VLANIF interface view, tunnel interface view
Default Level

2: Configuration level
Usage Guidelines
An IP unnumbered interface can be a VLANIF interface , an Ethernet interface, an Ethernet sub-interface, or a Tunnel interface.

    An Ethernet interface and an Ethernet sub-interface can only borrow the IP address of a loopback interface. If one end is configured with IP address unnumbered and the other end is configured with an IP address in non-borrow mode, inter-network segment ARP learning must be enabled on both ends.

    A VLANIF interface can only borrow the IP address of a loopback interface. You can set all-address to configure a VLANIF interface to borrow all the IP addresses of a loopback interface.
    A Tunnel interface can borrow the IP address of an Ethernet interface, a loopback interface, an Eth-Trunk interface, a VLANIF interface, or a Tunnel interface.

The interface from which the IP address is borrowed must be a Layer 3 interface.

If the interface assigned to an IP unnumbered interface has no IP address, the IP unnumbered interface obtains the IP address 0.0.0.0.

The ip address unnumbered command only configures an interface to borrow the IP address from another interface. Other attributes of the interface that borrows an IP address, such as the enablement of routing protocols, need to be configured separately.
Example

# Configure Tunnel1 to borrow the IP address from LoopBack0.

<HUAWEI> system-view
[HUAWEI] interface tunnel 1
[HUAWEI-Tunnel1] ip address unnumbered interface loopback 0

# Configure VLANIF 10 to borrow the IP address from LoopBack1.

<HUAWEI> system-view
[HUAWEI] interface vlanif 10
[HUAWEI-Vlanif10] ip address unnumbered interface loopback 1

display ip interface
Function

The display ip interface command displays the IP configuration and statistics on interfaces. The statistics include the number of packets and bytes received and sent by interfaces, number of multicast packets sent and received by interfaces, and number of broadcast packets received, sent, forwarded, and discarded by interfaces.

The display ip interface brief command displays brief information about interface IP addresses, including the IP address, subnet mask, physical status, link-layer protocol status, and number of interfaces in different states.
Format

display ip interface [ interface-type interface-number ]

display ip interface brief [ interface-type [ interface-number ] | slot slot-id [ card card-number ] ]

display ip interface brief [ interface-type ] &<1-8>
Parameters
Parameter 	Description 	Value

interface-type interface-number
	

Specifies the type and number of an interface. If no interface is specified, IP configuration and statistics about all interfaces are displayed.
	

-

brief
	

Displays brief information, including the IP address, subnet mask, physical status, link-layer protocol status, and number of interfaces in different states.
	

-

slot slot-id
	

Displays the IP configuration and statistics of interfaces on the specified slot.

If the slot number is not specified, brief information related to the IP addresses of the interfaces on all interface boards and main control boards is displayed.
	

-

card card-number
	

Displays the IP configuration and statistics of interfaces on specified card.
	

-
Views

All views
Default Level

1: Monitoring level
Usage Guidelines
You can run the display ip interface brief command to view the following information:

    IP configurations of all interfaces
    IP configurations of interfaces of the specified type and a specified interface
    IP configurations of interfaces that have IP addresses

This command, however, cannot display the IP configurations of Layer 2 interfaces or Eth-Trunk member interfaces.

    You can run the display interface description command to view the interface description.

    You can run the display interface command to view detailed information about the running status and statistics on the interface.

    Only the S5731-H, S5731-S, S5731S-H, S5731S-S, S5732-H, S6735-S, S6730-H, S6730S-H, S6730-S, and S6730S-S support sub-interfaces.

Example
# Display IP information about VLANIF15.

<HUAWEI> display ip interface vlanif 15 
Vlanif15 current state : UP
Line protocol current state : UP
The Maximum Transmit Unit : 1500 bytes
input packets : 766390, bytes : 41540847, multicasts : 681817
output packets : 242239, bytes : 14679482, multicasts : 172333
Directed-broadcast packets:
 received packets:            0, sent packets:            0
 forwarded packets:           0, dropped packets:           0
Internet Address is 10.1.1.119/24
Broadcast address : 10.1.1.255
TTL being 1 packet number:    164035
TTL invalid packet number:         0
ICMP packet input number:          0
  Echo reply:                      0
  Unreachable:                     0
  Source quench:                   0
  Routing redirect:                0
  Echo request:                    0
  Router advert:                   0
  Router solicit:                  0
  Time exceed:                     0
  IP header bad:                   0
  Timestamp request:               0
  Timestamp reply:                 0
  Information request:             0
  Information reply:               0
  Netmask request:                 0
  Netmask reply:                   0
  Unknown type:                    0    

Table 6-1 Description of the display ip interface command output

Item
	

Description

Vlanif15 current state
	
Physical status of the interface:

    UP: indicates that the interface is physically Up.

    DOWN: indicates that the interface is physically Down.

    Administratively down: indicates that the administrator has run the shutdown (interface view) command on the interface.

Line protocol current state
	
Link layer protocol status of the interface:

    UP: The link layer protocol of the interface is running properly.

    DOWN: The link layer protocol of the interface is Down or no IP address is configured on the interface.

The Maximum Transmit Unit
	

MTU of the interface. The default MTU of an Ethernet interface or a serial interface is 1500 bytes. Packets longer than the MTU are fragmented before being transmitted. If fragmentation is not allowed, the packets are discarded.

input packets : 766390, bytes : 41540847, multicasts : 681817
	

Total number of packets, bytes, and multicast packets received by the interface.

output packets : 242239, bytes : 14679482, multicasts : 172333
	

Total number of packets, bytes, and multicast packets sent by the interface.

Directed-broadcast packets
	

Number of packets broadcast on the interface directly.

received packets
	

Total number of received packets.

sent packets
	

Total number of sent packets.

forwarded packets
	

Total number of forwarded packets.

dropped packets
	

Total number of discarded packets.

Internet Address is
	

IP address assigned to the interface and mask length.

Broadcast address
	

Broadcast address of the interface.

TTL being 1 packet number
	

Number of packets with TTL 1.

TTL invalid packet number
	

Number of packets with invalid TTL.

ICMP packet input number
	

Number of received ICMP packets.

Echo reply
	

Number of Echo Reply packets.

Unreachable
	

Number of Destination Unreachable packets.

Source quench
	

Number of Source Quench packets.

Routing redirect
	

Number of Redirect packets.

Echo request
	

Number of Echo Request packets.

Router advert
	

Number of Router Advertisement packets.

Router solicit
	

Number of Router Solicitation packets.

Time exceed
	

Number of Time Exceeded packets.

IP header bad
	

Number of IP header error packets.

Timestamp request
	

Number of Timestamp Request packets.

Timestamp reply
	

Number of Timestamp Reply packets.

Information request
	

Number of Information Request packets.

Information reply
	

Number of Information Reply packets.

Netmask request
	

Number of Address Mask Request packets.

Netmask reply
	

Number of Address Mask Reply packets.

Unknown type
	

Number of unknown packets.
# Display brief IP information about VLANIF15.

<HUAWEI> display ip interface brief vlanif 15
*down: administratively down
^down: standby
(l): loopback
(s): spoofing
(E): E-Trunk down
Interface                         IP Address/Mask      Physical   Protocol
Vlanif15                          10.1.1.119/24        up         up        

Table 6-2 Description of the display ip interface brief command output

Item
	

Description

*down:
	

Reason why an interface is physically Down. Administratively down indicates that the administrator has run the shutdown command on the interface.

^down
	

^down: indicates that the interface is a backup interface.

(l): loopback
	

The letter "l" refers to loopback.

(s): spoofing
	

The letter "s" refers to spoofing.

(E): E-Trunk down
	

Indicates that the Eth-Trunk is Down because of the protocol negotiation on the E-Trunk.

Interface
	

Interface type and number.

IP Address/Mask
	

IP address and mask of an interface.

Physical
	
Physical status of an interface:

    Up: indicates that the interface is physically Up. (l) indicates that the loopback function is configured on the interface.

    Down: indicates that the interface becomes faulty.

    *down: indicates that the administrator has run the shutdown (interface view) command on the interface. (l) indicates that the loopback function is configured on the interface.

    !down: indicates that the FIB module is suspended. In this case, the link protocol status of the interface is Down.

Protocol
	

Link protocol status of the interface:

    Up: indicates that the link protocol of the interface is running properly. (s) indicates that the link protocol status of the interface is Up when this interface is created and has no IP address configured. This is an inherent attribute of an interface. When this interface is configured with an IP address, (s) is still displayed.

    Down: indicates that the link protocol of the interface fails or no IP address is configured on the interface.

(l) indicates that the loopback function is configured on the interface.